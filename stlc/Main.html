<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Main</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="Main.html" class="Module">Main</a> <a id="13" class="Keyword">where</a>

<a id="20" class="Keyword">open</a> <a id="25" class="Keyword">import</a> <a id="32" href="Data.Product.html" class="Module">Data.Product</a>
<a id="45" class="Keyword">open</a> <a id="50" class="Keyword">import</a> <a id="57" href="Data.String.html" class="Module">Data.String</a>
<a id="69" class="Keyword">open</a> <a id="74" class="Keyword">import</a> <a id="81" href="Data.Sum.html" class="Module">Data.Sum</a>
<a id="90" class="Keyword">open</a> <a id="95" class="Keyword">import</a> <a id="102" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="117" class="Symbol">as</a> <a id="120" class="Module">List</a>
<a id="125" class="Keyword">import</a> <a id="132" href="Data.List.NonEmpty.html" class="Module">Data.List.NonEmpty</a> <a id="151" class="Symbol">as</a> <a id="154" class="Module">List⁺</a>
<a id="160" class="Keyword">open</a> <a id="165" class="Keyword">import</a> <a id="172" href="Data.List.Relation.Unary.All.html" class="Module">Data.List.Relation.Unary.All</a>
<a id="201" class="Keyword">open</a> <a id="206" class="Keyword">import</a> <a id="213" href="Data.List.Relation.Unary.All.Properties.html" class="Module">Data.List.Relation.Unary.All.Properties</a>
<a id="253" class="Keyword">open</a> <a id="258" class="Keyword">import</a> <a id="265" href="Text.Parser.Position.html" class="Module">Text.Parser.Position</a>
<a id="286" class="Keyword">open</a> <a id="291" class="Keyword">import</a> <a id="298" href="Function.html" class="Module">Function</a>
<a id="307" class="Keyword">open</a> <a id="312" class="Keyword">import</a> <a id="319" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>

<a id="358" class="Keyword">open</a> <a id="363" class="Keyword">import</a> <a id="370" href="var.html" class="Module">var</a> <a id="374" class="Keyword">using</a> <a id="380" class="Symbol">(</a><a id="381" href="var.html#578" class="InductiveConstructor">z</a><a id="382" class="Symbol">;</a> <a id="384" href="var.html#626" class="InductiveConstructor">s</a><a id="385" class="Symbol">)</a>
<a id="387" class="Keyword">open</a> <a id="392" class="Keyword">import</a> <a id="399" href="Generic.Syntax.html" class="Module">Generic.Syntax</a> <a id="414" class="Keyword">using</a> <a id="420" class="Symbol">(</a><a id="421" href="Generic.Syntax.html#1116" class="InductiveConstructor">`var</a><a id="425" class="Symbol">)</a>
<a id="427" class="Keyword">open</a> <a id="432" class="Keyword">import</a> <a id="439" href="Language.html" class="Module">Language</a><a id="447" class="Symbol">;</a> <a id="449" class="Keyword">open</a> <a id="454" href="Language.html#1919" class="Module">Surface</a>
<a id="462" class="Keyword">open</a> <a id="467" class="Keyword">import</a> <a id="474" href="Types.html" class="Module">Types</a>
<a id="480" class="Keyword">open</a> <a id="485" class="Keyword">import</a> <a id="492" href="Parse.html" class="Module">Parse</a>
<a id="498" class="Keyword">open</a> <a id="503" class="Keyword">import</a> <a id="510" href="Scopecheck.html" class="Module">Scopecheck</a>
<a id="521" class="Keyword">open</a> <a id="526" class="Keyword">import</a> <a id="533" href="Typecheck.html" class="Module">Typecheck</a>
<a id="543" class="Keyword">open</a> <a id="548" class="Keyword">import</a> <a id="555" href="LetInline.html" class="Module">LetInline</a>
<a id="565" class="Keyword">open</a> <a id="570" class="Keyword">import</a> <a id="577" href="Print.html" class="Module">Print</a>

<a id="584" class="Keyword">open</a> <a id="589" class="Keyword">import</a> <a id="596" href="Category.Monad.html" class="Module">Category.Monad</a>

<a id="612" class="Keyword">open</a> <a id="617" href="Category.Monad.html#810" class="Module">RawMonad</a> <a id="626" class="Symbol">(</a><a id="627" href="Types.html#1612" class="Function">Compiler.monad</a> <a id="642" href="Agda.Builtin.String.html#165" class="Postulate">String</a><a id="648" class="Symbol">)</a>
<a id="650" class="Keyword">open</a> <a id="655" href="Types.html#1594" class="Module">Compiler</a>

<a id="declarations"></a><a id="665" href="Main.html#665" class="Function">declarations</a> <a id="678" class="Symbol">:</a> <a id="680" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="685" class="Symbol">(</a><a id="686" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="693" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="695" href="Language.html#680" class="Datatype">Type</a> <a id="700" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="707" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="709" href="Language.html#2451" class="Function">Parsed</a> <a id="716" href="Language.html#789" class="InductiveConstructor">Check</a><a id="721" class="Symbol">)</a> <a id="723" class="Symbol">→</a>
               <a id="740" class="Symbol">∀</a> <a id="742" class="Symbol">{</a><a id="743" href="Main.html#743" class="Bound">Γ</a><a id="744" class="Symbol">}</a> <a id="746" class="Symbol">→</a> <a id="748" href="Language.html#5996" class="Datatype">Definitions</a> <a id="760" href="Main.html#743" class="Bound">Γ</a> <a id="762" class="Symbol">→</a> <a id="764" href="Types.html#1514" class="Function">Compiler</a> <a id="773" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="780" class="Symbol">(</a><a id="781" href="Data.Product.html#917" class="Function">∃</a> <a id="783" href="Language.html#5996" class="Datatype">Definitions</a><a id="794" class="Symbol">)</a>
<a id="796" href="Main.html#665" class="Function">declarations</a> <a id="809" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>             <a id="824" href="Main.html#824" class="Bound">p</a> <a id="826" class="Symbol">=</a> <a id="828" href="Category.Applicative.Indexed.html#905" class="Function">pure</a> <a id="833" href="Function.html#1927" class="Function Operator">$</a> <a id="835" href="Data.Product.html#1937" class="Function Operator">-,</a> <a id="838" href="Main.html#824" class="Bound">p</a>
<a id="840" href="Main.html#665" class="Function">declarations</a> <a id="853" class="Symbol">((</a><a id="855" href="Main.html#855" class="Bound">str</a> <a id="859" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="861" href="Main.html#861" class="Bound">sig</a> <a id="865" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="867" href="Main.html#867" class="Bound">decl</a><a id="871" class="Symbol">)</a> <a id="873" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="875" href="Main.html#875" class="Bound">decls</a><a id="880" class="Symbol">)</a> <a id="882" href="Main.html#882" class="Bound">p</a> <a id="884" class="Symbol">=</a> <a id="886" class="Keyword">do</a>
  <a id="891" href="Main.html#891" class="Bound">scoped</a> <a id="898" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="900" href="Scopecheck.html#1643" class="Function">scopecheck</a> <a id="911" href="Main.html#882" class="Bound">p</a> <a id="913" href="Main.html#867" class="Bound">decl</a>
  <a id="920" href="Main.html#920" class="Bound">σ</a>      <a id="927" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="929" href="Types.html#1779" class="Function">liftState</a> <a id="939" href="Function.html#1927" class="Function Operator">$</a> <a id="941" href="Scopecheck.html#955" class="Function">cleanupType</a> <a id="953" href="Main.html#861" class="Bound">sig</a>
  <a id="959" href="Main.html#959" class="Bound">typed</a>  <a id="966" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="968" href="Types.html#2970" class="Function">ppCompiler</a> <a id="979" href="Function.html#1927" class="Function Operator">$</a> <a id="981" href="Types.html#1707" class="Function">liftResult</a> <a id="992" href="Function.html#1927" class="Function Operator">$</a> <a id="994" href="Typecheck.html#3940" class="Function">type-</a> <a id="1000" href="Language.html#789" class="InductiveConstructor">Check</a> <a id="1006" class="Symbol">_</a> <a id="1008" href="Main.html#891" class="Bound">scoped</a> <a id="1015" class="Symbol">(</a><a id="1016" href="Data.List.Relation.Unary.All.Properties.html#3913" class="Function">map⁺</a> <a id="1021" href="Data.List.Relation.Unary.All.html#1974" class="Function">self</a><a id="1025" class="Symbol">)</a> <a id="1027" href="Main.html#920" class="Bound">σ</a>
  <a id="1031" class="Keyword">let</a> <a id="1035" href="Main.html#1035" class="Bound">x</a> <a id="1037" class="Symbol">=</a> <a id="1039" href="Main.html#855" class="Bound">str</a> <a id="1043" href="Language.html#6142" class="InductiveConstructor Operator">∶</a> <a id="1045" href="Main.html#920" class="Bound">σ</a> <a id="1047" href="Language.html#6142" class="InductiveConstructor Operator">≔</a> <a id="1049" href="Relation.Binary.PropositionalEquality.Core.html#978" class="Function">subst</a> <a id="1055" class="Symbol">(</a><a id="1056" href="Language.html#3340" class="Function">Internal.Typed</a> <a id="1071" class="Symbol">_)</a> <a id="1074" class="Symbol">(</a><a id="1075" href="Typecheck.html#952" class="Function">eq^fromTyping</a> <a id="1089" class="Symbol">_)</a> <a id="1092" href="Main.html#959" class="Bound">typed</a>
  <a id="1100" href="Main.html#665" class="Function">declarations</a> <a id="1113" href="Main.html#875" class="Bound">decls</a> <a id="1119" class="Symbol">(</a><a id="1120" href="Main.html#882" class="Bound">p</a> <a id="1122" href="Language.html#6325" class="InductiveConstructor Operator">&amp;</a> <a id="1124" href="Main.html#1035" class="Bound">x</a><a id="1125" class="Symbol">)</a>

<a id="declaration"></a><a id="1128" href="Main.html#1128" class="Function">declaration</a> <a id="1140" class="Symbol">:</a> <a id="1142" href="Language.html#2451" class="Function">Parsed</a> <a id="1149" href="Language.html#783" class="InductiveConstructor">Infer</a> <a id="1155" class="Symbol">→</a> <a id="1157" class="Symbol">∀</a> <a id="1159" class="Symbol">{</a><a id="1160" href="Main.html#1160" class="Bound">Γ</a><a id="1161" class="Symbol">}</a> <a id="1163" class="Symbol">→</a> <a id="1165" href="Language.html#5996" class="Datatype">Definitions</a> <a id="1177" href="Main.html#1160" class="Bound">Γ</a> <a id="1179" class="Symbol">→</a>
              <a id="1195" href="Types.html#1514" class="Function">Compiler</a> <a id="1204" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1211" class="Symbol">(</a><a id="1212" href="Data.Product.html#917" class="Function">∃</a> <a id="1214" class="Symbol">λ</a> <a id="1216" href="Main.html#1216" class="Bound">σ</a> <a id="1218" class="Symbol">→</a> <a id="1220" href="Language.html#6642" class="Function">Expression</a> <a id="1231" href="Main.html#1216" class="Bound">σ</a> <a id="1233" href="Main.html#1160" class="Bound">Γ</a><a id="1234" class="Symbol">)</a>
<a id="1236" href="Main.html#1128" class="Function">declaration</a> <a id="1248" href="Main.html#1248" class="Bound">d</a> <a id="1250" class="Symbol">{</a><a id="1251" href="Main.html#1251" class="Bound">Γ</a><a id="1252" class="Symbol">}</a> <a id="1254" href="Main.html#1254" class="Bound">p</a> <a id="1256" class="Symbol">=</a> <a id="1258" class="Keyword">do</a>
  <a id="1263" href="Main.html#1263" class="Bound">scoped</a>      <a id="1275" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="1277" href="Scopecheck.html#1643" class="Function">scopecheck</a> <a id="1288" href="Main.html#1254" class="Bound">p</a> <a id="1290" href="Main.html#1248" class="Bound">d</a>
  <a id="1294" class="Symbol">(</a><a id="1295" href="Main.html#1295" class="Bound">σ</a> <a id="1297" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1299" href="Main.html#1299" class="Bound">typed</a><a id="1304" class="Symbol">)</a> <a id="1306" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="1308" href="Types.html#2970" class="Function">ppCompiler</a> <a id="1319" href="Function.html#1927" class="Function Operator">$</a> <a id="1321" href="Types.html#1707" class="Function">liftResult</a> <a id="1332" href="Function.html#1927" class="Function Operator">$</a> <a id="1334" href="Typecheck.html#3940" class="Function">type-</a> <a id="1340" href="Language.html#783" class="InductiveConstructor">Infer</a> <a id="1346" href="Main.html#1251" class="Bound">Γ</a> <a id="1348" href="Main.html#1263" class="Bound">scoped</a> <a id="1355" class="Symbol">(</a><a id="1356" href="Data.List.Relation.Unary.All.Properties.html#3913" class="Function">map⁺</a> <a id="1361" href="Data.List.Relation.Unary.All.html#1974" class="Function">self</a><a id="1365" class="Symbol">)</a>
  <a id="1369" href="Category.Applicative.Indexed.html#905" class="Function">pure</a> <a id="1374" class="Symbol">(</a><a id="1375" href="Main.html#1295" class="Bound">σ</a> <a id="1377" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1379" href="Relation.Binary.PropositionalEquality.Core.html#978" class="Function">subst</a> <a id="1385" class="Symbol">(</a><a id="1386" href="Language.html#3340" class="Function">Internal.Typed</a> <a id="1401" class="Symbol">_)</a> <a id="1404" class="Symbol">(</a><a id="1405" href="Typecheck.html#952" class="Function">eq^fromTyping</a> <a id="1419" class="Symbol">_)</a> <a id="1422" href="Main.html#1299" class="Bound">typed</a><a id="1427" class="Symbol">)</a>

<a id="pipeline"></a><a id="1430" href="Main.html#1430" class="Function">pipeline</a> <a id="1439" class="Symbol">:</a> <a id="1441" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1448" class="Symbol">→</a> <a id="1450" href="Types.html#654" class="Datatype">Error</a> <a id="1456" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1463" href="Data.Sum.Base.html#509" class="Datatype Operator">⊎</a> <a id="1465" href="Language.html#6767" class="Datatype">Program</a>
<a id="1473" href="Main.html#1430" class="Function">pipeline</a> <a id="1482" href="Main.html#1482" class="Bound">str</a> <a id="1486" class="Symbol">=</a> <a id="1488" href="Types.html#2087" class="Function">Compiler.run</a> <a id="1501" href="Function.html#1927" class="Function Operator">$</a> <a id="1503" class="Keyword">do</a>
  <a id="1508" class="Symbol">(</a><a id="1509" href="Main.html#1509" class="Bound">decls</a> <a id="1515" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1517" href="Main.html#1517" class="Bound">expr</a><a id="1521" class="Symbol">)</a> <a id="1523" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="1525" href="Types.html#1707" class="Function">liftResult</a> <a id="1536" href="Function.html#1927" class="Function Operator">$</a> <a id="1538" href="Parse.html#5363" class="Function">parse</a> <a id="1544" href="Main.html#1482" class="Bound">str</a>
  <a id="1550" class="Symbol">(</a><a id="1551" href="Main.html#1551" class="Bound">Γ</a> <a id="1553" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1555" href="Main.html#1555" class="Bound">defs</a><a id="1559" class="Symbol">)</a>     <a id="1565" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="1567" href="Main.html#665" class="Function">declarations</a> <a id="1580" class="Symbol">(</a><a id="1581" href="Data.List.NonEmpty.html#1701" class="Function">List⁺.toList</a> <a id="1594" href="Main.html#1509" class="Bound">decls</a><a id="1599" class="Symbol">)</a> <a id="1601" href="Language.html#6302" class="InductiveConstructor">[]</a>
  <a id="1606" class="Symbol">(</a><a id="1607" href="Main.html#1607" class="Bound">σ</a> <a id="1609" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1611" href="Main.html#1611" class="Bound">eval</a><a id="1615" class="Symbol">)</a>     <a id="1621" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="1623" href="Main.html#1128" class="Function">declaration</a> <a id="1635" href="Main.html#1517" class="Bound">expr</a> <a id="1640" href="Main.html#1555" class="Bound">defs</a>
  <a id="1647" href="Category.Applicative.Indexed.html#905" class="Function">pure</a> <a id="1652" href="Function.html#1927" class="Function Operator">$</a> <a id="1654" href="Language.html#6789" class="InductiveConstructor Operator">assuming</a> <a id="1663" href="Main.html#1555" class="Bound">defs</a> <a id="1668" href="Language.html#6789" class="InductiveConstructor Operator">have</a> <a id="1673" href="Main.html#1611" class="Bound">eval</a>

<a id="1679" class="Keyword">open</a> <a id="1684" class="Keyword">import</a> <a id="1691" href="Agda.Builtin.Equality.html" class="Module">Agda.Builtin.Equality</a>

<a id="1714" href="Main.html#1714" class="Function">_</a> <a id="1716" class="Symbol">:</a> <a id="1718" href="Data.Sum.html#1158" class="Function">from-inj₂</a> <a id="1728" class="Symbol">(</a><a id="1729" href="Main.html#1430" class="Function">pipeline</a> <a id="1738" class="String">&quot;def id  : `a → `a = λx. x
\            \def snd : `a → `b → `b = λx. λy.y
\            \eval id&quot;</a><a id="1835" class="Symbol">)</a>
  <a id="1839" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="1841" href="Language.html#6789" class="InductiveConstructor Operator">assuming</a> <a id="1850" href="Language.html#6302" class="InductiveConstructor">[]</a>
  <a id="1855" href="Language.html#6325" class="InductiveConstructor Operator">&amp;</a> <a id="1857" class="String">&quot;id&quot;</a>  <a id="1863" href="Language.html#6142" class="InductiveConstructor Operator">∶</a> <a id="1865" href="Language.html#709" class="InductiveConstructor">α</a> <a id="1867" class="Number">0</a> <a id="1869" href="Language.html#728" class="InductiveConstructor Operator">⇒</a> <a id="1871" href="Language.html#709" class="InductiveConstructor">α</a> <a id="1873" class="Number">0</a>       <a id="1881" href="Language.html#6142" class="InductiveConstructor Operator">≔</a> <a id="1883" href="Language.html#4542" class="InductiveConstructor Operator">`λ</a> <a id="1886" href="Language.html#4837" class="InductiveConstructor Operator">`-</a> <a id="1889" href="Generic.Syntax.html#1116" class="InductiveConstructor">`var</a> <a id="1894" href="var.html#578" class="InductiveConstructor">z</a>
  <a id="1898" href="Language.html#6325" class="InductiveConstructor Operator">&amp;</a> <a id="1900" class="String">&quot;snd&quot;</a> <a id="1906" href="Language.html#6142" class="InductiveConstructor Operator">∶</a> <a id="1908" href="Language.html#709" class="InductiveConstructor">α</a> <a id="1910" class="Number">0</a> <a id="1912" href="Language.html#728" class="InductiveConstructor Operator">⇒</a> <a id="1914" href="Language.html#709" class="InductiveConstructor">α</a> <a id="1916" class="Number">1</a> <a id="1918" href="Language.html#728" class="InductiveConstructor Operator">⇒</a> <a id="1920" href="Language.html#709" class="InductiveConstructor">α</a> <a id="1922" class="Number">1</a> <a id="1924" href="Language.html#6142" class="InductiveConstructor Operator">≔</a> <a id="1926" href="Language.html#4542" class="InductiveConstructor Operator">`λ</a> <a id="1929" href="Language.html#4542" class="InductiveConstructor Operator">`λ</a> <a id="1932" href="Language.html#4837" class="InductiveConstructor Operator">`-</a> <a id="1935" href="Generic.Syntax.html#1116" class="InductiveConstructor">`var</a> <a id="1940" href="var.html#578" class="InductiveConstructor">z</a>
  <a id="1944" href="Language.html#6789" class="InductiveConstructor Operator">have</a> <a id="1949" href="Generic.Syntax.html#1116" class="InductiveConstructor">`var</a> <a id="1954" class="Symbol">(</a><a id="1955" href="var.html#626" class="InductiveConstructor">s</a> <a id="1957" href="var.html#578" class="InductiveConstructor">z</a><a id="1958" class="Symbol">)</a>
<a id="1960" class="Symbol">_</a> <a id="1962" class="Symbol">=</a> <a id="1964" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
</pre></body></html>