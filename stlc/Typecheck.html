<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Typecheck</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="Typecheck.html" class="Module">Typecheck</a> <a id="18" class="Keyword">where</a>

<a id="25" class="Keyword">open</a> <a id="30" class="Keyword">import</a> <a id="37" href="Data.Product.html" class="Module">Data.Product</a> <a id="50" class="Symbol">as</a> <a id="53" class="Module">Prod</a>
<a id="58" class="Keyword">open</a> <a id="63" class="Keyword">import</a> <a id="70" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="79" class="Symbol">as</a> <a id="82" class="Module">ℕ</a> <a id="84" class="Keyword">using</a> <a id="90" class="Symbol">(</a><a id="91" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="92" class="Symbol">;</a> <a id="94" href="Data.Nat.Properties.html#2153" class="Function Operator">_≟_</a><a id="97" class="Symbol">)</a>
<a id="99" class="Keyword">open</a> <a id="104" class="Keyword">import</a> <a id="111" href="Data.List.html" class="Module">Data.List</a> <a id="121" class="Symbol">as</a> <a id="124" class="Module">List</a> <a id="129" class="Keyword">hiding</a> <a id="136" class="Symbol">(</a><a id="137" href="Data.List.Base.html#5961" class="Function">lookup</a> <a id="144" class="Symbol">;</a> <a id="146" href="Data.List.Base.html#4700" class="Function">fromMaybe</a><a id="155" class="Symbol">)</a>
<a id="157" class="Keyword">open</a> <a id="162" class="Keyword">import</a> <a id="169" href="Data.List.Relation.Unary.All.html" class="Module">Data.List.Relation.Unary.All</a> <a id="198" class="Symbol">as</a> <a id="201" class="Module">All</a> <a id="205" class="Keyword">hiding</a> <a id="212" class="Symbol">(</a><a id="213" href="Data.List.Relation.Unary.All.html#1646" class="Function">lookup</a><a id="219" class="Symbol">)</a>
<a id="221" class="Keyword">import</a> <a id="228" href="Data.List.Relation.Unary.All.Properties.html" class="Module">Data.List.Relation.Unary.All.Properties</a> <a id="268" class="Symbol">as</a> <a id="271" class="Module">Allₚ</a>
<a id="276" class="Keyword">open</a> <a id="281" class="Keyword">import</a> <a id="288" href="Data.List.Relation.Unary.Any.html" class="Module">Data.List.Relation.Unary.Any</a> <a id="317" class="Keyword">using</a> <a id="323" class="Symbol">(</a><a id="324" href="Data.List.Relation.Unary.Any.html#962" class="InductiveConstructor">here</a><a id="328" class="Symbol">;</a> <a id="330" href="Data.List.Relation.Unary.Any.html#1015" class="InductiveConstructor">there</a><a id="335" class="Symbol">)</a>
<a id="337" class="Keyword">open</a> <a id="342" class="Keyword">import</a> <a id="349" href="Data.List.Membership.Propositional.html" class="Module">Data.List.Membership.Propositional</a>
<a id="384" class="Keyword">open</a> <a id="389" class="Keyword">import</a> <a id="396" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="434" class="Symbol">as</a> <a id="437" class="Module">P</a> <a id="439" class="Keyword">using</a> <a id="445" class="Symbol">(</a><a id="446" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a><a id="449" class="Symbol">;</a> <a id="451" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="455" class="Symbol">)</a>
<a id="457" class="Keyword">open</a> <a id="462" class="Keyword">import</a> <a id="469" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="480" class="Keyword">hiding</a> <a id="487" class="Symbol">(</a><a id="488" href="Data.Maybe.Base.html#1730" class="Function">fromMaybe</a><a id="497" class="Symbol">)</a>
<a id="499" class="Keyword">open</a> <a id="504" class="Keyword">import</a> <a id="511" href="Function.html" class="Module">Function</a>

<a id="521" class="Keyword">open</a> <a id="526" class="Keyword">import</a> <a id="533" href="Category.Monad.html" class="Module">Category.Monad</a>

<a id="549" class="Keyword">open</a> <a id="554" class="Keyword">import</a> <a id="561" href="var.html" class="Module">var</a> <a id="565" class="Keyword">hiding</a> <a id="572" class="Symbol">(</a><a id="573" href="var.html#789" class="Function Operator">_&lt;$&gt;_</a><a id="578" class="Symbol">)</a>
<a id="580" class="Keyword">open</a> <a id="585" class="Keyword">import</a> <a id="592" href="varlike.html" class="Module">varlike</a> <a id="600" class="Keyword">using</a> <a id="606" class="Symbol">(</a><a id="607" href="varlike.html#455" class="Function">base</a><a id="611" class="Symbol">;</a> <a id="613" href="varlike.html#863" class="Function">vl^Var</a><a id="619" class="Symbol">)</a>
<a id="621" class="Keyword">open</a> <a id="626" class="Keyword">import</a> <a id="633" href="environment.html" class="Module">environment</a> <a id="645" class="Keyword">hiding</a> <a id="652" class="Symbol">(</a><a id="653" href="environment.html#556" class="Function Operator">_&lt;$&gt;_</a><a id="658" class="Symbol">)</a>
<a id="660" class="Keyword">open</a> <a id="665" class="Keyword">import</a> <a id="672" href="Generic.Syntax.html" class="Module">Generic.Syntax</a>
<a id="687" class="Keyword">open</a> <a id="692" class="Keyword">import</a> <a id="699" href="Generic.Semantics.html" class="Module">Generic.Semantics</a>

<a id="718" class="Keyword">open</a> <a id="723" class="Keyword">import</a> <a id="730" href="Text.Parser.Position.html" class="Module">Text.Parser.Position</a>

<a id="752" class="Keyword">open</a> <a id="757" class="Keyword">import</a> <a id="764" href="Language.html" class="Module">Language</a>
<a id="773" class="Keyword">open</a> <a id="778" href="Language.html#1919" class="Module">Surface</a>
<a id="786" class="Keyword">open</a> <a id="791" href="Language.html#2586" class="Module">Internal</a>
<a id="800" class="Keyword">open</a> <a id="805" class="Keyword">import</a> <a id="812" href="Types.html" class="Module">Types</a>

<a id="Typing"></a><a id="819" href="Typecheck.html#819" class="Function">Typing</a> <a id="826" class="Symbol">:</a> <a id="828" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="833" href="Language.html#764" class="Datatype">Mode</a> <a id="838" class="Symbol">→</a> <a id="840" class="PrimitiveType">Set</a>
<a id="844" href="Typecheck.html#819" class="Function">Typing</a> <a id="851" class="Symbol">=</a> <a id="853" href="Data.List.Relation.Unary.All.html#967" class="Datatype">All</a> <a id="857" class="Symbol">(</a><a id="858" href="Function.html#1145" class="Function">const</a> <a id="864" class="Symbol">(</a><a id="865" href="Language.html#680" class="Datatype">Type</a> <a id="870" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="871" class="Symbol">))</a>

<a id="fromTyping"></a><a id="875" href="Typecheck.html#875" class="Function">fromTyping</a> <a id="886" class="Symbol">:</a> <a id="888" class="Symbol">∀</a> <a id="890" href="Typecheck.html#890" class="Bound">ms</a> <a id="893" class="Symbol">→</a> <a id="895" href="Typecheck.html#819" class="Function">Typing</a> <a id="902" href="Typecheck.html#890" class="Bound">ms</a> <a id="905" class="Symbol">→</a> <a id="907" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="912" class="Symbol">(</a><a id="913" href="Language.html#764" class="Datatype">Mode</a> <a id="918" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="920" href="Language.html#680" class="Datatype">Type</a> <a id="925" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="926" class="Symbol">)</a>
<a id="928" href="Typecheck.html#875" class="Function">fromTyping</a> <a id="939" href="Typecheck.html#939" class="Bound">ms</a> <a id="942" class="Symbol">=</a> <a id="944" href="Data.List.Relation.Unary.All.html#1535" class="Function">toList</a>

<a id="eq^fromTyping"></a><a id="952" href="Typecheck.html#952" class="Function">eq^fromTyping</a> <a id="966" class="Symbol">:</a>
  <a id="970" class="Symbol">∀</a> <a id="972" href="Typecheck.html#972" class="Bound">Γ</a> <a id="974" class="Symbol">→</a> <a id="976" href="Typecheck.html#875" class="Function">fromTyping</a> <a id="987" class="Symbol">(</a><a id="988" href="Data.List.Base.html#1186" class="Function">List.map</a> <a id="997" class="Symbol">(</a><a id="998" href="Function.html#1145" class="Function">const</a> <a id="1004" href="Language.html#783" class="InductiveConstructor">Infer</a><a id="1009" class="Symbol">)</a> <a id="1011" href="Typecheck.html#972" class="Bound">Γ</a><a id="1012" class="Symbol">)</a> <a id="1014" class="Symbol">(</a><a id="1015" href="Data.List.Relation.Unary.All.Properties.html#3913" class="Function">Allₚ.map⁺</a> <a id="1025" href="Data.List.Relation.Unary.All.html#1974" class="Function">All.self</a><a id="1033" class="Symbol">)</a>
      <a id="1041" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="1043" href="Data.List.Base.html#1186" class="Function">List.map</a> <a id="1052" class="Symbol">(</a><a id="1053" href="Language.html#783" class="InductiveConstructor">Infer</a> <a id="1059" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,_</a><a id="1061" class="Symbol">)</a> <a id="1063" href="Typecheck.html#972" class="Bound">Γ</a>
<a id="1065" href="Typecheck.html#952" class="Function">eq^fromTyping</a> <a id="1079" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>      <a id="1087" class="Symbol">=</a> <a id="1089" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="1094" href="Typecheck.html#952" class="Function">eq^fromTyping</a> <a id="1108" class="Symbol">(</a><a id="1109" href="Typecheck.html#1109" class="Bound">σ</a> <a id="1111" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1113" href="Typecheck.html#1113" class="Bound">Γ</a><a id="1114" class="Symbol">)</a> <a id="1116" class="Symbol">=</a> <a id="1118" href="Relation.Binary.PropositionalEquality.Core.html#1045" class="Function">P.cong</a> <a id="1125" class="Symbol">(_</a> <a id="1128" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷_</a><a id="1130" class="Symbol">)</a> <a id="1132" class="Symbol">(</a><a id="1133" href="Typecheck.html#952" class="Function">eq^fromTyping</a> <a id="1147" href="Typecheck.html#1113" class="Bound">Γ</a><a id="1148" class="Symbol">)</a>

<a id="Elab"></a><a id="1151" href="Typecheck.html#1151" class="Function">Elab</a> <a id="1156" class="Symbol">:</a> <a id="1158" class="Symbol">(</a><a id="1159" href="Language.html#764" class="Datatype">Mode</a> <a id="1164" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="1166" href="Language.html#680" class="Datatype">Type</a> <a id="1171" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="1172" class="Symbol">)</a> <a id="1174" href="var.html#469" class="Function Operator">─Scoped</a> <a id="1182" class="Symbol">→</a> <a id="1184" href="Language.html#764" class="Datatype">Mode</a> <a id="1189" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="1191" href="Language.html#680" class="Datatype">Type</a> <a id="1196" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1198" class="Symbol">→</a> <a id="1200" class="Symbol">(</a><a id="1201" href="Typecheck.html#1201" class="Bound">ms</a> <a id="1204" class="Symbol">:</a> <a id="1206" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1211" href="Language.html#764" class="Datatype">Mode</a><a id="1215" class="Symbol">)</a> <a id="1217" class="Symbol">→</a> <a id="1219" href="Typecheck.html#819" class="Function">Typing</a> <a id="1226" href="Typecheck.html#1201" class="Bound">ms</a> <a id="1229" class="Symbol">→</a> <a id="1231" class="PrimitiveType">Set</a>
<a id="1235" href="Typecheck.html#1151" class="Function">Elab</a> <a id="1240" href="Typecheck.html#1240" class="Bound">T</a> <a id="1242" href="Typecheck.html#1242" class="Bound">σ</a> <a id="1244" href="Typecheck.html#1244" class="Bound">ms</a> <a id="1247" href="Typecheck.html#1247" class="Bound">Γ</a> <a id="1249" class="Symbol">=</a> <a id="1251" href="Typecheck.html#1240" class="Bound">T</a> <a id="1253" href="Typecheck.html#1242" class="Bound">σ</a> <a id="1255" class="Symbol">(</a><a id="1256" href="Typecheck.html#875" class="Function">fromTyping</a> <a id="1267" href="Typecheck.html#1244" class="Bound">ms</a> <a id="1270" href="Typecheck.html#1247" class="Bound">Γ</a><a id="1271" class="Symbol">)</a>

<a id="1274" class="Keyword">data</a> <a id="Var-"></a><a id="1279" href="Typecheck.html#1279" class="Datatype">Var-</a> <a id="1284" class="Symbol">:</a> <a id="1286" href="Language.html#764" class="Datatype">Mode</a> <a id="1291" href="var.html#469" class="Function Operator">─Scoped</a> <a id="1299" class="Keyword">where</a>
  <a id="Var-.`var"></a><a id="1307" href="Typecheck.html#1307" class="InductiveConstructor">`var</a> <a id="1312" class="Symbol">:</a> <a id="1314" class="Symbol">∀</a> <a id="1316" class="Symbol">{</a><a id="1317" href="Typecheck.html#1317" class="Bound">ms</a><a id="1319" class="Symbol">}</a> <a id="1321" class="Symbol">→</a> <a id="1323" class="Symbol">(</a><a id="1324" href="Typecheck.html#1324" class="Bound">infer</a> <a id="1330" class="Symbol">:</a> <a id="1332" class="Symbol">∀</a> <a id="1334" href="Typecheck.html#1334" class="Bound">Γ</a> <a id="1336" class="Symbol">→</a> <a id="1338" href="Data.Product.html#800" class="Function">Σ[</a> <a id="1341" href="Typecheck.html#1341" class="Bound">σ</a> <a id="1343" href="Data.Product.html#800" class="Function">∈</a> <a id="1345" href="Language.html#680" class="Datatype">Type</a> <a id="1350" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="1352" href="Data.Product.html#800" class="Function">]</a> <a id="1354" href="Typecheck.html#1151" class="Function">Elab</a> <a id="1359" href="var.html#553" class="Datatype">Var</a> <a id="1363" class="Symbol">(</a><a id="1364" href="Language.html#783" class="InductiveConstructor">Infer</a> <a id="1370" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1372" href="Typecheck.html#1341" class="Bound">σ</a><a id="1373" class="Symbol">)</a> <a id="1375" href="Typecheck.html#1317" class="Bound">ms</a> <a id="1378" href="Typecheck.html#1334" class="Bound">Γ</a><a id="1379" class="Symbol">)</a> <a id="1381" class="Symbol">→</a>
         <a id="1392" href="Typecheck.html#1279" class="Datatype">Var-</a> <a id="1397" href="Language.html#783" class="InductiveConstructor">Infer</a> <a id="1403" href="Typecheck.html#1317" class="Bound">ms</a>

<a id="var0"></a><a id="1407" href="Typecheck.html#1407" class="Function">var0</a> <a id="1412" class="Symbol">:</a> <a id="1414" class="Symbol">∀</a> <a id="1416" class="Symbol">{</a><a id="1417" href="Typecheck.html#1417" class="Bound">ms</a><a id="1419" class="Symbol">}</a> <a id="1421" class="Symbol">→</a> <a id="1423" href="Typecheck.html#1279" class="Datatype">Var-</a> <a id="1428" href="Language.html#783" class="InductiveConstructor">Infer</a> <a id="1434" class="Symbol">(</a><a id="1435" href="Language.html#783" class="InductiveConstructor">Infer</a> <a id="1441" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1443" href="Typecheck.html#1417" class="Bound">ms</a><a id="1445" class="Symbol">)</a>
<a id="1447" href="Typecheck.html#1407" class="Function">var0</a> <a id="1452" class="Symbol">=</a> <a id="1454" href="Typecheck.html#1307" class="InductiveConstructor">`var</a> <a id="1459" class="Symbol">(λ</a> <a id="1462" class="Keyword">where</a> <a id="1468" class="Symbol">(</a><a id="1469" href="Typecheck.html#1469" class="Bound">σ</a> <a id="1471" href="Data.List.Relation.Unary.All.html#1053" class="InductiveConstructor Operator">∷</a> <a id="1473" class="Symbol">_)</a> <a id="1476" class="Symbol">→</a> <a id="1478" href="Typecheck.html#1469" class="Bound">σ</a> <a id="1480" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1482" href="var.html#578" class="InductiveConstructor">z</a><a id="1483" class="Symbol">)</a>

<a id="var"></a><a id="1486" href="Typecheck.html#1486" class="Function">var</a> <a id="1490" class="Symbol">:</a> <a id="1492" class="Symbol">∀</a> <a id="1494" class="Symbol">{</a><a id="1495" href="Typecheck.html#1495" class="Bound">m</a><a id="1496" class="Symbol">}</a> <a id="1498" class="Symbol">(</a><a id="1499" href="Typecheck.html#1499" class="Bound">Σ</a> <a id="1501" class="Symbol">:</a> <a id="1503" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1508" class="Symbol">(</a><a id="1509" href="Language.html#680" class="Datatype">Type</a> <a id="1514" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="1515" class="Symbol">))</a> <a id="1518" class="Symbol">→</a> <a id="1520" class="Keyword">let</a> <a id="1524" href="Typecheck.html#1524" class="Bound">Γ</a> <a id="1526" class="Symbol">=</a> <a id="1528" href="Data.List.Base.html#1186" class="Function">List.map</a> <a id="1537" class="Symbol">(</a><a id="1538" href="Function.html#1145" class="Function">const</a> <a id="1544" href="Language.html#783" class="InductiveConstructor">Infer</a><a id="1549" class="Symbol">)</a> <a id="1551" href="Typecheck.html#1499" class="Bound">Σ</a> <a id="1553" class="Keyword">in</a>
      <a id="1562" href="var.html#553" class="Datatype">Var</a> <a id="1566" href="Typecheck.html#1495" class="Bound">m</a> <a id="1568" href="Typecheck.html#1524" class="Bound">Γ</a> <a id="1570" class="Symbol">→</a> <a id="1572" href="Typecheck.html#1279" class="Datatype">Var-</a> <a id="1577" href="Typecheck.html#1495" class="Bound">m</a> <a id="1579" href="Typecheck.html#1524" class="Bound">Γ</a>
<a id="1581" href="Typecheck.html#1486" class="Function">var</a> <a id="1585" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="1588" class="Symbol">()</a>
<a id="1591" href="Typecheck.html#1486" class="Function">var</a> <a id="1595" class="Symbol">(</a><a id="1596" href="Typecheck.html#1596" class="Bound">m</a> <a id="1598" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1600" href="Typecheck.html#1600" class="Bound">Σ</a><a id="1601" class="Symbol">)</a> <a id="1603" href="var.html#578" class="InductiveConstructor">z</a>     <a id="1609" class="Symbol">=</a> <a id="1611" href="Typecheck.html#1407" class="Function">var0</a>
<a id="1616" href="Typecheck.html#1486" class="Function">var</a> <a id="1620" class="Symbol">(</a><a id="1621" href="Typecheck.html#1621" class="Bound">m</a> <a id="1623" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1625" href="Typecheck.html#1625" class="Bound">Σ</a><a id="1626" class="Symbol">)</a> <a id="1628" class="Symbol">(</a><a id="1629" href="var.html#626" class="InductiveConstructor">s</a> <a id="1631" href="Typecheck.html#1631" class="Bound">v</a><a id="1632" class="Symbol">)</a> <a id="1634" class="Keyword">with</a> <a id="1639" href="Typecheck.html#1486" class="Function">var</a> <a id="1643" href="Typecheck.html#1625" class="Bound">Σ</a> <a id="1645" href="Typecheck.html#1631" class="Bound">v</a>
<a id="1647" class="Symbol">...</a> <a id="1651" class="Symbol">|</a> <a id="1653" href="Typecheck.html#1307" class="InductiveConstructor">`var</a> <a id="1658" href="Typecheck.html#1658" class="Bound">infer</a> <a id="1664" class="Symbol">=</a> <a id="1666" href="Typecheck.html#1307" class="InductiveConstructor">`var</a> <a id="1671" class="Symbol">(λ</a> <a id="1674" class="Keyword">where</a> <a id="1680" class="Symbol">(</a><a id="1681" href="Typecheck.html#1681" class="Bound">σ</a> <a id="1683" href="Data.List.Relation.Unary.All.html#1053" class="InductiveConstructor Operator">∷</a> <a id="1685" href="Typecheck.html#1685" class="Bound">Γ</a><a id="1686" class="Symbol">)</a> <a id="1688" class="Symbol">→</a> <a id="1690" href="Data.Product.html#2474" class="Function">Prod.map₂</a> <a id="1700" href="var.html#626" class="InductiveConstructor">s</a> <a id="1702" href="Function.html#1927" class="Function Operator">$</a> <a id="1704" href="Typecheck.html#1658" class="Bound">infer</a> <a id="1710" href="Typecheck.html#1685" class="Bound">Γ</a><a id="1711" class="Symbol">)</a>

<a id="toVar"></a><a id="1714" href="Typecheck.html#1714" class="Function">toVar</a> <a id="1720" class="Symbol">:</a> <a id="1722" class="Symbol">∀</a> <a id="1724" class="Symbol">{</a><a id="1725" href="Typecheck.html#1725" class="Bound">m</a> <a id="1727" class="Symbol">:</a> <a id="1729" href="Language.html#764" class="Datatype">Mode</a><a id="1733" class="Symbol">}</a> <a id="1735" class="Symbol">{</a><a id="1736" href="Typecheck.html#1736" class="Bound">ms</a><a id="1738" class="Symbol">}</a> <a id="1740" class="Symbol">→</a> <a id="1742" href="Typecheck.html#1725" class="Bound">m</a> <a id="1744" href="Data.List.Membership.Setoid.html#937" class="Function Operator">∈</a> <a id="1746" href="Typecheck.html#1736" class="Bound">ms</a> <a id="1749" class="Symbol">→</a> <a id="1751" href="var.html#553" class="Datatype">Var</a> <a id="1755" href="Typecheck.html#1725" class="Bound">m</a> <a id="1757" href="Typecheck.html#1736" class="Bound">ms</a>
<a id="1760" href="Typecheck.html#1714" class="Function">toVar</a> <a id="1766" class="Symbol">(</a><a id="1767" href="Data.List.Relation.Unary.Any.html#962" class="InductiveConstructor">here</a> <a id="1772" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="1776" class="Symbol">)</a> <a id="1778" class="Symbol">=</a> <a id="1780" href="var.html#578" class="InductiveConstructor">z</a>
<a id="1782" href="Typecheck.html#1714" class="Function">toVar</a> <a id="1788" class="Symbol">(</a><a id="1789" href="Data.List.Relation.Unary.Any.html#1015" class="InductiveConstructor">there</a> <a id="1795" href="Typecheck.html#1795" class="Bound">v</a><a id="1796" class="Symbol">)</a> <a id="1798" class="Symbol">=</a> <a id="1800" href="var.html#626" class="InductiveConstructor">s</a> <a id="1802" class="Symbol">(</a><a id="1803" href="Typecheck.html#1714" class="Function">toVar</a> <a id="1809" href="Typecheck.html#1795" class="Bound">v</a><a id="1810" class="Symbol">)</a>

<a id="fromVar"></a><a id="1813" href="Typecheck.html#1813" class="Function">fromVar</a> <a id="1821" class="Symbol">:</a> <a id="1823" class="Symbol">∀</a> <a id="1825" class="Symbol">{</a><a id="1826" href="Typecheck.html#1826" class="Bound">m</a> <a id="1828" class="Symbol">:</a> <a id="1830" href="Language.html#764" class="Datatype">Mode</a><a id="1834" class="Symbol">}</a> <a id="1836" class="Symbol">{</a><a id="1837" href="Typecheck.html#1837" class="Bound">ms</a><a id="1839" class="Symbol">}</a> <a id="1841" class="Symbol">→</a> <a id="1843" href="var.html#553" class="Datatype">Var</a> <a id="1847" href="Typecheck.html#1826" class="Bound">m</a> <a id="1849" href="Typecheck.html#1837" class="Bound">ms</a> <a id="1852" class="Symbol">→</a> <a id="1854" href="Typecheck.html#1826" class="Bound">m</a> <a id="1856" href="Data.List.Membership.Setoid.html#937" class="Function Operator">∈</a> <a id="1858" href="Typecheck.html#1837" class="Bound">ms</a>
<a id="1861" href="Typecheck.html#1813" class="Function">fromVar</a> <a id="1869" href="var.html#578" class="InductiveConstructor">z</a> <a id="1871" class="Symbol">=</a> <a id="1873" href="Data.List.Relation.Unary.Any.html#962" class="InductiveConstructor">here</a> <a id="1878" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="1883" href="Typecheck.html#1813" class="Function">fromVar</a> <a id="1891" class="Symbol">(</a><a id="1892" href="var.html#626" class="InductiveConstructor">s</a> <a id="1894" href="Typecheck.html#1894" class="Bound">v</a><a id="1895" class="Symbol">)</a> <a id="1897" class="Symbol">=</a> <a id="1899" href="Data.List.Relation.Unary.Any.html#1015" class="InductiveConstructor">there</a> <a id="1905" class="Symbol">(</a><a id="1906" href="Typecheck.html#1813" class="Function">fromVar</a> <a id="1914" href="Typecheck.html#1894" class="Bound">v</a><a id="1915" class="Symbol">)</a>

<a id="coth^Typing"></a><a id="1918" href="Typecheck.html#1918" class="Function">coth^Typing</a> <a id="1930" class="Symbol">:</a> <a id="1932" class="Symbol">∀</a> <a id="1934" class="Symbol">{</a><a id="1935" href="Typecheck.html#1935" class="Bound">ms</a> <a id="1938" href="Typecheck.html#1938" class="Bound">ns</a><a id="1940" class="Symbol">}</a> <a id="1942" class="Symbol">→</a> <a id="1944" href="Typecheck.html#819" class="Function">Typing</a> <a id="1951" href="Typecheck.html#1938" class="Bound">ns</a> <a id="1954" class="Symbol">→</a> <a id="1956" href="environment.html#450" class="Function">Thinning</a> <a id="1965" href="Typecheck.html#1935" class="Bound">ms</a> <a id="1968" href="Typecheck.html#1938" class="Bound">ns</a> <a id="1971" class="Symbol">→</a> <a id="1973" href="Typecheck.html#819" class="Function">Typing</a> <a id="1980" href="Typecheck.html#1935" class="Bound">ms</a>
<a id="1983" href="Typecheck.html#1918" class="Function">coth^Typing</a> <a id="1995" href="Typecheck.html#1995" class="Bound">Δ</a> <a id="1997" href="Typecheck.html#1997" class="Bound">ρ</a> <a id="1999" class="Symbol">=</a> <a id="2001" href="Data.List.Relation.Unary.All.html#1813" class="Function">All.tabulate</a> <a id="2014" class="Symbol">(λ</a> <a id="2017" href="Typecheck.html#2017" class="Bound">x∈Γ</a> <a id="2021" class="Symbol">→</a> <a id="2023" href="Data.List.Relation.Unary.All.html#1646" class="Function">All.lookup</a> <a id="2034" href="Typecheck.html#1995" class="Bound">Δ</a> <a id="2036" class="Symbol">(</a><a id="2037" href="Typecheck.html#1813" class="Function">fromVar</a> <a id="2045" class="Symbol">(</a><a id="2046" href="environment.html#396" class="Field">lookup</a> <a id="2053" href="Typecheck.html#1997" class="Bound">ρ</a> <a id="2055" class="Symbol">(</a><a id="2056" href="Typecheck.html#1714" class="Function">toVar</a> <a id="2062" href="Typecheck.html#2017" class="Bound">x∈Γ</a><a id="2065" class="Symbol">))))</a>

<a id="lookup-fromVar"></a><a id="2071" href="Typecheck.html#2071" class="Function">lookup-fromVar</a> <a id="2086" class="Symbol">:</a> <a id="2088" class="Symbol">∀</a> <a id="2090" class="Symbol">{</a><a id="2091" href="Typecheck.html#2091" class="Bound">m</a> <a id="2093" href="Typecheck.html#2093" class="Bound">ms</a><a id="2095" class="Symbol">}</a> <a id="2097" href="Typecheck.html#2097" class="Bound">Δ</a> <a id="2099" class="Symbol">(</a><a id="2100" href="Typecheck.html#2100" class="Bound">v</a> <a id="2102" class="Symbol">:</a> <a id="2104" href="var.html#553" class="Datatype">Var</a> <a id="2108" href="Typecheck.html#2091" class="Bound">m</a> <a id="2110" href="Typecheck.html#2093" class="Bound">ms</a><a id="2112" class="Symbol">)</a> <a id="2114" class="Symbol">→</a>
                 <a id="2133" href="var.html#553" class="Datatype">Var</a> <a id="2137" class="Symbol">(</a><a id="2138" href="Typecheck.html#2091" class="Bound">m</a> <a id="2140" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2142" href="Data.List.Relation.Unary.All.html#1646" class="Function">All.lookup</a> <a id="2153" href="Typecheck.html#2097" class="Bound">Δ</a> <a id="2155" class="Symbol">(</a><a id="2156" href="Typecheck.html#1813" class="Function">fromVar</a> <a id="2164" href="Typecheck.html#2100" class="Bound">v</a><a id="2165" class="Symbol">))</a> <a id="2168" class="Symbol">(</a><a id="2169" href="Typecheck.html#875" class="Function">fromTyping</a> <a id="2180" href="Typecheck.html#2093" class="Bound">ms</a> <a id="2183" href="Typecheck.html#2097" class="Bound">Δ</a><a id="2184" class="Symbol">)</a>
<a id="2186" href="Typecheck.html#2071" class="Function">lookup-fromVar</a> <a id="2201" class="Symbol">(_</a> <a id="2204" href="Data.List.Relation.Unary.All.html#1053" class="InductiveConstructor Operator">∷</a> <a id="2206" class="Symbol">_)</a> <a id="2209" href="var.html#578" class="InductiveConstructor">z</a>     <a id="2215" class="Symbol">=</a> <a id="2217" href="var.html#578" class="InductiveConstructor">z</a>
<a id="2219" href="Typecheck.html#2071" class="Function">lookup-fromVar</a> <a id="2234" class="Symbol">(_</a> <a id="2237" href="Data.List.Relation.Unary.All.html#1053" class="InductiveConstructor Operator">∷</a> <a id="2239" class="Symbol">_)</a> <a id="2242" class="Symbol">(</a><a id="2243" href="var.html#626" class="InductiveConstructor">s</a> <a id="2245" href="Typecheck.html#2245" class="Bound">v</a><a id="2246" class="Symbol">)</a> <a id="2248" class="Symbol">=</a> <a id="2250" href="var.html#626" class="InductiveConstructor">s</a> <a id="2252" class="Symbol">(</a><a id="2253" href="Typecheck.html#2071" class="Function">lookup-fromVar</a> <a id="2268" class="Symbol">_</a> <a id="2270" href="Typecheck.html#2245" class="Bound">v</a><a id="2271" class="Symbol">)</a>

<a id="erase^coth"></a><a id="2274" href="Typecheck.html#2274" class="Function">erase^coth</a> <a id="2285" class="Symbol">:</a> <a id="2287" class="Symbol">∀</a> <a id="2289" href="Typecheck.html#2289" class="Bound">ms</a> <a id="2292" class="Symbol">{</a><a id="2293" href="Typecheck.html#2293" class="Bound">m</a> <a id="2295" href="Typecheck.html#2295" class="Bound">σ</a> <a id="2297" href="Typecheck.html#2297" class="Bound">ns</a><a id="2299" class="Symbol">}</a> <a id="2301" href="Typecheck.html#2301" class="Bound">Δ</a> <a id="2303" class="Symbol">(</a><a id="2304" href="Typecheck.html#2304" class="Bound">ρ</a> <a id="2306" class="Symbol">:</a> <a id="2308" href="environment.html#450" class="Function">Thinning</a> <a id="2317" href="Typecheck.html#2289" class="Bound">ms</a> <a id="2320" href="Typecheck.html#2297" class="Bound">ns</a><a id="2322" class="Symbol">)</a> <a id="2324" class="Symbol">→</a>
             <a id="2339" href="var.html#553" class="Datatype">Var</a> <a id="2343" class="Symbol">(</a><a id="2344" href="Typecheck.html#2293" class="Bound">m</a> <a id="2346" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2348" href="Typecheck.html#2295" class="Bound">σ</a><a id="2349" class="Symbol">)</a> <a id="2351" class="Symbol">(</a><a id="2352" href="Typecheck.html#875" class="Function">fromTyping</a> <a id="2363" href="Typecheck.html#2289" class="Bound">ms</a> <a id="2366" class="Symbol">(</a><a id="2367" href="Typecheck.html#1918" class="Function">coth^Typing</a> <a id="2379" href="Typecheck.html#2301" class="Bound">Δ</a> <a id="2381" href="Typecheck.html#2304" class="Bound">ρ</a><a id="2382" class="Symbol">))</a> <a id="2385" class="Symbol">→</a> <a id="2387" href="var.html#553" class="Datatype">Var</a> <a id="2391" class="Symbol">(</a><a id="2392" href="Typecheck.html#2293" class="Bound">m</a> <a id="2394" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2396" href="Typecheck.html#2295" class="Bound">σ</a><a id="2397" class="Symbol">)</a> <a id="2399" class="Symbol">(</a><a id="2400" href="Typecheck.html#875" class="Function">fromTyping</a> <a id="2411" href="Typecheck.html#2297" class="Bound">ns</a> <a id="2414" href="Typecheck.html#2301" class="Bound">Δ</a><a id="2415" class="Symbol">)</a>
<a id="2417" href="Typecheck.html#2274" class="Function">erase^coth</a> <a id="2428" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>       <a id="2437" href="Typecheck.html#2437" class="Bound">Δ</a> <a id="2439" href="Typecheck.html#2439" class="Bound">ρ</a> <a id="2441" class="Symbol">()</a>
<a id="2444" href="Typecheck.html#2274" class="Function">erase^coth</a> <a id="2455" class="Symbol">(</a><a id="2456" href="Typecheck.html#2456" class="Bound">m</a> <a id="2458" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2460" href="Typecheck.html#2460" class="Bound">ms</a><a id="2462" class="Symbol">)</a> <a id="2464" href="Typecheck.html#2464" class="Bound">Δ</a> <a id="2466" href="Typecheck.html#2466" class="Bound">ρ</a> <a id="2468" href="var.html#578" class="InductiveConstructor">z</a>     <a id="2474" class="Symbol">=</a> <a id="2476" href="Typecheck.html#2071" class="Function">lookup-fromVar</a> <a id="2491" href="Typecheck.html#2464" class="Bound">Δ</a> <a id="2493" class="Symbol">(</a><a id="2494" href="environment.html#396" class="Field">lookup</a> <a id="2501" href="Typecheck.html#2466" class="Bound">ρ</a> <a id="2503" href="var.html#578" class="InductiveConstructor">z</a><a id="2504" class="Symbol">)</a>
<a id="2506" href="Typecheck.html#2274" class="Function">erase^coth</a> <a id="2517" class="Symbol">(</a><a id="2518" href="Typecheck.html#2518" class="Bound">m</a> <a id="2520" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2522" href="Typecheck.html#2522" class="Bound">ms</a><a id="2524" class="Symbol">)</a> <a id="2526" href="Typecheck.html#2526" class="Bound">Δ</a> <a id="2528" href="Typecheck.html#2528" class="Bound">ρ</a> <a id="2530" class="Symbol">(</a><a id="2531" href="var.html#626" class="InductiveConstructor">s</a> <a id="2533" href="Typecheck.html#2533" class="Bound">v</a><a id="2534" class="Symbol">)</a> <a id="2536" class="Symbol">=</a> <a id="2538" href="Typecheck.html#2274" class="Function">erase^coth</a> <a id="2549" href="Typecheck.html#2522" class="Bound">ms</a> <a id="2552" href="Typecheck.html#2526" class="Bound">Δ</a> <a id="2554" class="Symbol">(</a><a id="2555" href="environment.html#2189" class="Function">select</a> <a id="2562" href="environment.html#2306" class="Function">extend</a> <a id="2569" href="Typecheck.html#2528" class="Bound">ρ</a><a id="2570" class="Symbol">)</a> <a id="2572" href="Typecheck.html#2533" class="Bound">v</a>

<a id="th^Var-"></a><a id="2575" href="Typecheck.html#2575" class="Function">th^Var-</a> <a id="2583" class="Symbol">:</a> <a id="2585" class="Symbol">∀</a> <a id="2587" class="Symbol">{</a><a id="2588" href="Typecheck.html#2588" class="Bound">m</a><a id="2589" class="Symbol">}</a> <a id="2591" class="Symbol">→</a> <a id="2593" href="environment.html#3430" class="Function">Thinnable</a> <a id="2603" class="Symbol">(</a><a id="2604" href="Typecheck.html#1279" class="Datatype">Var-</a> <a id="2609" href="Typecheck.html#2588" class="Bound">m</a><a id="2610" class="Symbol">)</a>
<a id="2612" href="Typecheck.html#2575" class="Function">th^Var-</a> <a id="2620" class="Symbol">(</a><a id="2621" href="Typecheck.html#1307" class="InductiveConstructor">`var</a> <a id="2626" href="Typecheck.html#2626" class="Bound">infer</a><a id="2631" class="Symbol">)</a> <a id="2633" href="Typecheck.html#2633" class="Bound">ρ</a> <a id="2635" class="Symbol">=</a> <a id="2637" href="Typecheck.html#1307" class="InductiveConstructor">`var</a> <a id="2642" class="Symbol">λ</a> <a id="2644" href="Typecheck.html#2644" class="Bound">Δ</a> <a id="2646" class="Symbol">→</a>
  <a id="2650" class="Keyword">let</a> <a id="2654" class="Symbol">(</a><a id="2655" href="Typecheck.html#2655" class="Bound">σ</a> <a id="2657" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2659" href="Typecheck.html#2659" class="Bound">v</a><a id="2660" class="Symbol">)</a> <a id="2662" class="Symbol">=</a> <a id="2664" href="Typecheck.html#2626" class="Bound">infer</a> <a id="2670" class="Symbol">(</a><a id="2671" href="Typecheck.html#1918" class="Function">coth^Typing</a> <a id="2683" href="Typecheck.html#2644" class="Bound">Δ</a> <a id="2685" href="Typecheck.html#2633" class="Bound">ρ</a><a id="2686" class="Symbol">)</a> <a id="2688" class="Keyword">in</a>
  <a id="2693" href="Typecheck.html#2655" class="Bound">σ</a> <a id="2695" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2697" href="Typecheck.html#2274" class="Function">erase^coth</a> <a id="2708" class="Symbol">_</a> <a id="2710" href="Typecheck.html#2644" class="Bound">Δ</a> <a id="2712" href="Typecheck.html#2633" class="Bound">ρ</a> <a id="2714" href="Typecheck.html#2659" class="Bound">v</a>

<a id="isArrow"></a><a id="2717" href="Typecheck.html#2717" class="Function">isArrow</a> <a id="2725" class="Symbol">:</a> <a id="2727" class="Symbol">(</a><a id="2728" href="Typecheck.html#2728" class="Bound">σ⇒τ</a> <a id="2732" class="Symbol">:</a> <a id="2734" href="Language.html#680" class="Datatype">Type</a> <a id="2739" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="2740" class="Symbol">)</a> <a id="2742" class="Symbol">→</a> <a id="2744" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="2750" class="Symbol">(</a><a id="2751" href="Data.Product.html#800" class="Function">Σ[</a> <a id="2754" href="Typecheck.html#2754" class="Bound">στ</a> <a id="2757" href="Data.Product.html#800" class="Function">∈</a> <a id="2759" href="Language.html#680" class="Datatype">Type</a> <a id="2764" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="2766" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="2768" href="Language.html#680" class="Datatype">Type</a> <a id="2773" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="2775" href="Data.Product.html#800" class="Function">]</a> <a id="2777" href="Typecheck.html#2728" class="Bound">σ⇒τ</a> <a id="2781" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">≡</a> <a id="2783" href="Data.Product.html#3500" class="Function">uncurry</a> <a id="2791" href="Language.html#728" class="InductiveConstructor Operator">_⇒_</a> <a id="2795" href="Typecheck.html#2754" class="Bound">στ</a><a id="2797" class="Symbol">)</a>
<a id="2799" href="Typecheck.html#2717" class="Function">isArrow</a> <a id="2807" class="Symbol">(</a><a id="2808" href="Language.html#709" class="InductiveConstructor">α</a> <a id="2810" class="Symbol">_)</a> <a id="2813" class="Symbol">=</a> <a id="2815" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a>
<a id="2823" href="Typecheck.html#2717" class="Function">isArrow</a> <a id="2831" class="Symbol">(</a><a id="2832" href="Typecheck.html#2832" class="Bound">σ</a> <a id="2834" href="Language.html#728" class="InductiveConstructor Operator">⇒</a> <a id="2836" href="Typecheck.html#2836" class="Bound">τ</a><a id="2837" class="Symbol">)</a> <a id="2839" class="Symbol">=</a> <a id="2841" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="2846" class="Symbol">(</a> <a id="2848" class="Symbol">_</a> <a id="2850" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2852" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="2856" class="Symbol">)</a>

<a id="Type-"></a><a id="2859" href="Typecheck.html#2859" class="Function">Type-</a> <a id="2865" class="Symbol">:</a> <a id="2867" href="Language.html#764" class="Datatype">Mode</a> <a id="2872" class="Symbol">→</a> <a id="2874" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2879" href="Language.html#764" class="Datatype">Mode</a> <a id="2884" class="Symbol">→</a> <a id="2886" class="PrimitiveType">Set</a>
<a id="2890" href="Typecheck.html#2859" class="Function">Type-</a> <a id="2896" href="Language.html#783" class="InductiveConstructor">Infer</a> <a id="2902" href="Typecheck.html#2902" class="Bound">Γ</a> <a id="2904" class="Symbol">=</a> <a id="2906" class="Symbol">∀</a> <a id="2908" href="Typecheck.html#2908" class="Bound">γ</a>   <a id="2912" class="Symbol">→</a> <a id="2914" href="Types.html#964" class="Function">Result</a> <a id="2921" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="2923" class="Symbol">(</a><a id="2924" href="Data.Product.html#917" class="Function">∃</a> <a id="2926" class="Symbol">λ</a> <a id="2928" href="Typecheck.html#2928" class="Bound">σ</a> <a id="2930" class="Symbol">→</a> <a id="2932" href="Language.html#3340" class="Function">Typed</a> <a id="2938" class="Symbol">(</a><a id="2939" href="Language.html#783" class="InductiveConstructor">Infer</a> <a id="2945" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2947" href="Typecheck.html#2928" class="Bound">σ</a><a id="2948" class="Symbol">)</a> <a id="2950" class="Symbol">(</a><a id="2951" href="Typecheck.html#875" class="Function">fromTyping</a> <a id="2962" href="Typecheck.html#2902" class="Bound">Γ</a> <a id="2964" href="Typecheck.html#2908" class="Bound">γ</a><a id="2965" class="Symbol">))</a>
<a id="2968" href="Typecheck.html#2859" class="Function">Type-</a> <a id="2974" href="Language.html#789" class="InductiveConstructor">Check</a> <a id="2980" href="Typecheck.html#2980" class="Bound">Γ</a> <a id="2982" class="Symbol">=</a> <a id="2984" class="Symbol">∀</a> <a id="2986" href="Typecheck.html#2986" class="Bound">γ</a> <a id="2988" href="Typecheck.html#2988" class="Bound">σ</a> <a id="2990" class="Symbol">→</a> <a id="2992" href="Types.html#964" class="Function">Result</a> <a id="2999" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="3001" class="Symbol">(</a><a id="3002" href="Language.html#3340" class="Function">Typed</a> <a id="3008" class="Symbol">(</a><a id="3009" href="Language.html#789" class="InductiveConstructor">Check</a> <a id="3015" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3017" href="Typecheck.html#2988" class="Bound">σ</a><a id="3018" class="Symbol">)</a> <a id="3020" class="Symbol">(</a><a id="3021" href="Typecheck.html#875" class="Function">fromTyping</a> <a id="3032" href="Typecheck.html#2980" class="Bound">Γ</a> <a id="3034" href="Typecheck.html#2986" class="Bound">γ</a><a id="3035" class="Symbol">))</a>

<a id="3039" class="Keyword">open</a> <a id="3044" href="Category.Monad.html#810" class="Module">RawMonad</a> <a id="3053" class="Symbol">(</a><a id="3054" href="Types.html#1051" class="Function">Result.monad</a> <a id="3067" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="3068" class="Symbol">)</a> <a id="3070" class="Keyword">hiding</a> <a id="3077" class="Symbol">(</a>return<a id="3084" class="Symbol">)</a>
<a id="3086" class="Keyword">open</a> <a id="3091" href="Types.html#1035" class="Module">Result</a>

<a id="Typecheck"></a><a id="3099" href="Typecheck.html#3099" class="Function">Typecheck</a> <a id="3109" class="Symbol">:</a> <a id="3111" href="Generic.Semantics.html#487" class="Record">Sem</a> <a id="3115" class="Symbol">(</a><a id="3116" href="Language.html#2097" class="Function">surface</a> <a id="3124" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="3125" class="Symbol">)</a> <a id="3127" href="Typecheck.html#1279" class="Datatype">Var-</a> <a id="3132" href="Typecheck.html#2859" class="Function">Type-</a>
<a id="3138" href="Generic.Semantics.html#552" class="Field">Sem.th^𝓥</a> <a id="3147" href="Typecheck.html#3099" class="Function">Typecheck</a> <a id="3157" class="Symbol">=</a> <a id="3159" href="Typecheck.html#2575" class="Function">th^Var-</a>
<a id="3167" href="Generic.Semantics.html#595" class="Field">Sem.var</a>   <a id="3177" href="Typecheck.html#3099" class="Function">Typecheck</a> <a id="3187" class="Symbol">=</a> <a id="3189" class="Symbol">λ</a> <a id="3191" class="Keyword">where</a> <a id="3197" class="Symbol">(</a><a id="3198" href="Typecheck.html#1307" class="InductiveConstructor">`var</a> <a id="3203" href="Typecheck.html#3203" class="Bound">infer</a><a id="3208" class="Symbol">)</a> <a id="3210" href="Typecheck.html#3210" class="Bound">γ</a> <a id="3212" class="Symbol">→</a> <a id="3214" href="Category.Applicative.Indexed.html#905" class="Function">pure</a> <a id="3219" href="Function.html#1927" class="Function Operator">$</a> <a id="3221" href="Data.Product.html#2474" class="Function">map₂</a> <a id="3226" href="Generic.Syntax.html#1116" class="InductiveConstructor">`var</a> <a id="3231" class="Symbol">(</a><a id="3232" href="Typecheck.html#3203" class="Bound">infer</a> <a id="3238" href="Typecheck.html#3210" class="Bound">γ</a><a id="3239" class="Symbol">)</a>
<a id="3241" href="Generic.Semantics.html#654" class="Field">Sem.alg</a>   <a id="3251" href="Typecheck.html#3099" class="Function">Typecheck</a> <a id="3261" class="Symbol">=</a> <a id="3263" class="Symbol">λ</a> <a id="3265" class="Keyword">where</a>
  <a id="3273" class="Symbol">(</a><a id="3274" href="Typecheck.html#3274" class="Bound">r</a> <a id="3276" href="Language.html#4949" class="InductiveConstructor Operator">&gt;</a> <a id="3278" href="Typecheck.html#3278" class="Bound">t</a> <a id="3280" href="Language.html#4949" class="InductiveConstructor Operator">`∶&#39;</a> <a id="3284" href="Typecheck.html#3284" class="Bound">σ</a><a id="3285" class="Symbol">)</a> <a id="3287" href="Typecheck.html#3287" class="Bound">γ</a>     <a id="3293" class="Symbol">→</a> <a id="3295" class="Symbol">(</a><a id="3296" href="Data.Product.html#1937" class="Function Operator">-,_</a> <a id="3300" href="Function.html#805" class="Function Operator">∘</a> <a id="3302" class="Symbol">(</a><a id="3303" href="Typecheck.html#3274" class="Bound">r</a> <a id="3305" href="Language.html#5003" class="InductiveConstructor Operator">&gt;_`∶</a> <a id="3310" href="Typecheck.html#3284" class="Bound">σ</a><a id="3311" class="Symbol">))</a> <a id="3314" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="3318" href="Typecheck.html#3278" class="Bound">t</a> <a id="3320" href="Typecheck.html#3287" class="Bound">γ</a> <a id="3322" href="Typecheck.html#3284" class="Bound">σ</a>
  <a id="3326" class="Symbol">(</a><a id="3327" href="Typecheck.html#3327" class="Bound">r</a> <a id="3329" href="Language.html#5051" class="InductiveConstructor Operator">&gt;</a> <a id="3331" href="Typecheck.html#3331" class="Bound">f</a> <a id="3333" href="Language.html#5051" class="InductiveConstructor Operator">`$&#39;</a> <a id="3337" href="Typecheck.html#3337" class="Bound">t</a><a id="3338" class="Symbol">)</a> <a id="3340" href="Typecheck.html#3340" class="Bound">γ</a>     <a id="3346" class="Symbol">→</a> <a id="3348" class="Keyword">do</a>
    <a id="3355" class="Symbol">(</a><a id="3356" href="Typecheck.html#3356" class="Bound">σ⇒τ</a> <a id="3360" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3362" href="Typecheck.html#3362" class="Bound">f′</a><a id="3364" class="Symbol">)</a>       <a id="3372" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="3374" href="Typecheck.html#3331" class="Bound">f</a> <a id="3376" href="Typecheck.html#3340" class="Bound">γ</a>
    <a id="3382" class="Symbol">((</a><a id="3384" href="Typecheck.html#3384" class="Bound">σ</a> <a id="3386" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3388" href="Typecheck.html#3388" class="Bound">τ</a><a id="3389" class="Symbol">)</a> <a id="3391" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3393" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="3397" class="Symbol">)</a> <a id="3399" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="3401" href="Types.html#1183" class="Function">fromMaybe</a> <a id="3411" class="Symbol">(</a><a id="3412" href="Types.html#858" class="InductiveConstructor Operator">At</a> <a id="3415" href="Typecheck.html#3327" class="Bound">r</a> <a id="3417" href="Types.html#858" class="InductiveConstructor Operator">NotAnArrow</a> <a id="3428" href="Typecheck.html#3356" class="Bound">σ⇒τ</a><a id="3431" class="Symbol">)</a> <a id="3433" class="Symbol">(</a><a id="3434" href="Typecheck.html#2717" class="Function">isArrow</a> <a id="3442" href="Typecheck.html#3356" class="Bound">σ⇒τ</a><a id="3445" class="Symbol">)</a>
    <a id="3451" href="Typecheck.html#3451" class="Bound">t′</a>               <a id="3468" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="3470" href="Typecheck.html#3337" class="Bound">t</a> <a id="3472" href="Typecheck.html#3340" class="Bound">γ</a> <a id="3474" href="Typecheck.html#3384" class="Bound">σ</a>
    <a id="3480" href="Category.Applicative.Indexed.html#905" class="Function">pure</a> <a id="3485" href="Function.html#1927" class="Function Operator">$</a> <a id="3487" href="Data.Product.html#1937" class="Function Operator">-,</a> <a id="3490" href="Typecheck.html#3327" class="Bound">r</a> <a id="3492" href="Language.html#5109" class="InductiveConstructor Operator">&gt;</a> <a id="3494" href="Typecheck.html#3362" class="Bound">f′</a> <a id="3497" href="Language.html#5109" class="InductiveConstructor Operator">`$</a> <a id="3500" href="Typecheck.html#3451" class="Bound">t′</a>
  <a id="3505" class="Symbol">(</a><a id="3506" href="Typecheck.html#3506" class="Bound">r</a> <a id="3508" href="Language.html#5157" class="InductiveConstructor Operator">&gt;`λ&#39;</a> <a id="3513" href="Typecheck.html#3513" class="Bound">b</a><a id="3514" class="Symbol">)</a> <a id="3516" href="Typecheck.html#3516" class="Bound">γ</a> <a id="3518" href="Typecheck.html#3518" class="Bound">σ⇒τ</a> <a id="3522" class="Symbol">→</a> <a id="3524" class="Keyword">do</a>
    <a id="3531" class="Symbol">((</a><a id="3533" href="Typecheck.html#3533" class="Bound">σ</a> <a id="3535" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3537" href="Typecheck.html#3537" class="Bound">τ</a><a id="3538" class="Symbol">)</a> <a id="3540" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3542" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="3546" class="Symbol">)</a> <a id="3548" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="3550" href="Types.html#1183" class="Function">fromMaybe</a> <a id="3560" class="Symbol">(</a><a id="3561" href="Types.html#858" class="InductiveConstructor Operator">At</a> <a id="3564" href="Typecheck.html#3506" class="Bound">r</a> <a id="3566" href="Types.html#858" class="InductiveConstructor Operator">NotAnArrow</a> <a id="3577" href="Typecheck.html#3518" class="Bound">σ⇒τ</a><a id="3580" class="Symbol">)</a> <a id="3582" class="Symbol">(</a><a id="3583" href="Typecheck.html#2717" class="Function">isArrow</a> <a id="3591" href="Typecheck.html#3518" class="Bound">σ⇒τ</a><a id="3594" class="Symbol">)</a>
    <a id="3600" href="Typecheck.html#3600" class="Bound">b′</a>               <a id="3617" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="3619" href="Typecheck.html#3513" class="Bound">b</a> <a id="3621" href="environment.html#2306" class="Function">extend</a> <a id="3628" class="Symbol">(</a><a id="3629" href="environment.html#515" class="Function">ε</a> <a id="3631" href="environment.html#2070" class="Function Operator">∙</a> <a id="3633" href="Typecheck.html#1407" class="Function">var0</a><a id="3637" class="Symbol">)</a> <a id="3639" class="Symbol">(</a><a id="3640" href="Typecheck.html#3533" class="Bound">σ</a> <a id="3642" href="Data.List.Relation.Unary.All.html#1053" class="InductiveConstructor Operator">∷</a> <a id="3644" href="Typecheck.html#3516" class="Bound">γ</a><a id="3645" class="Symbol">)</a> <a id="3647" href="Typecheck.html#3537" class="Bound">τ</a>
    <a id="3653" href="Category.Applicative.Indexed.html#905" class="Function">pure</a> <a id="3658" href="Function.html#1927" class="Function Operator">$</a> <a id="3660" href="Typecheck.html#3506" class="Bound">r</a> <a id="3662" href="Language.html#5211" class="InductiveConstructor Operator">&gt;`λ</a> <a id="3666" href="Typecheck.html#3600" class="Bound">b′</a>
  <a id="3671" class="Symbol">(</a><a id="3672" href="Typecheck.html#3672" class="Bound">r</a> <a id="3674" href="Language.html#5256" class="InductiveConstructor Operator">&gt;`let&#39;</a> <a id="3681" href="Typecheck.html#3681" class="Bound">e</a> <a id="3683" href="Language.html#5256" class="InductiveConstructor Operator">`in</a> <a id="3687" href="Typecheck.html#3687" class="Bound">b</a><a id="3688" class="Symbol">)</a> <a id="3690" href="Typecheck.html#3690" class="Bound">γ</a> <a id="3692" href="Typecheck.html#3692" class="Bound">τ</a> <a id="3694" class="Symbol">→</a> <a id="3696" class="Keyword">do</a>
    <a id="3703" class="Symbol">(</a><a id="3704" href="Typecheck.html#3704" class="Bound">σ</a> <a id="3706" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3708" href="Typecheck.html#3708" class="Bound">e′</a><a id="3710" class="Symbol">)</a> <a id="3712" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="3714" href="Typecheck.html#3681" class="Bound">e</a> <a id="3716" href="Typecheck.html#3690" class="Bound">γ</a>
    <a id="3722" href="Typecheck.html#3722" class="Bound">b′</a>       <a id="3731" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="3733" href="Typecheck.html#3687" class="Bound">b</a> <a id="3735" href="environment.html#2306" class="Function">extend</a> <a id="3742" class="Symbol">(</a><a id="3743" href="environment.html#515" class="Function">ε</a> <a id="3745" href="environment.html#2070" class="Function Operator">∙</a> <a id="3747" href="Typecheck.html#1407" class="Function">var0</a><a id="3751" class="Symbol">)</a> <a id="3753" class="Symbol">(</a><a id="3754" href="Typecheck.html#3704" class="Bound">σ</a> <a id="3756" href="Data.List.Relation.Unary.All.html#1053" class="InductiveConstructor Operator">∷</a> <a id="3758" href="Typecheck.html#3690" class="Bound">γ</a><a id="3759" class="Symbol">)</a> <a id="3761" href="Typecheck.html#3692" class="Bound">τ</a>
    <a id="3767" href="Category.Applicative.Indexed.html#905" class="Function">pure</a> <a id="3772" href="Function.html#1927" class="Function Operator">$</a> <a id="3774" href="Typecheck.html#3672" class="Bound">r</a> <a id="3776" href="Language.html#5314" class="InductiveConstructor Operator">&gt;`let</a> <a id="3782" href="Typecheck.html#3708" class="Bound">e′</a> <a id="3785" href="Language.html#5314" class="InductiveConstructor Operator">`in</a> <a id="3789" href="Typecheck.html#3722" class="Bound">b′</a>
  <a id="3794" class="Symbol">(</a><a id="3795" href="Typecheck.html#3795" class="Bound">r</a> <a id="3797" href="Language.html#5367" class="InductiveConstructor Operator">&gt;`-&#39;</a> <a id="3802" href="Typecheck.html#3802" class="Bound">t</a><a id="3803" class="Symbol">)</a> <a id="3805" href="Typecheck.html#3805" class="Bound">γ</a> <a id="3807" href="Typecheck.html#3807" class="Bound">σ</a>   <a id="3811" class="Symbol">→</a> <a id="3813" class="Keyword">do</a>
    <a id="3820" class="Symbol">(</a><a id="3821" href="Typecheck.html#3821" class="Bound">τ</a> <a id="3823" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3825" href="Typecheck.html#3825" class="Bound">t′</a><a id="3827" class="Symbol">)</a> <a id="3829" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="3831" href="Typecheck.html#3802" class="Bound">t</a> <a id="3833" href="Typecheck.html#3805" class="Bound">γ</a>
    <a id="3839" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>     <a id="3848" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="3850" href="Types.html#1183" class="Function">fromMaybe</a> <a id="3860" class="Symbol">(</a><a id="3861" href="Types.html#791" class="InductiveConstructor Operator">At</a> <a id="3864" href="Typecheck.html#3795" class="Bound">r</a> <a id="3866" href="Types.html#791" class="InductiveConstructor Operator">Expected</a> <a id="3875" href="Typecheck.html#3807" class="Bound">σ</a> <a id="3877" href="Types.html#791" class="InductiveConstructor Operator">Got</a> <a id="3881" href="Typecheck.html#3821" class="Bound">τ</a><a id="3882" class="Symbol">)</a> <a id="3884" class="Symbol">(</a><a id="3885" href="Data.Maybe.Base.html#1285" class="Function">decToMaybe</a> <a id="3896" href="Function.html#1927" class="Function Operator">$</a> <a id="3898" href="Language.html#1302" class="Function">eqdecType</a> <a id="3908" href="Data.Nat.Properties.html#2153" class="Function Operator">ℕ._≟_</a> <a id="3914" href="Typecheck.html#3821" class="Bound">τ</a> <a id="3916" href="Typecheck.html#3807" class="Bound">σ</a><a id="3917" class="Symbol">)</a>
    <a id="3923" href="Category.Applicative.Indexed.html#905" class="Function">pure</a> <a id="3928" href="Function.html#1927" class="Function Operator">$</a> <a id="3930" href="Typecheck.html#3795" class="Bound">r</a> <a id="3932" href="Language.html#5421" class="InductiveConstructor Operator">&gt;`-</a> <a id="3936" href="Typecheck.html#3825" class="Bound">t′</a>

<a id="type-"></a><a id="3940" href="Typecheck.html#3940" class="Function">type-</a> <a id="3946" class="Symbol">:</a> <a id="3948" class="Symbol">∀</a> <a id="3950" class="Symbol">(</a><a id="3951" href="Typecheck.html#3951" class="Bound">m</a> <a id="3953" class="Symbol">:</a> <a id="3955" href="Language.html#764" class="Datatype">Mode</a><a id="3959" class="Symbol">)</a> <a id="3961" class="Symbol">(</a><a id="3962" href="Typecheck.html#3962" class="Bound">Σ</a> <a id="3964" class="Symbol">:</a> <a id="3966" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="3971" class="Symbol">(</a><a id="3972" href="Language.html#680" class="Datatype">Type</a> <a id="3977" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="3978" class="Symbol">))</a> <a id="3981" class="Symbol">→</a> <a id="3983" class="Keyword">let</a> <a id="3987" href="Typecheck.html#3987" class="Bound">Γ</a> <a id="3989" class="Symbol">=</a> <a id="3991" href="Data.List.Base.html#1186" class="Function">List.map</a> <a id="4000" class="Symbol">(</a><a id="4001" href="Function.html#1145" class="Function">const</a> <a id="4007" href="Language.html#783" class="InductiveConstructor">Infer</a><a id="4012" class="Symbol">)</a> <a id="4014" href="Typecheck.html#3962" class="Bound">Σ</a> <a id="4016" class="Keyword">in</a>
        <a id="4027" href="Language.html#2517" class="Function">Scoped</a> <a id="4034" href="Typecheck.html#3951" class="Bound">m</a> <a id="4036" href="Typecheck.html#3987" class="Bound">Γ</a> <a id="4038" class="Symbol">→</a> <a id="4040" href="Typecheck.html#2859" class="Function">Type-</a> <a id="4046" href="Typecheck.html#3951" class="Bound">m</a> <a id="4048" href="Typecheck.html#3987" class="Bound">Γ</a>
<a id="4050" href="Typecheck.html#3940" class="Function">type-</a> <a id="4056" href="Language.html#783" class="InductiveConstructor">Infer</a> <a id="4062" href="Typecheck.html#4062" class="Bound">Σ</a> <a id="4064" href="Typecheck.html#4064" class="Bound">t</a> <a id="4066" href="Typecheck.html#4066" class="Bound">γ</a>   <a id="4070" class="Symbol">=</a> <a id="4072" href="Generic.Semantics.html#707" class="Function">Sem.sem</a> <a id="4080" href="Typecheck.html#3099" class="Function">Typecheck</a> <a id="4090" class="Symbol">(</a><a id="4091" href="environment.html#383" class="InductiveConstructor">pack</a> <a id="4096" class="Symbol">(</a><a id="4097" href="Typecheck.html#1486" class="Function">var</a> <a id="4101" href="Typecheck.html#4062" class="Bound">Σ</a><a id="4102" class="Symbol">))</a> <a id="4105" href="Typecheck.html#4064" class="Bound">t</a> <a id="4107" href="Typecheck.html#4066" class="Bound">γ</a>
<a id="4109" href="Typecheck.html#3940" class="Function">type-</a> <a id="4115" href="Language.html#789" class="InductiveConstructor">Check</a> <a id="4121" href="Typecheck.html#4121" class="Bound">Σ</a> <a id="4123" href="Typecheck.html#4123" class="Bound">t</a> <a id="4125" href="Typecheck.html#4125" class="Bound">γ</a> <a id="4127" href="Typecheck.html#4127" class="Bound">σ</a> <a id="4129" class="Symbol">=</a> <a id="4131" href="Generic.Semantics.html#707" class="Function">Sem.sem</a> <a id="4139" href="Typecheck.html#3099" class="Function">Typecheck</a> <a id="4149" class="Symbol">(</a><a id="4150" href="environment.html#383" class="InductiveConstructor">pack</a> <a id="4155" class="Symbol">(</a><a id="4156" href="Typecheck.html#1486" class="Function">var</a> <a id="4160" href="Typecheck.html#4121" class="Bound">Σ</a><a id="4161" class="Symbol">))</a> <a id="4164" href="Typecheck.html#4123" class="Bound">t</a> <a id="4166" href="Typecheck.html#4125" class="Bound">γ</a> <a id="4168" href="Typecheck.html#4127" class="Bound">σ</a>
</pre></body></html>