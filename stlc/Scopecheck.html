<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Scopecheck</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="Scopecheck.html" class="Module">Scopecheck</a> <a id="19" class="Keyword">where</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Data.Product.html" class="Module">Data.Product</a> <a id="51" class="Symbol">as</a> <a id="54" class="Module">Product</a>
<a id="62" class="Keyword">open</a> <a id="67" class="Keyword">import</a> <a id="74" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="83" class="Keyword">open</a> <a id="88" class="Keyword">import</a> <a id="95" href="Data.String.html" class="Module">Data.String</a>
<a id="107" class="Keyword">open</a> <a id="112" class="Keyword">import</a> <a id="119" href="Data.String.Unsafe.html" class="Module">Data.String.Unsafe</a> <a id="138" class="Symbol">as</a> <a id="141" class="Module">String</a>
<a id="148" class="Keyword">open</a> <a id="153" class="Keyword">import</a> <a id="160" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="176" class="Keyword">using</a> <a id="182" class="Symbol">(</a><a id="183" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a><a id="188" class="Symbol">;</a> <a id="190" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a><a id="197" class="Symbol">;</a> <a id="199" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a><a id="203" class="Symbol">;</a> <a id="205" href="Data.Maybe.Base.html#1618" class="Function">maybe′</a><a id="211" class="Symbol">)</a>
<a id="213" class="Keyword">open</a> <a id="218" class="Keyword">import</a> <a id="225" href="Data.Sum.Base.html" class="Module">Data.Sum.Base</a> <a id="239" class="Symbol">as</a> <a id="242" class="Module">Sum</a> <a id="246" class="Keyword">using</a> <a id="252" class="Symbol">(</a><a id="253" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a><a id="257" class="Symbol">;</a> <a id="259" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a><a id="263" class="Symbol">;</a> <a id="265" href="Data.Sum.Base.html#1017" class="Function Operator">[_,_]′</a><a id="271" class="Symbol">)</a>
<a id="273" class="Keyword">open</a> <a id="278" class="Keyword">import</a> <a id="285" href="Data.List.html" class="Module">Data.List</a> <a id="295" class="Symbol">as</a> <a id="298" class="Module">List</a> <a id="303" class="Keyword">using</a> <a id="309" class="Symbol">(</a><a id="310" href="Data.List.Base.html#9863" class="InductiveConstructor">[]</a><a id="312" class="Symbol">)</a>
<a id="314" class="Keyword">open</a> <a id="319" class="Keyword">import</a> <a id="326" href="Data.List.Relation.Unary.All.html" class="Module">Data.List.Relation.Unary.All</a> <a id="355" class="Symbol">as</a> <a id="358" class="Module">All</a> <a id="362" class="Keyword">using</a> <a id="368" class="Symbol">(</a><a id="369" href="Data.List.Relation.Unary.All.html#967" class="Datatype">All</a><a id="372" class="Symbol">)</a>
<a id="374" class="Keyword">open</a> <a id="379" class="Keyword">import</a> <a id="386" href="Data.List.Relation.Unary.All.Properties.html" class="Module">Data.List.Relation.Unary.All.Properties</a>
<a id="426" class="Keyword">open</a> <a id="431" class="Keyword">import</a> <a id="438" href="Function.html" class="Module">Function</a>

<a id="448" class="Keyword">open</a> <a id="453" class="Keyword">import</a> <a id="460" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="475" class="Keyword">open</a> <a id="480" class="Keyword">import</a> <a id="487" href="Category.Monad.State.html" class="Module">Category.Monad.State</a>

<a id="509" class="Keyword">open</a> <a id="514" class="Keyword">import</a> <a id="521" href="Generic.Syntax.html" class="Module">Generic.Syntax</a>
<a id="536" class="Keyword">open</a> <a id="541" class="Keyword">import</a> <a id="548" href="Generic.AltSyntax.html" class="Module">Generic.AltSyntax</a>

<a id="567" class="Keyword">open</a> <a id="572" class="Keyword">import</a> <a id="579" href="Text.Parser.Position.html" class="Module">Text.Parser.Position</a>

<a id="601" class="Keyword">open</a> <a id="606" class="Keyword">import</a> <a id="613" href="Language.html" class="Module">Language</a>
<a id="622" class="Keyword">open</a> <a id="627" href="Language.html#2909" class="Module">Surface</a>
<a id="635" class="Keyword">open</a> <a id="640" class="Keyword">import</a> <a id="647" href="Types.html" class="Module">Types</a>

<a id="654" class="Keyword">module</a> <a id="661" href="Scopecheck.html#661" class="Module">_</a> <a id="663" class="Keyword">where</a>

  <a id="672" href="Scopecheck.html#672" class="Function">M</a> <a id="674" class="Symbol">=</a> <a id="676" href="Category.Monad.State.html#4416" class="Function">State</a> <a id="682" class="Symbol">(</a><a id="683" href="Data.Map.html#364" class="Function">Map</a> <a id="687" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="689" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="690" class="Symbol">)</a>
  <a id="694" class="Keyword">open</a> <a id="699" href="Category.Monad.State.html#3607" class="Module">RawMonadState</a> <a id="713" class="Symbol">(</a><a id="714" href="Category.Monad.State.html#4574" class="Function">StateMonadState</a> <a id="730" class="Symbol">(</a><a id="731" href="Data.Map.html#364" class="Function">Map</a> <a id="735" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="737" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="738" class="Symbol">))</a> <a id="741" class="Keyword">hiding</a> <a id="748" class="Symbol">(</a>_⊗_<a id="752" class="Symbol">)</a>

  <a id="757" href="Scopecheck.html#757" class="Function">resolve</a> <a id="765" class="Symbol">:</a> <a id="767" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="774" class="Symbol">→</a> <a id="776" href="Scopecheck.html#672" class="Function">M</a> <a id="778" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a>
  <a id="782" href="Scopecheck.html#757" class="Function">resolve</a> <a id="790" href="Scopecheck.html#790" class="Bound">str</a> <a id="794" class="Symbol">=</a> <a id="796" class="Keyword">do</a>
    <a id="803" class="Symbol">(</a><a id="804" href="Scopecheck.html#804" class="Bound">mp</a> <a id="807" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="809" href="Scopecheck.html#809" class="Bound">gen</a><a id="812" class="Symbol">)</a> <a id="814" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="816" href="Category.Monad.State.html#2900" class="Function">get</a>
    <a id="824" href="Function.html#3533" class="Function Operator">case</a> <a id="829" href="Data.Map.html#517" class="Function">Map.assoc</a> <a id="839" href="Scopecheck.html#790" class="Bound">str</a> <a id="843" href="Scopecheck.html#804" class="Bound">mp</a> <a id="846" href="Function.html#3533" class="Function Operator">of</a> <a id="849" class="Symbol">λ</a> <a id="851" class="Keyword">where</a>
      <a id="863" class="Symbol">(</a><a id="864" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="869" href="Scopecheck.html#869" class="Bound">n</a><a id="870" class="Symbol">)</a> <a id="872" class="Symbol">→</a> <a id="874" href="Category.Monad.Indexed.html#569" class="Function">return</a> <a id="881" href="Scopecheck.html#869" class="Bound">n</a>
      <a id="889" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a>  <a id="898" class="Symbol">→</a> <a id="900" class="Keyword">do</a>
        <a id="911" href="Category.Monad.State.html#2932" class="Function">put</a> <a id="915" class="Symbol">(</a><a id="916" href="Data.Map.html#462" class="Function">Map.set</a> <a id="924" href="Scopecheck.html#790" class="Bound">str</a> <a id="928" href="Scopecheck.html#809" class="Bound">gen</a> <a id="932" href="Scopecheck.html#804" class="Bound">mp</a> <a id="935" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="937" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="941" href="Scopecheck.html#809" class="Bound">gen</a><a id="944" class="Symbol">)</a>
        <a id="954" href="Category.Monad.Indexed.html#569" class="Function">return</a> <a id="961" href="Scopecheck.html#809" class="Bound">gen</a>

  <a id="968" href="Scopecheck.html#968" class="Function">cleanupType</a> <a id="980" class="Symbol">:</a> <a id="982" href="Language.html#853" class="Datatype">Type</a> <a id="987" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="994" class="Symbol">→</a> <a id="996" href="Scopecheck.html#672" class="Function">M</a> <a id="998" class="Symbol">(</a><a id="999" href="Language.html#853" class="Datatype">Type</a> <a id="1004" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="1005" class="Symbol">)</a>
  <a id="1009" href="Scopecheck.html#968" class="Function">cleanupType</a> <a id="1021" class="Symbol">(</a><a id="1022" href="Language.html#882" class="InductiveConstructor">α</a> <a id="1024" href="Scopecheck.html#1024" class="Bound">str</a><a id="1027" class="Symbol">)</a> <a id="1029" class="Symbol">=</a> <a id="1031" href="Language.html#882" class="InductiveConstructor">α</a> <a id="1033" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="1037" href="Scopecheck.html#757" class="Function">resolve</a> <a id="1045" href="Scopecheck.html#1024" class="Bound">str</a>
  <a id="1051" href="Scopecheck.html#968" class="Function">cleanupType</a> <a id="1063" class="Symbol">(</a><a id="1064" href="Scopecheck.html#1064" class="Bound">σ</a> <a id="1066" href="Language.html#933" class="InductiveConstructor Operator">⇒</a> <a id="1068" href="Scopecheck.html#1068" class="Bound">τ</a><a id="1069" class="Symbol">)</a> <a id="1071" class="Symbol">=</a> <a id="1073" href="Language.html#933" class="InductiveConstructor Operator">_⇒_</a> <a id="1077" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="1081" href="Scopecheck.html#968" class="Function">cleanupType</a> <a id="1093" href="Scopecheck.html#1064" class="Bound">σ</a> <a id="1095" href="Category.Applicative.Indexed.html#938" class="Function Operator">⊛</a> <a id="1097" href="Scopecheck.html#968" class="Function">cleanupType</a> <a id="1109" href="Scopecheck.html#1068" class="Bound">τ</a>
  <a id="1113" href="Scopecheck.html#968" class="Function">cleanupType</a> <a id="1125" class="Symbol">(</a><a id="1126" href="Scopecheck.html#1126" class="Bound">σ</a> <a id="1128" href="Language.html#901" class="InductiveConstructor Operator">⊗</a> <a id="1130" href="Scopecheck.html#1130" class="Bound">τ</a><a id="1131" class="Symbol">)</a> <a id="1133" class="Symbol">=</a> <a id="1135" href="Language.html#901" class="InductiveConstructor Operator">_⊗_</a> <a id="1139" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="1143" href="Scopecheck.html#968" class="Function">cleanupType</a> <a id="1155" href="Scopecheck.html#1126" class="Bound">σ</a> <a id="1157" href="Category.Applicative.Indexed.html#938" class="Function Operator">⊛</a> <a id="1159" href="Scopecheck.html#968" class="Function">cleanupType</a> <a id="1171" href="Scopecheck.html#1130" class="Bound">τ</a>

  <a id="1176" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1188" class="Symbol">:</a> <a id="1190" class="Symbol">∀</a> <a id="1192" class="Symbol">{</a><a id="1193" href="Scopecheck.html#1193" class="Bound">i</a> <a id="1195" href="Scopecheck.html#1195" class="Bound">σ</a> <a id="1197" href="Scopecheck.html#1197" class="Bound">Γ</a><a id="1198" class="Symbol">}</a> <a id="1200" class="Symbol">→</a> <a id="1202" href="Generic.Syntax.html#1063" class="Datatype">Tm</a> <a id="1205" class="Symbol">(</a><a id="1206" href="Language.html#3087" class="Function">surface</a> <a id="1214" href="Agda.Builtin.String.html#165" class="Postulate">String</a><a id="1220" class="Symbol">)</a> <a id="1222" href="Scopecheck.html#1193" class="Bound">i</a> <a id="1224" href="Scopecheck.html#1195" class="Bound">σ</a> <a id="1226" href="Scopecheck.html#1197" class="Bound">Γ</a> <a id="1228" class="Symbol">→</a> <a id="1230" href="Scopecheck.html#672" class="Function">M</a> <a id="1232" class="Symbol">(</a><a id="1233" href="Language.html#3660" class="Function">Scoped</a> <a id="1240" href="Scopecheck.html#1195" class="Bound">σ</a> <a id="1242" href="Scopecheck.html#1197" class="Bound">Γ</a><a id="1243" class="Symbol">)</a>
  <a id="1247" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1259" class="Symbol">(</a><a id="1260" href="Generic.Syntax.html#1116" class="InductiveConstructor">`var</a> <a id="1265" href="Scopecheck.html#1265" class="Bound">k</a><a id="1266" class="Symbol">)</a>          <a id="1277" class="Symbol">=</a> <a id="1279" href="Category.Monad.Indexed.html#569" class="Function">return</a> <a id="1286" href="Function.html#1927" class="Function Operator">$</a> <a id="1288" href="Generic.Syntax.html#1116" class="InductiveConstructor">`var</a> <a id="1293" href="Scopecheck.html#1265" class="Bound">k</a>
  <a id="1297" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1309" class="Symbol">(</a><a id="1310" href="Scopecheck.html#1310" class="Bound">r</a> <a id="1312" href="Language.html#7154" class="InductiveConstructor Operator">&gt;[</a> <a id="1315" href="Scopecheck.html#1315" class="Bound">t</a> <a id="1317" href="Language.html#7154" class="InductiveConstructor Operator">`∶</a> <a id="1320" href="Scopecheck.html#1320" class="Bound">σ</a> <a id="1322" href="Language.html#7154" class="InductiveConstructor Operator">]</a><a id="1323" class="Symbol">)</a>   <a id="1327" class="Symbol">=</a> <a id="1329" href="Scopecheck.html#1310" class="Bound">r</a> <a id="1331" href="Language.html#7154" class="InductiveConstructor Operator">&gt;[_`∶_]</a> <a id="1339" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="1343" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1355" href="Scopecheck.html#1315" class="Bound">t</a> <a id="1357" href="Category.Applicative.Indexed.html#938" class="Function Operator">⊛</a> <a id="1359" href="Scopecheck.html#968" class="Function">cleanupType</a> <a id="1371" href="Scopecheck.html#1320" class="Bound">σ</a>
  <a id="1375" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1387" class="Symbol">(</a><a id="1388" href="Scopecheck.html#1388" class="Bound">r</a> <a id="1390" href="Language.html#7263" class="InductiveConstructor Operator">&gt;[</a> <a id="1393" href="Scopecheck.html#1393" class="Bound">f</a> <a id="1395" href="Language.html#7263" class="InductiveConstructor Operator">`$</a> <a id="1398" href="Scopecheck.html#1398" class="Bound">t</a> <a id="1400" href="Language.html#7263" class="InductiveConstructor Operator">]</a><a id="1401" class="Symbol">)</a>   <a id="1405" class="Symbol">=</a> <a id="1407" href="Scopecheck.html#1388" class="Bound">r</a> <a id="1409" href="Language.html#7263" class="InductiveConstructor Operator">&gt;[_`$_]</a> <a id="1417" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="1421" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1433" href="Scopecheck.html#1393" class="Bound">f</a> <a id="1435" href="Category.Applicative.Indexed.html#938" class="Function Operator">⊛</a> <a id="1437" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1449" href="Scopecheck.html#1398" class="Bound">t</a>
  <a id="1453" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1465" class="Symbol">(</a><a id="1466" href="Scopecheck.html#1466" class="Bound">r</a> <a id="1468" href="Language.html#7368" class="InductiveConstructor Operator">&gt;`fst</a> <a id="1474" href="Scopecheck.html#1474" class="Bound">b</a><a id="1475" class="Symbol">)</a>       <a id="1483" class="Symbol">=</a> <a id="1485" href="Scopecheck.html#1466" class="Bound">r</a> <a id="1487" href="Language.html#7368" class="InductiveConstructor Operator">&gt;`fst_</a>  <a id="1495" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="1499" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1511" href="Scopecheck.html#1474" class="Bound">b</a>
  <a id="1515" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1527" class="Symbol">(</a><a id="1528" href="Scopecheck.html#1528" class="Bound">r</a> <a id="1530" href="Language.html#7469" class="InductiveConstructor Operator">&gt;`snd</a> <a id="1536" href="Scopecheck.html#1536" class="Bound">b</a><a id="1537" class="Symbol">)</a>       <a id="1545" class="Symbol">=</a> <a id="1547" href="Scopecheck.html#1528" class="Bound">r</a> <a id="1549" href="Language.html#7469" class="InductiveConstructor Operator">&gt;`snd_</a>  <a id="1557" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="1561" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1573" href="Scopecheck.html#1536" class="Bound">b</a>
  <a id="1577" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1589" class="Symbol">(</a><a id="1590" href="Scopecheck.html#1590" class="Bound">r</a> <a id="1592" href="Language.html#7570" class="InductiveConstructor Operator">&gt;`λ</a> <a id="1596" href="Scopecheck.html#1596" class="Bound">b</a><a id="1597" class="Symbol">)</a>         <a id="1607" class="Symbol">=</a> <a id="1609" href="Scopecheck.html#1590" class="Bound">r</a> <a id="1611" href="Language.html#7570" class="InductiveConstructor Operator">&gt;`λ_</a>  <a id="1617" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="1621" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1633" href="Scopecheck.html#1596" class="Bound">b</a>
  <a id="1637" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1649" class="Symbol">(</a><a id="1650" href="Scopecheck.html#1650" class="Bound">r</a> <a id="1652" href="Language.html#7673" class="InductiveConstructor Operator">&gt;[</a> <a id="1655" href="Scopecheck.html#1655" class="Bound">a</a> <a id="1657" href="Language.html#7673" class="InductiveConstructor Operator">`,</a> <a id="1660" href="Scopecheck.html#1660" class="Bound">b</a> <a id="1662" href="Language.html#7673" class="InductiveConstructor Operator">]</a><a id="1663" class="Symbol">)</a>   <a id="1667" class="Symbol">=</a> <a id="1669" href="Scopecheck.html#1650" class="Bound">r</a> <a id="1671" href="Language.html#7673" class="InductiveConstructor Operator">&gt;[_`,_]</a> <a id="1679" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="1683" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1695" href="Scopecheck.html#1655" class="Bound">a</a> <a id="1697" href="Category.Applicative.Indexed.html#938" class="Function Operator">⊛</a> <a id="1699" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1711" href="Scopecheck.html#1660" class="Bound">b</a>
  <a id="1715" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1727" class="Symbol">(</a><a id="1728" href="Scopecheck.html#1728" class="Bound">r</a> <a id="1730" href="Language.html#7783" class="InductiveConstructor Operator">&gt;`let</a> <a id="1736" href="Scopecheck.html#1736" class="Bound">e</a> <a id="1738" href="Language.html#7783" class="InductiveConstructor Operator">`in</a> <a id="1742" href="Scopecheck.html#1742" class="Bound">b</a><a id="1743" class="Symbol">)</a> <a id="1745" class="Symbol">=</a> <a id="1747" href="Scopecheck.html#1728" class="Bound">r</a> <a id="1749" href="Language.html#7783" class="InductiveConstructor Operator">&gt;`let_`in_</a> <a id="1760" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="1764" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1776" href="Scopecheck.html#1736" class="Bound">e</a> <a id="1778" href="Category.Applicative.Indexed.html#938" class="Function Operator">⊛</a> <a id="1780" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1792" href="Scopecheck.html#1742" class="Bound">b</a>
  <a id="1796" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1808" class="Symbol">(</a><a id="1809" href="Scopecheck.html#1809" class="Bound">r</a> <a id="1811" href="Language.html#7890" class="InductiveConstructor Operator">&gt;`-</a> <a id="1815" href="Scopecheck.html#1815" class="Bound">t</a><a id="1816" class="Symbol">)</a>         <a id="1826" class="Symbol">=</a> <a id="1828" href="Scopecheck.html#1809" class="Bound">r</a> <a id="1830" href="Language.html#7890" class="InductiveConstructor Operator">&gt;`-_</a>  <a id="1836" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="1840" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="1852" href="Scopecheck.html#1815" class="Bound">t</a>

<a id="1855" class="Keyword">open</a> <a id="1860" href="Category.Monad.html#810" class="Module">RawMonad</a> <a id="1869" class="Symbol">(</a><a id="1870" href="Types.html#2469" class="Function">Compiler.monad</a> <a id="1885" href="Agda.Builtin.String.html#165" class="Postulate">String</a><a id="1891" class="Symbol">)</a>
<a id="1893" class="Keyword">open</a> <a id="1898" href="Types.html#2451" class="Module">Compiler</a>
<a id="1907" class="Keyword">open</a> <a id="1912" href="Generic.AltSyntax.html#1880" class="Module">ScopeCheck</a>

<a id="scopecheck"></a><a id="1924" href="Scopecheck.html#1924" class="Function">scopecheck</a> <a id="1935" class="Symbol">:</a> <a id="1937" class="Symbol">∀</a> <a id="1939" class="Symbol">{</a><a id="1940" href="Scopecheck.html#1940" class="Bound">Σ</a> <a id="1942" href="Scopecheck.html#1942" class="Bound">m</a><a id="1943" class="Symbol">}</a> <a id="1945" class="Symbol">(</a><a id="1946" href="Scopecheck.html#1946" class="Bound">p</a> <a id="1948" class="Symbol">:</a> <a id="1950" href="Language.html#8850" class="Datatype">Definitions</a> <a id="1962" href="Scopecheck.html#1940" class="Bound">Σ</a><a id="1963" class="Symbol">)</a> <a id="1965" class="Symbol">→</a> <a id="1967" href="Language.html#3594" class="Function">Parsed</a> <a id="1974" href="Scopecheck.html#1942" class="Bound">m</a> <a id="1976" class="Symbol">→</a>
             <a id="1991" href="Types.html#2371" class="Function">Compiler</a> <a id="2000" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="2007" class="Symbol">(</a><a id="2008" href="Language.html#3660" class="Function">Scoped</a> <a id="2015" href="Scopecheck.html#1942" class="Bound">m</a> <a id="2017" class="Symbol">(</a><a id="2018" href="Language.html#9340" class="Function">modes</a> <a id="2024" href="Scopecheck.html#1946" class="Bound">p</a><a id="2025" class="Symbol">))</a>
<a id="2028" href="Scopecheck.html#1924" class="Function">scopecheck</a> <a id="2039" href="Scopecheck.html#2039" class="Bound">p</a> <a id="2041" href="Scopecheck.html#2041" class="Bound">r</a> <a id="2043" class="Symbol">=</a> <a id="2045" class="Keyword">do</a>
  <a id="2050" class="Keyword">let</a> <a id="2054" href="Scopecheck.html#2054" class="Bound">scopeError</a> <a id="2065" class="Symbol">=</a> <a id="2067" href="Data.Product.html#3500" class="Function">uncurry</a> <a id="2075" href="Types.html#797" class="InductiveConstructor Operator">At_OutOfScope_</a>
  <a id="2092" href="Scopecheck.html#2092" class="Bound">t</a>  <a id="2095" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="2097" href="Types.html#2564" class="Function">liftResult</a> <a id="2108" href="Function.html#1927" class="Function Operator">$</a> <a id="2110" href="Data.Sum.Base.html#1378" class="Function">Sum.map₁</a> <a id="2119" href="Scopecheck.html#2054" class="Bound">scopeError</a> <a id="2130" href="Function.html#1927" class="Function Operator">$</a> <a id="2132" href="Generic.AltSyntax.html#2365" class="Function">scopeCheck</a> <a id="2143" href="Language.html#1282" class="Function">eqdecMode</a> <a id="2153" class="Symbol">_</a> <a id="2155" class="Symbol">_</a> <a id="2157" class="Symbol">(</a><a id="2158" href="Language.html#9422" class="Function">names</a> <a id="2164" href="Scopecheck.html#2039" class="Bound">p</a><a id="2165" class="Symbol">)</a> <a id="2167" href="Scopecheck.html#2041" class="Bound">r</a>
  <a id="2171" href="Types.html#2636" class="Function">liftState</a> <a id="2181" href="Function.html#1927" class="Function Operator">$</a> <a id="2183" href="Scopecheck.html#1176" class="Function">cleanupTerm</a> <a id="2195" href="Scopecheck.html#2092" class="Bound">t</a>
</pre></body></html>