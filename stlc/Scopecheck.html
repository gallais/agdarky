<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Scopecheck</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="Scopecheck.html" class="Module">Scopecheck</a> <a id="19" class="Keyword">where</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Data.Product.html" class="Module">Data.Product</a> <a id="51" class="Symbol">as</a> <a id="54" class="Module">Product</a>
<a id="62" class="Keyword">open</a> <a id="67" class="Keyword">import</a> <a id="74" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="83" class="Keyword">open</a> <a id="88" class="Keyword">import</a> <a id="95" href="Data.String.html" class="Module">Data.String</a>
<a id="107" class="Keyword">open</a> <a id="112" class="Keyword">import</a> <a id="119" href="Data.String.Unsafe.html" class="Module">Data.String.Unsafe</a> <a id="138" class="Symbol">as</a> <a id="141" class="Module">String</a>
<a id="148" class="Keyword">open</a> <a id="153" class="Keyword">import</a> <a id="160" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="176" class="Keyword">using</a> <a id="182" class="Symbol">(</a><a id="183" href="Data.Maybe.Base.html#335" class="Datatype">Maybe</a><a id="188" class="Symbol">;</a> <a id="190" href="Data.Maybe.Base.html#403" class="InductiveConstructor">nothing</a><a id="197" class="Symbol">;</a> <a id="199" href="Data.Maybe.Base.html#373" class="InductiveConstructor">just</a><a id="203" class="Symbol">;</a> <a id="205" href="Data.Maybe.Base.html#1550" class="Function">maybe′</a><a id="211" class="Symbol">)</a>
<a id="213" class="Keyword">open</a> <a id="218" class="Keyword">import</a> <a id="225" href="Data.Sum.Base.html" class="Module">Data.Sum.Base</a> <a id="239" class="Symbol">as</a> <a id="242" class="Module">Sum</a> <a id="246" class="Keyword">using</a> <a id="252" class="Symbol">(</a><a id="253" href="Data.Sum.Base.html#475" class="InductiveConstructor">inj₁</a><a id="257" class="Symbol">;</a> <a id="259" href="Data.Sum.Base.html#500" class="InductiveConstructor">inj₂</a><a id="263" class="Symbol">;</a> <a id="265" href="Data.Sum.Base.html#927" class="Function Operator">[_,_]′</a><a id="271" class="Symbol">)</a>
<a id="273" class="Keyword">open</a> <a id="278" class="Keyword">import</a> <a id="285" href="Data.List.html" class="Module">Data.List</a> <a id="295" class="Symbol">as</a> <a id="298" class="Module">List</a> <a id="303" class="Keyword">using</a> <a id="309" class="Symbol">(</a><a id="310" href="Data.List.Base.html#8785" class="InductiveConstructor">[]</a><a id="312" class="Symbol">)</a>
<a id="314" class="Keyword">open</a> <a id="319" class="Keyword">import</a> <a id="326" href="Data.List.All.html" class="Module">Data.List.All</a> <a id="340" class="Symbol">as</a> <a id="343" class="Module">All</a> <a id="347" class="Keyword">using</a> <a id="353" class="Symbol">(</a><a id="354" href="Data.List.All.html#826" class="Datatype">All</a><a id="357" class="Symbol">)</a>
<a id="359" class="Keyword">open</a> <a id="364" class="Keyword">import</a> <a id="371" href="Data.List.All.Properties.html" class="Module">Data.List.All.Properties</a>
<a id="396" class="Keyword">open</a> <a id="401" class="Keyword">import</a> <a id="408" href="Function.html" class="Module">Function</a>

<a id="418" class="Keyword">open</a> <a id="423" class="Keyword">import</a> <a id="430" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="445" class="Keyword">open</a> <a id="450" class="Keyword">import</a> <a id="457" href="Category.Monad.State.html" class="Module">Category.Monad.State</a>

<a id="479" class="Keyword">open</a> <a id="484" class="Keyword">import</a> <a id="491" href="Generic.Syntax.html" class="Module">Generic.Syntax</a>
<a id="506" class="Keyword">open</a> <a id="511" class="Keyword">import</a> <a id="518" href="Generic.AltSyntax.html" class="Module">Generic.AltSyntax</a>

<a id="537" class="Keyword">open</a> <a id="542" class="Keyword">import</a> <a id="549" href="Text.Parser.Position.html" class="Module">Text.Parser.Position</a>

<a id="571" class="Keyword">open</a> <a id="576" class="Keyword">import</a> <a id="583" href="Language.html" class="Module">Language</a>
<a id="592" class="Keyword">open</a> <a id="597" href="Language.html#2894" class="Module">Surface</a>
<a id="605" class="Keyword">open</a> <a id="610" class="Keyword">import</a> <a id="617" href="Types.html" class="Module">Types</a>

<a id="624" class="Keyword">module</a> <a id="631" href="Scopecheck.html#631" class="Module">_</a> <a id="633" class="Keyword">where</a>

  <a id="642" href="Scopecheck.html#642" class="Function">M</a> <a id="644" class="Symbol">=</a> <a id="646" href="Category.Monad.State.html#3274" class="Function">State</a> <a id="652" class="Symbol">(</a><a id="653" href="Data.Map.html#364" class="Function">Map</a> <a id="657" href="Data.Product.html#1353" class="Function Operator">×</a> <a id="659" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="660" class="Symbol">)</a>
  <a id="664" class="Keyword">open</a> <a id="669" href="Category.Monad.State.html#2465" class="Module">RawMonadState</a> <a id="683" class="Symbol">(</a><a id="684" href="Category.Monad.State.html#3432" class="Function">StateMonadState</a> <a id="700" class="Symbol">(</a><a id="701" href="Data.Map.html#364" class="Function">Map</a> <a id="705" href="Data.Product.html#1353" class="Function Operator">×</a> <a id="707" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="708" class="Symbol">))</a> <a id="711" class="Keyword">hiding</a> <a id="718" class="Symbol">(</a>_⊗_<a id="722" class="Symbol">)</a>

  <a id="727" href="Scopecheck.html#727" class="Function">resolve</a> <a id="735" class="Symbol">:</a> <a id="737" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="744" class="Symbol">→</a> <a id="746" href="Scopecheck.html#642" class="Function">M</a> <a id="748" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a>
  <a id="752" href="Scopecheck.html#727" class="Function">resolve</a> <a id="760" href="Scopecheck.html#760" class="Bound">str</a> <a id="764" class="Symbol">=</a> <a id="766" class="Keyword">do</a>
    <a id="773" class="Symbol">(</a><a id="774" href="Scopecheck.html#774" class="Bound">mp</a> <a id="777" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="779" href="Scopecheck.html#779" class="Bound">gen</a><a id="782" class="Symbol">)</a> <a id="784" href="Category.Monad.Indexed.html#568" class="Function Operator">←</a> <a id="786" href="Category.Monad.State.html#1758" class="Function">get</a>
    <a id="794" href="Function.html#3497" class="Function Operator">case</a> <a id="799" href="Data.Map.html#517" class="Function">Map.assoc</a> <a id="809" href="Scopecheck.html#760" class="Bound">str</a> <a id="813" href="Scopecheck.html#774" class="Bound">mp</a> <a id="816" href="Function.html#3497" class="Function Operator">of</a> <a id="819" class="Symbol">λ</a> <a id="821" class="Keyword">where</a>
      <a id="833" class="Symbol">(</a><a id="834" href="Data.Maybe.Base.html#373" class="InductiveConstructor">just</a> <a id="839" href="Scopecheck.html#839" class="Bound">n</a><a id="840" class="Symbol">)</a> <a id="842" class="Symbol">→</a> <a id="844" href="Category.Monad.Indexed.html#533" class="Function">return</a> <a id="851" href="Scopecheck.html#839" class="Bound">n</a>
      <a id="859" href="Data.Maybe.Base.html#403" class="InductiveConstructor">nothing</a>  <a id="868" class="Symbol">→</a> <a id="870" class="Keyword">do</a>
        <a id="881" href="Category.Monad.State.html#1790" class="Function">put</a> <a id="885" class="Symbol">(</a><a id="886" href="Data.Map.html#462" class="Function">Map.set</a> <a id="894" href="Scopecheck.html#760" class="Bound">str</a> <a id="898" href="Scopecheck.html#779" class="Bound">gen</a> <a id="902" href="Scopecheck.html#774" class="Bound">mp</a> <a id="905" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="907" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="911" href="Scopecheck.html#779" class="Bound">gen</a><a id="914" class="Symbol">)</a>
        <a id="924" href="Category.Monad.Indexed.html#533" class="Function">return</a> <a id="931" href="Scopecheck.html#779" class="Bound">gen</a>

  <a id="938" href="Scopecheck.html#938" class="Function">cleanupType</a> <a id="950" class="Symbol">:</a> <a id="952" href="Language.html#838" class="Datatype">Type</a> <a id="957" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="964" class="Symbol">→</a> <a id="966" href="Scopecheck.html#642" class="Function">M</a> <a id="968" class="Symbol">(</a><a id="969" href="Language.html#838" class="Datatype">Type</a> <a id="974" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="975" class="Symbol">)</a>
  <a id="979" href="Scopecheck.html#938" class="Function">cleanupType</a> <a id="991" class="Symbol">(</a><a id="992" href="Language.html#867" class="InductiveConstructor">α</a> <a id="994" href="Scopecheck.html#994" class="Bound">str</a><a id="997" class="Symbol">)</a> <a id="999" class="Symbol">=</a> <a id="1001" href="Language.html#867" class="InductiveConstructor">α</a> <a id="1003" href="Category.Functor.html#492" class="Function Operator">&lt;$&gt;</a> <a id="1007" href="Scopecheck.html#727" class="Function">resolve</a> <a id="1015" href="Scopecheck.html#994" class="Bound">str</a>
  <a id="1021" href="Scopecheck.html#938" class="Function">cleanupType</a> <a id="1033" class="Symbol">(</a><a id="1034" href="Scopecheck.html#1034" class="Bound">σ</a> <a id="1036" href="Language.html#918" class="InductiveConstructor Operator">⇒</a> <a id="1038" href="Scopecheck.html#1038" class="Bound">τ</a><a id="1039" class="Symbol">)</a> <a id="1041" class="Symbol">=</a> <a id="1043" href="Language.html#918" class="InductiveConstructor Operator">_⇒_</a> <a id="1047" href="Category.Functor.html#492" class="Function Operator">&lt;$&gt;</a> <a id="1051" href="Scopecheck.html#938" class="Function">cleanupType</a> <a id="1063" href="Scopecheck.html#1034" class="Bound">σ</a> <a id="1065" href="Category.Applicative.Indexed.html#780" class="Function Operator">⊛</a> <a id="1067" href="Scopecheck.html#938" class="Function">cleanupType</a> <a id="1079" href="Scopecheck.html#1038" class="Bound">τ</a>
  <a id="1083" href="Scopecheck.html#938" class="Function">cleanupType</a> <a id="1095" class="Symbol">(</a><a id="1096" href="Scopecheck.html#1096" class="Bound">σ</a> <a id="1098" href="Language.html#886" class="InductiveConstructor Operator">⊗</a> <a id="1100" href="Scopecheck.html#1100" class="Bound">τ</a><a id="1101" class="Symbol">)</a> <a id="1103" class="Symbol">=</a> <a id="1105" href="Language.html#886" class="InductiveConstructor Operator">_⊗_</a> <a id="1109" href="Category.Functor.html#492" class="Function Operator">&lt;$&gt;</a> <a id="1113" href="Scopecheck.html#938" class="Function">cleanupType</a> <a id="1125" href="Scopecheck.html#1096" class="Bound">σ</a> <a id="1127" href="Category.Applicative.Indexed.html#780" class="Function Operator">⊛</a> <a id="1129" href="Scopecheck.html#938" class="Function">cleanupType</a> <a id="1141" href="Scopecheck.html#1100" class="Bound">τ</a>

  <a id="1146" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1158" class="Symbol">:</a> <a id="1160" class="Symbol">∀</a> <a id="1162" class="Symbol">{</a><a id="1163" href="Scopecheck.html#1163" class="Bound">i</a> <a id="1165" href="Scopecheck.html#1165" class="Bound">σ</a> <a id="1167" href="Scopecheck.html#1167" class="Bound">Γ</a><a id="1168" class="Symbol">}</a> <a id="1170" class="Symbol">→</a> <a id="1172" href="Generic.Syntax.html#1063" class="Datatype">Tm</a> <a id="1175" class="Symbol">(</a><a id="1176" href="Language.html#3072" class="Function">surface</a> <a id="1184" href="Agda.Builtin.String.html#165" class="Postulate">String</a><a id="1190" class="Symbol">)</a> <a id="1192" href="Scopecheck.html#1163" class="Bound">i</a> <a id="1194" href="Scopecheck.html#1165" class="Bound">σ</a> <a id="1196" href="Scopecheck.html#1167" class="Bound">Γ</a> <a id="1198" class="Symbol">→</a> <a id="1200" href="Scopecheck.html#642" class="Function">M</a> <a id="1202" class="Symbol">(</a><a id="1203" href="Language.html#3645" class="Function">Scoped</a> <a id="1210" href="Scopecheck.html#1165" class="Bound">σ</a> <a id="1212" href="Scopecheck.html#1167" class="Bound">Γ</a><a id="1213" class="Symbol">)</a>
  <a id="1217" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1229" class="Symbol">(</a><a id="1230" href="Generic.Syntax.html#1116" class="InductiveConstructor">`var</a> <a id="1235" href="Scopecheck.html#1235" class="Bound">k</a><a id="1236" class="Symbol">)</a>          <a id="1247" class="Symbol">=</a> <a id="1249" href="Category.Monad.Indexed.html#533" class="Function">return</a> <a id="1256" href="Function.html#1891" class="Function Operator">$</a> <a id="1258" href="Generic.Syntax.html#1116" class="InductiveConstructor">`var</a> <a id="1263" href="Scopecheck.html#1235" class="Bound">k</a>
  <a id="1267" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1279" class="Symbol">(</a><a id="1280" href="Scopecheck.html#1280" class="Bound">r</a> <a id="1282" href="Language.html#7139" class="InductiveConstructor Operator">&gt;[</a> <a id="1285" href="Scopecheck.html#1285" class="Bound">t</a> <a id="1287" href="Language.html#7139" class="InductiveConstructor Operator">`∶</a> <a id="1290" href="Scopecheck.html#1290" class="Bound">σ</a> <a id="1292" href="Language.html#7139" class="InductiveConstructor Operator">]</a><a id="1293" class="Symbol">)</a>   <a id="1297" class="Symbol">=</a> <a id="1299" href="Scopecheck.html#1280" class="Bound">r</a> <a id="1301" href="Language.html#7139" class="InductiveConstructor Operator">&gt;[_`∶_]</a> <a id="1309" href="Category.Functor.html#492" class="Function Operator">&lt;$&gt;</a> <a id="1313" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1325" href="Scopecheck.html#1285" class="Bound">t</a> <a id="1327" href="Category.Applicative.Indexed.html#780" class="Function Operator">⊛</a> <a id="1329" href="Scopecheck.html#938" class="Function">cleanupType</a> <a id="1341" href="Scopecheck.html#1290" class="Bound">σ</a>
  <a id="1345" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1357" class="Symbol">(</a><a id="1358" href="Scopecheck.html#1358" class="Bound">r</a> <a id="1360" href="Language.html#7248" class="InductiveConstructor Operator">&gt;[</a> <a id="1363" href="Scopecheck.html#1363" class="Bound">f</a> <a id="1365" href="Language.html#7248" class="InductiveConstructor Operator">`$</a> <a id="1368" href="Scopecheck.html#1368" class="Bound">t</a> <a id="1370" href="Language.html#7248" class="InductiveConstructor Operator">]</a><a id="1371" class="Symbol">)</a>   <a id="1375" class="Symbol">=</a> <a id="1377" href="Scopecheck.html#1358" class="Bound">r</a> <a id="1379" href="Language.html#7248" class="InductiveConstructor Operator">&gt;[_`$_]</a> <a id="1387" href="Category.Functor.html#492" class="Function Operator">&lt;$&gt;</a> <a id="1391" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1403" href="Scopecheck.html#1363" class="Bound">f</a> <a id="1405" href="Category.Applicative.Indexed.html#780" class="Function Operator">⊛</a> <a id="1407" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1419" href="Scopecheck.html#1368" class="Bound">t</a>
  <a id="1423" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1435" class="Symbol">(</a><a id="1436" href="Scopecheck.html#1436" class="Bound">r</a> <a id="1438" href="Language.html#7353" class="InductiveConstructor Operator">&gt;`fst</a> <a id="1444" href="Scopecheck.html#1444" class="Bound">b</a><a id="1445" class="Symbol">)</a>       <a id="1453" class="Symbol">=</a> <a id="1455" href="Scopecheck.html#1436" class="Bound">r</a> <a id="1457" href="Language.html#7353" class="InductiveConstructor Operator">&gt;`fst_</a>  <a id="1465" href="Category.Functor.html#492" class="Function Operator">&lt;$&gt;</a> <a id="1469" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1481" href="Scopecheck.html#1444" class="Bound">b</a>
  <a id="1485" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1497" class="Symbol">(</a><a id="1498" href="Scopecheck.html#1498" class="Bound">r</a> <a id="1500" href="Language.html#7454" class="InductiveConstructor Operator">&gt;`snd</a> <a id="1506" href="Scopecheck.html#1506" class="Bound">b</a><a id="1507" class="Symbol">)</a>       <a id="1515" class="Symbol">=</a> <a id="1517" href="Scopecheck.html#1498" class="Bound">r</a> <a id="1519" href="Language.html#7454" class="InductiveConstructor Operator">&gt;`snd_</a>  <a id="1527" href="Category.Functor.html#492" class="Function Operator">&lt;$&gt;</a> <a id="1531" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1543" href="Scopecheck.html#1506" class="Bound">b</a>
  <a id="1547" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1559" class="Symbol">(</a><a id="1560" href="Scopecheck.html#1560" class="Bound">r</a> <a id="1562" href="Language.html#7555" class="InductiveConstructor Operator">&gt;`λ</a> <a id="1566" href="Scopecheck.html#1566" class="Bound">b</a><a id="1567" class="Symbol">)</a>         <a id="1577" class="Symbol">=</a> <a id="1579" href="Scopecheck.html#1560" class="Bound">r</a> <a id="1581" href="Language.html#7555" class="InductiveConstructor Operator">&gt;`λ_</a>  <a id="1587" href="Category.Functor.html#492" class="Function Operator">&lt;$&gt;</a> <a id="1591" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1603" href="Scopecheck.html#1566" class="Bound">b</a>
  <a id="1607" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1619" class="Symbol">(</a><a id="1620" href="Scopecheck.html#1620" class="Bound">r</a> <a id="1622" href="Language.html#7658" class="InductiveConstructor Operator">&gt;[</a> <a id="1625" href="Scopecheck.html#1625" class="Bound">a</a> <a id="1627" href="Language.html#7658" class="InductiveConstructor Operator">`,</a> <a id="1630" href="Scopecheck.html#1630" class="Bound">b</a> <a id="1632" href="Language.html#7658" class="InductiveConstructor Operator">]</a><a id="1633" class="Symbol">)</a>   <a id="1637" class="Symbol">=</a> <a id="1639" href="Scopecheck.html#1620" class="Bound">r</a> <a id="1641" href="Language.html#7658" class="InductiveConstructor Operator">&gt;[_`,_]</a> <a id="1649" href="Category.Functor.html#492" class="Function Operator">&lt;$&gt;</a> <a id="1653" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1665" href="Scopecheck.html#1625" class="Bound">a</a> <a id="1667" href="Category.Applicative.Indexed.html#780" class="Function Operator">⊛</a> <a id="1669" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1681" href="Scopecheck.html#1630" class="Bound">b</a>
  <a id="1685" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1697" class="Symbol">(</a><a id="1698" href="Scopecheck.html#1698" class="Bound">r</a> <a id="1700" href="Language.html#7768" class="InductiveConstructor Operator">&gt;`let</a> <a id="1706" href="Scopecheck.html#1706" class="Bound">e</a> <a id="1708" href="Language.html#7768" class="InductiveConstructor Operator">`in</a> <a id="1712" href="Scopecheck.html#1712" class="Bound">b</a><a id="1713" class="Symbol">)</a> <a id="1715" class="Symbol">=</a> <a id="1717" href="Scopecheck.html#1698" class="Bound">r</a> <a id="1719" href="Language.html#7768" class="InductiveConstructor Operator">&gt;`let_`in_</a> <a id="1730" href="Category.Functor.html#492" class="Function Operator">&lt;$&gt;</a> <a id="1734" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1746" href="Scopecheck.html#1706" class="Bound">e</a> <a id="1748" href="Category.Applicative.Indexed.html#780" class="Function Operator">⊛</a> <a id="1750" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1762" href="Scopecheck.html#1712" class="Bound">b</a>
  <a id="1766" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1778" class="Symbol">(</a><a id="1779" href="Scopecheck.html#1779" class="Bound">r</a> <a id="1781" href="Language.html#7875" class="InductiveConstructor Operator">&gt;`-</a> <a id="1785" href="Scopecheck.html#1785" class="Bound">t</a><a id="1786" class="Symbol">)</a>         <a id="1796" class="Symbol">=</a> <a id="1798" href="Scopecheck.html#1779" class="Bound">r</a> <a id="1800" href="Language.html#7875" class="InductiveConstructor Operator">&gt;`-_</a>  <a id="1806" href="Category.Functor.html#492" class="Function Operator">&lt;$&gt;</a> <a id="1810" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="1822" href="Scopecheck.html#1785" class="Bound">t</a>

<a id="1825" class="Keyword">open</a> <a id="1830" href="Category.Monad.html#774" class="Module">RawMonad</a> <a id="1839" class="Symbol">(</a><a id="1840" href="Types.html#2469" class="Function">Compiler.monad</a> <a id="1855" href="Agda.Builtin.String.html#165" class="Postulate">String</a><a id="1861" class="Symbol">)</a>
<a id="1863" class="Keyword">open</a> <a id="1868" href="Types.html#2451" class="Module">Compiler</a>
<a id="1877" class="Keyword">open</a> <a id="1882" href="Generic.AltSyntax.html#1893" class="Module">ScopeCheck</a>

<a id="scopecheck"></a><a id="1894" href="Scopecheck.html#1894" class="Function">scopecheck</a> <a id="1905" class="Symbol">:</a> <a id="1907" class="Symbol">∀</a> <a id="1909" class="Symbol">{</a><a id="1910" href="Scopecheck.html#1910" class="Bound">Σ</a> <a id="1912" href="Scopecheck.html#1912" class="Bound">m</a><a id="1913" class="Symbol">}</a> <a id="1915" class="Symbol">(</a><a id="1916" href="Scopecheck.html#1916" class="Bound">p</a> <a id="1918" class="Symbol">:</a> <a id="1920" href="Language.html#8835" class="Datatype">Definitions</a> <a id="1932" href="Scopecheck.html#1910" class="Bound">Σ</a><a id="1933" class="Symbol">)</a> <a id="1935" class="Symbol">→</a> <a id="1937" href="Language.html#3579" class="Function">Parsed</a> <a id="1944" href="Scopecheck.html#1912" class="Bound">m</a> <a id="1946" class="Symbol">→</a>
             <a id="1961" href="Types.html#2371" class="Function">Compiler</a> <a id="1970" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1977" class="Symbol">(</a><a id="1978" href="Language.html#3645" class="Function">Scoped</a> <a id="1985" href="Scopecheck.html#1912" class="Bound">m</a> <a id="1987" class="Symbol">(</a><a id="1988" href="Language.html#9325" class="Function">modes</a> <a id="1994" href="Scopecheck.html#1916" class="Bound">p</a><a id="1995" class="Symbol">))</a>
<a id="1998" href="Scopecheck.html#1894" class="Function">scopecheck</a> <a id="2009" href="Scopecheck.html#2009" class="Bound">p</a> <a id="2011" href="Scopecheck.html#2011" class="Bound">r</a> <a id="2013" class="Symbol">=</a> <a id="2015" class="Keyword">do</a>
  <a id="2020" class="Keyword">let</a> <a id="2024" href="Scopecheck.html#2024" class="Bound">scopeError</a> <a id="2035" class="Symbol">=</a> <a id="2037" href="Data.Product.html#3464" class="Function">uncurry</a> <a id="2045" href="Types.html#797" class="InductiveConstructor Operator">At_OutOfScope_</a>
  <a id="2062" href="Scopecheck.html#2062" class="Bound">t</a>  <a id="2065" href="Category.Monad.Indexed.html#568" class="Function Operator">←</a> <a id="2067" href="Types.html#2564" class="Function">liftResult</a> <a id="2078" href="Function.html#1891" class="Function Operator">$</a> <a id="2080" href="Data.Sum.Base.html#1288" class="Function">Sum.map₁</a> <a id="2089" href="Scopecheck.html#2024" class="Bound">scopeError</a> <a id="2100" href="Function.html#1891" class="Function Operator">$</a> <a id="2102" href="Generic.AltSyntax.html#2391" class="Function">scopeCheck</a> <a id="2113" href="Language.html#1267" class="Function">eqdecMode</a> <a id="2123" class="Symbol">_</a> <a id="2125" class="Symbol">_</a> <a id="2127" class="Symbol">(</a><a id="2128" href="Language.html#9407" class="Function">names</a> <a id="2134" href="Scopecheck.html#2009" class="Bound">p</a><a id="2135" class="Symbol">)</a> <a id="2137" href="Scopecheck.html#2011" class="Bound">r</a>
  <a id="2141" href="Types.html#2636" class="Function">liftState</a> <a id="2151" href="Function.html#1891" class="Function Operator">$</a> <a id="2153" href="Scopecheck.html#1146" class="Function">cleanupTerm</a> <a id="2165" href="Scopecheck.html#2062" class="Bound">t</a>
</pre></body></html>