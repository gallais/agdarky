<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Scopecheck</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="Scopecheck.html" class="Module">Scopecheck</a> <a id="19" class="Keyword">where</a>

<a id="26" class="Keyword">open</a> <a id="31" class="Keyword">import</a> <a id="38" href="Data.Product.html" class="Module">Data.Product</a> <a id="51" class="Symbol">as</a> <a id="54" class="Module">Product</a>
<a id="62" class="Keyword">open</a> <a id="67" class="Keyword">import</a> <a id="74" href="Data.Nat.html" class="Module">Data.Nat</a>
<a id="83" class="Keyword">open</a> <a id="88" class="Keyword">import</a> <a id="95" href="Data.String.html" class="Module">Data.String</a>
<a id="107" class="Keyword">open</a> <a id="112" class="Keyword">import</a> <a id="119" href="Data.String.Unsafe.html" class="Module">Data.String.Unsafe</a> <a id="138" class="Symbol">as</a> <a id="141" class="Module">String</a>
<a id="148" class="Keyword">open</a> <a id="153" class="Keyword">import</a> <a id="160" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="176" class="Keyword">using</a> <a id="182" class="Symbol">(</a><a id="183" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a><a id="188" class="Symbol">;</a> <a id="190" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a><a id="197" class="Symbol">;</a> <a id="199" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a><a id="203" class="Symbol">;</a> <a id="205" href="Data.Maybe.Base.html#1618" class="Function">maybe′</a><a id="211" class="Symbol">)</a>
<a id="213" class="Keyword">open</a> <a id="218" class="Keyword">import</a> <a id="225" href="Data.Sum.Base.html" class="Module">Data.Sum.Base</a> <a id="239" class="Symbol">as</a> <a id="242" class="Module">Sum</a> <a id="246" class="Keyword">using</a> <a id="252" class="Symbol">(</a><a id="253" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a><a id="257" class="Symbol">;</a> <a id="259" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a><a id="263" class="Symbol">;</a> <a id="265" href="Data.Sum.Base.html#1017" class="Function Operator">[_,_]′</a><a id="271" class="Symbol">)</a>
<a id="273" class="Keyword">open</a> <a id="278" class="Keyword">import</a> <a id="285" href="Data.List.html" class="Module">Data.List</a> <a id="295" class="Keyword">using</a> <a id="301" class="Symbol">(</a><a id="302" href="Data.List.Base.html#9863" class="InductiveConstructor">[]</a><a id="304" class="Symbol">)</a>
<a id="306" class="Keyword">open</a> <a id="311" class="Keyword">import</a> <a id="318" href="Data.List.Relation.Unary.All.html" class="Module">Data.List.Relation.Unary.All</a> <a id="347" class="Keyword">using</a> <a id="353" class="Symbol">(</a><a id="354" href="Data.List.Relation.Unary.All.html#1021" class="InductiveConstructor">[]</a><a id="356" class="Symbol">)</a>
<a id="358" class="Keyword">open</a> <a id="363" class="Keyword">import</a> <a id="370" href="Function.html" class="Module">Function</a>

<a id="380" class="Keyword">open</a> <a id="385" class="Keyword">import</a> <a id="392" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="407" class="Keyword">open</a> <a id="412" class="Keyword">import</a> <a id="419" href="Category.Monad.State.html" class="Module">Category.Monad.State</a>

<a id="441" class="Keyword">open</a> <a id="446" class="Keyword">import</a> <a id="453" href="Generic.Syntax.html" class="Module">Generic.Syntax</a>
<a id="468" class="Keyword">open</a> <a id="473" class="Keyword">import</a> <a id="480" href="Generic.AltSyntax.html" class="Module">Generic.AltSyntax</a>

<a id="499" class="Keyword">open</a> <a id="504" class="Keyword">import</a> <a id="511" href="Text.Parser.Position.html" class="Module">Text.Parser.Position</a>

<a id="533" class="Keyword">open</a> <a id="538" class="Keyword">import</a> <a id="545" href="Language.html" class="Module">Language</a>
<a id="554" class="Keyword">open</a> <a id="559" href="Language.html#1911" class="Module">Surface</a>
<a id="567" class="Keyword">open</a> <a id="572" class="Keyword">import</a> <a id="579" href="Types.html" class="Module">Types</a>

<a id="586" class="Comment">-- Data.AVL is not quite usable with String at the moment IIRC</a>
<a id="649" class="Comment">-- So instead I&#39;m using a quick and dirty representation</a>
<a id="706" class="Keyword">import</a> <a id="713" href="Data.Map.html" class="Module">Data.Map</a> <a id="722" class="Symbol">as</a> <a id="725" class="Module">M</a>

<a id="728" class="Keyword">module</a> <a id="Map"></a><a id="735" href="Scopecheck.html#735" class="Module">Map</a> <a id="739" class="Symbol">=</a> <a id="741" href="Data.Map.html#300" class="Module">M.Map</a> <a id="747" href="Data.String.Unsafe.html#775" class="Function Operator">String._≟_</a> <a id="758" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a>
<a id="760" class="Keyword">open</a> <a id="765" href="Scopecheck.html#735" class="Module">Map</a> <a id="769" class="Keyword">using</a> <a id="775" class="Symbol">(</a><a id="776" href="Data.Map.html#364" class="Function">Map</a><a id="779" class="Symbol">;</a> <a id="781" href="Data.Map.html#398" class="Function">RMap</a><a id="785" class="Symbol">)</a>

<a id="788" class="Keyword">module</a> <a id="795" href="Scopecheck.html#795" class="Module">_</a> <a id="797" class="Keyword">where</a>

  <a id="806" class="Keyword">private</a> <a id="814" href="Scopecheck.html#814" class="Function">M</a> <a id="816" class="Symbol">=</a> <a id="818" href="Category.Monad.State.html#3310" class="Function">State</a> <a id="824" class="Symbol">(</a><a id="825" href="Data.Map.html#364" class="Function">Map</a> <a id="829" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="831" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="832" class="Symbol">)</a>
  <a id="836" class="Keyword">open</a> <a id="841" href="Category.Monad.State.html#2501" class="Module">RawMonadState</a> <a id="855" class="Symbol">(</a><a id="856" href="Category.Monad.State.html#3468" class="Function">StateMonadState</a> <a id="872" class="Symbol">(</a><a id="873" href="Data.Map.html#364" class="Function">Map</a> <a id="877" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="879" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="880" class="Symbol">))</a>

  <a id="886" href="Scopecheck.html#886" class="Function">resolve</a> <a id="894" class="Symbol">:</a> <a id="896" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="903" class="Symbol">→</a> <a id="905" href="Scopecheck.html#814" class="Function">M</a> <a id="907" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a>
  <a id="911" href="Scopecheck.html#886" class="Function">resolve</a> <a id="919" href="Scopecheck.html#919" class="Bound">str</a> <a id="923" class="Symbol">=</a> <a id="925" class="Keyword">do</a>
    <a id="932" class="Symbol">(</a><a id="933" href="Scopecheck.html#933" class="Bound">mp</a> <a id="936" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="938" href="Scopecheck.html#938" class="Bound">gen</a><a id="941" class="Symbol">)</a> <a id="943" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="945" href="Category.Monad.State.html#1794" class="Function">get</a>
    <a id="953" href="Function.html#3533" class="Function Operator">case</a> <a id="958" href="Data.Map.html#517" class="Function">Map.assoc</a> <a id="968" href="Scopecheck.html#919" class="Bound">str</a> <a id="972" href="Scopecheck.html#933" class="Bound">mp</a> <a id="975" href="Function.html#3533" class="Function Operator">of</a> <a id="978" class="Symbol">λ</a> <a id="980" class="Keyword">where</a>
      <a id="992" class="Symbol">(</a><a id="993" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="998" href="Scopecheck.html#998" class="Bound">n</a><a id="999" class="Symbol">)</a> <a id="1001" class="Symbol">→</a> <a id="1003" href="Category.Monad.Indexed.html#569" class="Function">return</a> <a id="1010" href="Scopecheck.html#998" class="Bound">n</a>
      <a id="1018" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a>  <a id="1027" class="Symbol">→</a> <a id="1029" class="Keyword">do</a>
        <a id="1040" href="Category.Monad.State.html#1826" class="Function">put</a> <a id="1044" class="Symbol">(</a><a id="1045" href="Data.Map.html#462" class="Function">Map.set</a> <a id="1053" href="Scopecheck.html#919" class="Bound">str</a> <a id="1057" href="Scopecheck.html#938" class="Bound">gen</a> <a id="1061" href="Scopecheck.html#933" class="Bound">mp</a> <a id="1064" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1066" href="Agda.Builtin.Nat.html#128" class="InductiveConstructor">suc</a> <a id="1070" href="Scopecheck.html#938" class="Bound">gen</a><a id="1073" class="Symbol">)</a>
        <a id="1083" href="Category.Monad.Indexed.html#569" class="Function">return</a> <a id="1090" href="Scopecheck.html#938" class="Bound">gen</a>

  <a id="1097" href="Scopecheck.html#1097" class="Function">cleanupType</a> <a id="1109" class="Symbol">:</a> <a id="1111" href="Language.html#672" class="Datatype">Type</a> <a id="1116" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1123" class="Symbol">→</a> <a id="1125" href="Scopecheck.html#814" class="Function">M</a> <a id="1127" class="Symbol">(</a><a id="1128" href="Language.html#672" class="Datatype">Type</a> <a id="1133" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="1134" class="Symbol">)</a>
  <a id="1138" href="Scopecheck.html#1097" class="Function">cleanupType</a> <a id="1150" class="Symbol">(</a><a id="1151" href="Language.html#701" class="InductiveConstructor">α</a> <a id="1153" href="Scopecheck.html#1153" class="Bound">str</a><a id="1156" class="Symbol">)</a> <a id="1158" class="Symbol">=</a> <a id="1160" href="Language.html#701" class="InductiveConstructor">α</a> <a id="1162" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="1166" href="Scopecheck.html#886" class="Function">resolve</a> <a id="1174" href="Scopecheck.html#1153" class="Bound">str</a>
  <a id="1180" href="Scopecheck.html#1097" class="Function">cleanupType</a> <a id="1192" class="Symbol">(</a><a id="1193" href="Scopecheck.html#1193" class="Bound">σ</a> <a id="1195" href="Language.html#720" class="InductiveConstructor Operator">⇒</a> <a id="1197" href="Scopecheck.html#1197" class="Bound">τ</a><a id="1198" class="Symbol">)</a> <a id="1200" class="Symbol">=</a> <a id="1202" href="Language.html#720" class="InductiveConstructor Operator">_⇒_</a> <a id="1206" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="1210" href="Scopecheck.html#1097" class="Function">cleanupType</a> <a id="1222" href="Scopecheck.html#1193" class="Bound">σ</a> <a id="1224" href="Category.Applicative.Indexed.html#816" class="Function Operator">⊛</a> <a id="1226" href="Scopecheck.html#1097" class="Function">cleanupType</a> <a id="1238" href="Scopecheck.html#1197" class="Bound">τ</a>

  <a id="1243" href="Scopecheck.html#1243" class="Function">cleanupTerm</a> <a id="1255" class="Symbol">:</a> <a id="1257" class="Symbol">∀</a> <a id="1259" class="Symbol">{</a><a id="1260" href="Scopecheck.html#1260" class="Bound">i</a> <a id="1262" href="Scopecheck.html#1262" class="Bound">σ</a> <a id="1264" href="Scopecheck.html#1264" class="Bound">Γ</a><a id="1265" class="Symbol">}</a> <a id="1267" class="Symbol">→</a> <a id="1269" href="Generic.Syntax.html#1063" class="Datatype">Tm</a> <a id="1272" class="Symbol">(</a><a id="1273" href="Language.html#2089" class="Function">surface</a> <a id="1281" href="Agda.Builtin.String.html#165" class="Postulate">String</a><a id="1287" class="Symbol">)</a> <a id="1289" href="Scopecheck.html#1260" class="Bound">i</a> <a id="1291" href="Scopecheck.html#1262" class="Bound">σ</a> <a id="1293" href="Scopecheck.html#1264" class="Bound">Γ</a> <a id="1295" class="Symbol">→</a> <a id="1297" href="Scopecheck.html#814" class="Function">M</a> <a id="1299" class="Symbol">(</a><a id="1300" href="Language.html#2500" class="Function">Scoped</a> <a id="1307" href="Scopecheck.html#1262" class="Bound">σ</a> <a id="1309" href="Scopecheck.html#1264" class="Bound">Γ</a><a id="1310" class="Symbol">)</a>
  <a id="1314" href="Scopecheck.html#1243" class="Function">cleanupTerm</a> <a id="1326" class="Symbol">(</a><a id="1327" href="Generic.Syntax.html#1116" class="InductiveConstructor">`var</a> <a id="1332" href="Scopecheck.html#1332" class="Bound">k</a><a id="1333" class="Symbol">)</a>          <a id="1344" class="Symbol">=</a> <a id="1346" href="Category.Monad.Indexed.html#569" class="Function">return</a> <a id="1353" href="Function.html#1927" class="Function Operator">$</a> <a id="1355" href="Generic.Syntax.html#1116" class="InductiveConstructor">`var</a> <a id="1360" href="Scopecheck.html#1332" class="Bound">k</a>
  <a id="1364" href="Scopecheck.html#1243" class="Function">cleanupTerm</a> <a id="1376" class="Symbol">(</a><a id="1377" href="Scopecheck.html#1377" class="Bound">r</a> <a id="1379" href="Language.html#4878" class="InductiveConstructor Operator">&gt;</a> <a id="1381" href="Scopecheck.html#1381" class="Bound">t</a> <a id="1383" href="Language.html#4878" class="InductiveConstructor Operator">`∶</a> <a id="1386" href="Scopecheck.html#1386" class="Bound">σ</a><a id="1387" class="Symbol">)</a>      <a id="1394" class="Symbol">=</a> <a id="1396" href="Scopecheck.html#1377" class="Bound">r</a> <a id="1398" href="Language.html#4878" class="InductiveConstructor Operator">&gt;_`∶_</a> <a id="1404" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="1408" href="Scopecheck.html#1243" class="Function">cleanupTerm</a> <a id="1420" href="Scopecheck.html#1381" class="Bound">t</a> <a id="1422" href="Category.Applicative.Indexed.html#816" class="Function Operator">⊛</a> <a id="1424" href="Scopecheck.html#1097" class="Function">cleanupType</a> <a id="1436" href="Scopecheck.html#1386" class="Bound">σ</a>
  <a id="1440" href="Scopecheck.html#1243" class="Function">cleanupTerm</a> <a id="1452" class="Symbol">(</a><a id="1453" href="Scopecheck.html#1453" class="Bound">r</a> <a id="1455" href="Language.html#4984" class="InductiveConstructor Operator">&gt;</a> <a id="1457" href="Scopecheck.html#1457" class="Bound">f</a> <a id="1459" href="Language.html#4984" class="InductiveConstructor Operator">`$</a> <a id="1462" href="Scopecheck.html#1462" class="Bound">t</a><a id="1463" class="Symbol">)</a>      <a id="1470" class="Symbol">=</a> <a id="1472" href="Scopecheck.html#1453" class="Bound">r</a> <a id="1474" href="Language.html#4984" class="InductiveConstructor Operator">&gt;_`$_</a> <a id="1480" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="1484" href="Scopecheck.html#1243" class="Function">cleanupTerm</a> <a id="1496" href="Scopecheck.html#1457" class="Bound">f</a> <a id="1498" href="Category.Applicative.Indexed.html#816" class="Function Operator">⊛</a> <a id="1500" href="Scopecheck.html#1243" class="Function">cleanupTerm</a> <a id="1512" href="Scopecheck.html#1462" class="Bound">t</a>
  <a id="1516" href="Scopecheck.html#1243" class="Function">cleanupTerm</a> <a id="1528" class="Symbol">(</a><a id="1529" href="Scopecheck.html#1529" class="Bound">r</a> <a id="1531" href="Language.html#5086" class="InductiveConstructor Operator">&gt;`λ</a> <a id="1535" href="Scopecheck.html#1535" class="Bound">b</a><a id="1536" class="Symbol">)</a>         <a id="1546" class="Symbol">=</a> <a id="1548" href="Scopecheck.html#1529" class="Bound">r</a> <a id="1550" href="Language.html#5086" class="InductiveConstructor Operator">&gt;`λ_</a>  <a id="1556" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="1560" href="Scopecheck.html#1243" class="Function">cleanupTerm</a> <a id="1572" href="Scopecheck.html#1535" class="Bound">b</a>
  <a id="1576" href="Scopecheck.html#1243" class="Function">cleanupTerm</a> <a id="1588" class="Symbol">(</a><a id="1589" href="Scopecheck.html#1589" class="Bound">r</a> <a id="1591" href="Language.html#5189" class="InductiveConstructor Operator">&gt;`let</a> <a id="1597" href="Scopecheck.html#1597" class="Bound">e</a> <a id="1599" href="Language.html#5189" class="InductiveConstructor Operator">`in</a> <a id="1603" href="Scopecheck.html#1603" class="Bound">b</a><a id="1604" class="Symbol">)</a> <a id="1606" class="Symbol">=</a> <a id="1608" href="Scopecheck.html#1589" class="Bound">r</a> <a id="1610" href="Language.html#5189" class="InductiveConstructor Operator">&gt;`let_`in_</a> <a id="1621" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="1625" href="Scopecheck.html#1243" class="Function">cleanupTerm</a> <a id="1637" href="Scopecheck.html#1597" class="Bound">e</a> <a id="1639" href="Category.Applicative.Indexed.html#816" class="Function Operator">⊛</a> <a id="1641" href="Scopecheck.html#1243" class="Function">cleanupTerm</a> <a id="1653" href="Scopecheck.html#1603" class="Bound">b</a>
  <a id="1657" href="Scopecheck.html#1243" class="Function">cleanupTerm</a> <a id="1669" class="Symbol">(</a><a id="1670" href="Scopecheck.html#1670" class="Bound">r</a> <a id="1672" href="Language.html#5296" class="InductiveConstructor Operator">&gt;`-</a> <a id="1676" href="Scopecheck.html#1676" class="Bound">t</a><a id="1677" class="Symbol">)</a>         <a id="1687" class="Symbol">=</a> <a id="1689" href="Scopecheck.html#1670" class="Bound">r</a> <a id="1691" href="Language.html#5296" class="InductiveConstructor Operator">&gt;`-_</a>  <a id="1697" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="1701" href="Scopecheck.html#1243" class="Function">cleanupTerm</a> <a id="1713" href="Scopecheck.html#1676" class="Bound">t</a>

<a id="1716" class="Keyword">open</a> <a id="1721" href="Category.Monad.html#810" class="Module">RawMonad</a> <a id="1730" href="Data.Sum.Categorical.Left.html#1296" class="Function">Result.monad</a>

<a id="scopecheck"></a><a id="1744" href="Scopecheck.html#1744" class="Function">scopecheck</a> <a id="1755" class="Symbol">:</a> <a id="1757" class="Symbol">∀</a> <a id="1759" class="Symbol">{</a><a id="1760" href="Scopecheck.html#1760" class="Bound">m</a><a id="1761" class="Symbol">}</a> <a id="1763" class="Symbol">→</a> <a id="1765" href="Language.html#2443" class="Function">Parsed</a> <a id="1772" href="Scopecheck.html#1760" class="Bound">m</a> <a id="1774" class="Symbol">→</a> <a id="1776" href="Types.html#574" class="Function">Result</a> <a id="1783" class="Symbol">(</a><a id="1784" href="Language.html#2500" class="Function">Scoped</a> <a id="1791" href="Scopecheck.html#1760" class="Bound">m</a> <a id="1793" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="1796" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="1798" href="Data.Map.html#398" class="Function">RMap</a><a id="1802" class="Symbol">)</a>
<a id="1804" href="Scopecheck.html#1744" class="Function">scopecheck</a> <a id="1815" href="Scopecheck.html#1815" class="Bound">r</a> <a id="1817" class="Symbol">=</a> <a id="1819" class="Keyword">do</a>
  <a id="1824" href="Scopecheck.html#1824" class="Bound">t</a> <a id="1826" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="1828" href="Data.Sum.Base.html#1233" class="Function">Sum.map</a> <a id="1836" href="Scopecheck.html#1988" class="Function">error</a> <a id="1842" href="Function.html#1104" class="Function">id</a> <a id="1845" href="Function.html#1927" class="Function Operator">$</a> <a id="1847" href="Generic.AltSyntax.html#2430" class="Function">ScopeCheck.scopeCheck</a> <a id="1869" href="Language.html#795" class="Function">eqdecMode</a> <a id="1879" href="Scopecheck.html#2112" class="Function">pos?</a> <a id="1884" class="Symbol">_</a> <a id="1886" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="1889" href="Data.List.Relation.Unary.All.html#1021" class="InductiveConstructor">[]</a> <a id="1892" href="Scopecheck.html#1815" class="Bound">r</a>
  <a id="1896" class="Keyword">let</a> <a id="1900" class="Symbol">(</a><a id="1901" href="Scopecheck.html#1901" class="Bound">t′</a> <a id="1904" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1906" href="Scopecheck.html#1906" class="Bound">mp</a> <a id="1909" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1911" class="Symbol">_)</a> <a id="1914" class="Symbol">=</a> <a id="1916" href="Scopecheck.html#1243" class="Function">cleanupTerm</a> <a id="1928" href="Scopecheck.html#1824" class="Bound">t</a> <a id="1930" class="Symbol">(</a><a id="1931" href="Data.Map.html#434" class="Function">Map.empty</a> <a id="1941" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1943" class="Number">0</a><a id="1944" class="Symbol">)</a>
  <a id="1948" href="Category.Applicative.Indexed.html#783" class="Function">pure</a> <a id="1953" href="Function.html#1927" class="Function Operator">$</a> <a id="1955" href="Scopecheck.html#1901" class="Bound">t′</a> <a id="1958" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1960" href="Data.Map.html#641" class="Function">Map.invert</a> <a id="1971" href="Scopecheck.html#1906" class="Bound">mp</a>

  <a id="1977" class="Keyword">where</a>

    <a id="1988" href="Scopecheck.html#1988" class="Function">error</a> <a id="1994" class="Symbol">:</a> <a id="1996" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="2003" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="2005" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="2011" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="2020" class="Symbol">→</a> <a id="2022" href="Types.html#367" class="Datatype">Error</a>
    <a id="2032" href="Scopecheck.html#1988" class="Function">error</a> <a id="2038" class="Symbol">(</a><a id="2039" href="Scopecheck.html#2039" class="Bound">str</a> <a id="2043" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2045" href="Scopecheck.html#2045" class="Bound">mp</a><a id="2047" class="Symbol">)</a> <a id="2049" class="Symbol">=</a> <a id="2051" href="Data.Maybe.Base.html#1618" class="Function">maybe′</a> <a id="2058" class="Symbol">(</a><a id="2059" href="Types.html#425" class="InductiveConstructor Operator">At_OutOfScope</a> <a id="2073" href="Scopecheck.html#2039" class="Bound">str</a><a id="2076" class="Symbol">)</a> <a id="2078" class="Symbol">(</a><a id="2079" href="Types.html#425" class="InductiveConstructor Operator">At</a> <a id="2082" href="Text.Parser.Position.html#409" class="Function">start</a> <a id="2088" href="Types.html#425" class="InductiveConstructor Operator">OutOfScope</a> <a id="2099" href="Scopecheck.html#2039" class="Bound">str</a><a id="2102" class="Symbol">)</a> <a id="2104" href="Scopecheck.html#2045" class="Bound">mp</a>

    <a id="2112" href="Scopecheck.html#2112" class="Function">pos?</a> <a id="2117" class="Symbol">:</a> <a id="2119" class="Symbol">∀</a> <a id="2121" href="Scopecheck.html#2121" class="Bound">σ</a> <a id="2123" class="Symbol">→</a> <a id="2125" href="Generic.AltSyntax.html#1696" class="Datatype">Raw</a> <a id="2129" class="Symbol">(</a><a id="2130" href="Language.html#2089" class="Function">surface</a> <a id="2138" href="Agda.Builtin.String.html#165" class="Postulate">String</a><a id="2144" class="Symbol">)</a> <a id="2146" class="Symbol">_</a> <a id="2148" href="Scopecheck.html#2121" class="Bound">σ</a> <a id="2150" class="Symbol">→</a> <a id="2152" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="2158" href="Text.Parser.Position.html#310" class="Record">Position</a>
    <a id="2171" href="Scopecheck.html#2112" class="Function">pos?</a> <a id="2176" class="Symbol">_</a> <a id="2178" class="Symbol">(</a><a id="2179" href="Generic.AltSyntax.html#1748" class="InductiveConstructor">`var</a> <a id="2184" class="Symbol">_)</a>       <a id="2193" class="Symbol">=</a> <a id="2195" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a>
    <a id="2207" href="Scopecheck.html#2112" class="Function">pos?</a> <a id="2212" class="Symbol">_</a> <a id="2214" class="Symbol">(</a><a id="2215" href="Generic.AltSyntax.html#1790" class="InductiveConstructor">`con</a> <a id="2220" class="Symbol">(</a><a id="2221" href="Scopecheck.html#2221" class="Bound">r</a> <a id="2223" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2225" class="Symbol">_))</a> <a id="2229" class="Symbol">=</a> <a id="2231" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="2236" href="Scopecheck.html#2221" class="Bound">r</a>
</pre></body></html>