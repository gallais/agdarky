<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Parse</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="Parse.html" class="Module">Parse</a> <a id="14" class="Keyword">where</a>

<a id="21" class="Keyword">open</a> <a id="26" class="Keyword">import</a> <a id="33" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="53" class="Keyword">using</a> <a id="59" class="Symbol">(</a><a id="60" href="Data.Nat.Properties.html#2969" class="Function">≤-refl</a><a id="66" class="Symbol">)</a>
<a id="68" class="Keyword">open</a> <a id="73" class="Keyword">import</a> <a id="80" href="Data.Empty.html" class="Module">Data.Empty</a>
<a id="91" class="Keyword">open</a> <a id="96" class="Keyword">import</a> <a id="103" href="Data.Product.html" class="Module">Data.Product</a>

<a id="117" class="Keyword">open</a> <a id="122" class="Keyword">import</a> <a id="129" href="Data.Maybe.html" class="Module">Data.Maybe</a>
<a id="140" class="Keyword">open</a> <a id="145" class="Keyword">import</a> <a id="152" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="162" class="Keyword">using</a> <a id="168" class="Symbol">(</a><a id="169" href="Data.Bool.Base.html#835" class="Function Operator">if_then_else_</a><a id="182" class="Symbol">)</a>
<a id="184" class="Keyword">open</a> <a id="189" class="Keyword">import</a> <a id="196" href="Data.Char.html" class="Module">Data.Char</a> <a id="206" class="Symbol">as</a> <a id="209" class="Module">Char</a>
<a id="214" class="Keyword">open</a> <a id="219" class="Keyword">import</a> <a id="226" href="Data.String.html" class="Module">Data.String</a> <a id="238" class="Symbol">as</a> <a id="241" class="Module">String</a>
<a id="248" class="Keyword">import</a> <a id="255" href="Data.String.Unsafe.html" class="Module">Data.String.Unsafe</a> <a id="274" class="Symbol">as</a> <a id="277" class="Module">String</a>
<a id="284" class="Keyword">open</a> <a id="289" class="Keyword">import</a> <a id="296" href="Data.Sum.Base.html" class="Module">Data.Sum.Base</a> <a id="310" class="Keyword">using</a> <a id="316" class="Symbol">(</a><a id="317" href="Data.Sum.Base.html#509" class="Datatype Operator">_⊎_</a><a id="320" class="Symbol">;</a> <a id="322" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a><a id="326" class="Symbol">;</a> <a id="328" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a><a id="332" class="Symbol">;</a> <a id="334" href="Data.Sum.Base.html#1017" class="Function Operator">[_,_]′</a><a id="340" class="Symbol">)</a>
<a id="342" class="Keyword">open</a> <a id="347" class="Keyword">import</a> <a id="354" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="369" class="Symbol">as</a> <a id="372" class="Module">List</a> <a id="377" class="Keyword">using</a> <a id="383" class="Symbol">(</a><a id="384" href="Agda.Builtin.List.html#80" class="Datatype">List</a><a id="388" class="Symbol">;</a> <a id="390" href="Data.List.Base.html#9863" class="InductiveConstructor">[]</a><a id="392" class="Symbol">;</a> <a id="394" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">_∷_</a><a id="397" class="Symbol">)</a>
<a id="399" class="Keyword">open</a> <a id="404" class="Keyword">import</a> <a id="411" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="420" class="Symbol">as</a> <a id="423" class="Module">Vec</a> <a id="427" class="Keyword">using</a> <a id="433" class="Symbol">(</a><a id="434" href="Data.Vec.html#773" class="Datatype">Vec</a><a id="437" class="Symbol">)</a>
<a id="439" class="Keyword">open</a> <a id="444" class="Keyword">import</a> <a id="451" href="Function.html" class="Module">Function</a>

<a id="461" class="Keyword">open</a> <a id="466" class="Keyword">import</a> <a id="473" href="Category.Monad.html" class="Module">Category.Monad</a>

<a id="489" class="Keyword">open</a> <a id="494" class="Keyword">import</a> <a id="501" href="Induction.Nat.Strong.html" class="Module">Induction.Nat.Strong</a> <a id="522" class="Symbol">as</a> <a id="525" class="Module">INS</a>

<a id="530" class="Keyword">open</a> <a id="535" class="Keyword">import</a> <a id="542" href="Data.Subset.html" class="Module">Data.Subset</a>
<a id="554" class="Keyword">open</a> <a id="559" class="Keyword">import</a> <a id="566" href="Data.List.Sized.Interface.html" class="Module">Data.List.Sized.Interface</a>
<a id="592" class="Keyword">open</a> <a id="597" class="Keyword">import</a> <a id="604" href="Relation.Binary.html" class="Module">Relation.Binary</a> <a id="620" class="Keyword">using</a> <a id="626" class="Symbol">(</a><a id="627" href="Relation.Binary.Core.html#4903" class="Function">Decidable</a><a id="636" class="Symbol">)</a>
<a id="638" class="Keyword">open</a> <a id="643" class="Keyword">import</a> <a id="650" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a>
<a id="688" class="Keyword">open</a> <a id="693" class="Keyword">import</a> <a id="700" href="Relation.Binary.PropositionalEquality.Decidable.html" class="Module">Relation.Binary.PropositionalEquality.Decidable</a>
<a id="748" class="Keyword">open</a> <a id="753" class="Keyword">import</a> <a id="760" href="Relation.Nullary.html" class="Module">Relation.Nullary</a>
<a id="777" class="Keyword">open</a> <a id="782" class="Keyword">import</a> <a id="789" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="816" class="Keyword">using</a> <a id="822" class="Symbol">(</a><a id="823" href="Relation.Nullary.Decidable.html#1837" class="Function">map′</a><a id="827" class="Symbol">)</a>
<a id="829" class="Keyword">open</a> <a id="834" class="Keyword">import</a> <a id="841" href="Relation.Unary.html" class="Module">Relation.Unary</a> <a id="856" class="Keyword">using</a> <a id="862" class="Symbol">(</a><a id="863" href="Relation.Unary.html#3195" class="Function">IUniversal</a><a id="873" class="Symbol">)</a> <a id="875" class="Keyword">renaming</a> <a id="884" class="Symbol">(</a><a id="885" href="Relation.Unary.html#4143" class="Function Operator">_⇒_</a> <a id="889" class="Symbol">to</a> <a id="892" href="Relation.Unary.html#4143" class="Function Operator">_⟶_</a><a id="895" class="Symbol">)</a>

<a id="898" class="Keyword">open</a> <a id="903" class="Keyword">import</a> <a id="910" href="Text.Parser.Types.html" class="Module">Text.Parser.Types</a>
<a id="928" class="Keyword">open</a> <a id="933" class="Keyword">import</a> <a id="940" href="Text.Parser.Position.html" class="Module">Text.Parser.Position</a>
<a id="961" class="Keyword">open</a> <a id="966" class="Keyword">import</a> <a id="973" href="Text.Parser.Combinators.html" class="Module">Text.Parser.Combinators</a> <a id="997" class="Keyword">hiding</a> <a id="1004" class="Symbol">(</a><a id="1005" href="Text.Parser.Combinators.html#3051" class="Function Operator">_&gt;&gt;=_</a><a id="1010" class="Symbol">)</a>
<a id="1012" class="Keyword">open</a> <a id="1017" class="Keyword">import</a> <a id="1024" href="Text.Parser.Monad.html" class="Module">Text.Parser.Monad</a>

<a id="1043" class="Keyword">open</a> <a id="1048" class="Keyword">import</a> <a id="1055" href="Generic.AltSyntax.html" class="Module">Generic.AltSyntax</a>

<a id="1074" class="Keyword">open</a> <a id="1079" class="Keyword">import</a> <a id="1086" href="Language.html" class="Module">Language</a>
<a id="1095" class="Keyword">open</a> <a id="1100" href="Language.html#1911" class="Module">Surface</a>
<a id="1108" class="Keyword">open</a> <a id="1113" class="Keyword">import</a> <a id="1120" href="Types.html" class="Module">Types</a>

<a id="1127" class="Keyword">module</a> <a id="ParserM"></a><a id="1134" href="Parse.html#1134" class="Module">ParserM</a> <a id="1142" class="Symbol">=</a> <a id="1144" href="Text.Parser.Monad.html#3491" class="Module">Agdarsec</a> <a id="1153" href="Types.html#367" class="Datatype">Error</a> <a id="1159" href="Data.Empty.html#279" class="Datatype">⊥</a> <a id="1161" class="Symbol">(</a><a id="1162" class="Keyword">record</a> <a id="1169" class="Symbol">{</a> <a id="1171" class="Field">into</a> <a id="1176" class="Symbol">=</a> <a id="1178" href="Types.html#387" class="InductiveConstructor Operator">At_ParseError</a> <a id="1192" href="Function.html#994" class="Function Operator">∘′</a> <a id="1195" href="Agda.Builtin.Sigma.html#155" class="Field">proj₁</a> <a id="1201" class="Symbol">})</a>
<a id="1204" class="Keyword">open</a> <a id="1209" href="Parse.html#1134" class="Module">ParserM</a>

<a id="1218" class="Keyword">data</a> <a id="Tok"></a><a id="1223" href="Parse.html#1223" class="Datatype">Tok</a> <a id="1227" class="Symbol">:</a> <a id="1229" class="PrimitiveType">Set</a> <a id="1233" class="Keyword">where</a>
  <a id="Tok.ID"></a><a id="1241" href="Parse.html#1241" class="InductiveConstructor">ID</a>            <a id="1255" class="Symbol">:</a> <a id="1257" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1264" class="Symbol">→</a> <a id="1266" href="Parse.html#1223" class="Datatype">Tok</a>
  <a id="Tok.ARR"></a><a id="1272" href="Parse.html#1272" class="InductiveConstructor">ARR</a>           <a id="1286" class="Symbol">:</a> <a id="1288" href="Parse.html#1223" class="Datatype">Tok</a>
  <a id="Tok.LET"></a><a id="1294" href="Parse.html#1294" class="InductiveConstructor">LET</a> <a id="Tok.EQ"></a><a id="1298" href="Parse.html#1298" class="InductiveConstructor">EQ</a> <a id="Tok.IN"></a><a id="1301" href="Parse.html#1301" class="InductiveConstructor">IN</a>     <a id="1308" class="Symbol">:</a> <a id="1310" href="Parse.html#1223" class="Datatype">Tok</a>
  <a id="Tok.LAM"></a><a id="1316" href="Parse.html#1316" class="InductiveConstructor">LAM</a> <a id="Tok.DOT"></a><a id="1320" href="Parse.html#1320" class="InductiveConstructor">DOT</a>       <a id="1330" class="Symbol">:</a> <a id="1332" href="Parse.html#1223" class="Datatype">Tok</a>
  <a id="Tok.LPAR"></a><a id="1338" href="Parse.html#1338" class="InductiveConstructor">LPAR</a> <a id="Tok.COL"></a><a id="1343" href="Parse.html#1343" class="InductiveConstructor">COL</a> <a id="Tok.RPAR"></a><a id="1347" href="Parse.html#1347" class="InductiveConstructor">RPAR</a> <a id="1352" class="Symbol">:</a> <a id="1354" href="Parse.html#1223" class="Datatype">Tok</a>

<a id="_≟_"></a><a id="1359" href="Parse.html#1359" class="Function Operator">_≟_</a> <a id="1363" class="Symbol">:</a> <a id="1365" href="Relation.Binary.Core.html#4903" class="Function">Decidable</a> <a id="1375" class="Symbol">{</a><a id="1376" class="Argument">A</a> <a id="1378" class="Symbol">=</a> <a id="1380" href="Parse.html#1223" class="Datatype">Tok</a><a id="1383" class="Symbol">}</a> <a id="1385" href="Agda.Builtin.Equality.html#83" class="Datatype Operator">_≡_</a>
<a id="1389" href="Parse.html#1241" class="InductiveConstructor">ID</a> <a id="1392" href="Parse.html#1392" class="Bound">x</a> <a id="1394" href="Parse.html#1359" class="Function Operator">≟</a> <a id="1396" href="Parse.html#1241" class="InductiveConstructor">ID</a> <a id="1399" href="Parse.html#1399" class="Bound">y</a> <a id="1401" class="Symbol">=</a> <a id="1403" href="Relation.Nullary.Decidable.html#1837" class="Function">map′</a> <a id="1408" class="Symbol">(</a><a id="1409" href="Relation.Binary.PropositionalEquality.html#1134" class="Function">cong</a> <a id="1414" href="Parse.html#1241" class="InductiveConstructor">ID</a><a id="1416" class="Symbol">)</a> <a id="1418" class="Symbol">(λ</a> <a id="1421" class="Keyword">where</a> <a id="1427" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a> <a id="1432" class="Symbol">→</a> <a id="1434" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a><a id="1438" class="Symbol">)</a> <a id="1440" class="Symbol">(</a><a id="1441" href="Parse.html#1392" class="Bound">x</a> <a id="1443" href="Data.String.Unsafe.html#775" class="Function Operator">String.≟</a> <a id="1452" href="Parse.html#1399" class="Bound">y</a><a id="1453" class="Symbol">)</a>
<a id="1455" href="Parse.html#1272" class="InductiveConstructor">ARR</a>  <a id="1460" href="Parse.html#1359" class="Function Operator">≟</a> <a id="1462" href="Parse.html#1272" class="InductiveConstructor">ARR</a>  <a id="1467" class="Symbol">=</a> <a id="1469" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="1473" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="1478" href="Parse.html#1294" class="InductiveConstructor">LET</a>  <a id="1483" href="Parse.html#1359" class="Function Operator">≟</a> <a id="1485" href="Parse.html#1294" class="InductiveConstructor">LET</a>  <a id="1490" class="Symbol">=</a> <a id="1492" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="1496" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="1501" href="Parse.html#1298" class="InductiveConstructor">EQ</a>   <a id="1506" href="Parse.html#1359" class="Function Operator">≟</a> <a id="1508" href="Parse.html#1298" class="InductiveConstructor">EQ</a>   <a id="1513" class="Symbol">=</a> <a id="1515" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="1519" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="1524" href="Parse.html#1301" class="InductiveConstructor">IN</a>   <a id="1529" href="Parse.html#1359" class="Function Operator">≟</a> <a id="1531" href="Parse.html#1301" class="InductiveConstructor">IN</a>   <a id="1536" class="Symbol">=</a> <a id="1538" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="1542" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="1547" href="Parse.html#1316" class="InductiveConstructor">LAM</a>  <a id="1552" href="Parse.html#1359" class="Function Operator">≟</a> <a id="1554" href="Parse.html#1316" class="InductiveConstructor">LAM</a>  <a id="1559" class="Symbol">=</a> <a id="1561" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="1565" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="1570" href="Parse.html#1320" class="InductiveConstructor">DOT</a>  <a id="1575" href="Parse.html#1359" class="Function Operator">≟</a> <a id="1577" href="Parse.html#1320" class="InductiveConstructor">DOT</a>  <a id="1582" class="Symbol">=</a> <a id="1584" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="1588" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="1593" href="Parse.html#1338" class="InductiveConstructor">LPAR</a> <a id="1598" href="Parse.html#1359" class="Function Operator">≟</a> <a id="1600" href="Parse.html#1338" class="InductiveConstructor">LPAR</a> <a id="1605" class="Symbol">=</a> <a id="1607" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="1611" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="1616" href="Parse.html#1343" class="InductiveConstructor">COL</a>  <a id="1621" href="Parse.html#1359" class="Function Operator">≟</a> <a id="1623" href="Parse.html#1343" class="InductiveConstructor">COL</a>  <a id="1628" class="Symbol">=</a> <a id="1630" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="1634" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="1639" href="Parse.html#1347" class="InductiveConstructor">RPAR</a> <a id="1644" href="Parse.html#1359" class="Function Operator">≟</a> <a id="1646" href="Parse.html#1347" class="InductiveConstructor">RPAR</a> <a id="1651" class="Symbol">=</a> <a id="1653" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="1657" href="Agda.Builtin.Equality.html#140" class="InductiveConstructor">refl</a>
<a id="1662" class="CatchallClause Symbol">_</a><a id="1663" class="CatchallClause">    </a><a id="1667" href="Parse.html#1359" class="CatchallClause Function Operator">≟</a><a id="1668" class="CatchallClause"> </a><a id="1669" class="CatchallClause Symbol">_</a>    <a id="1674" class="Symbol">=</a> <a id="1676" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="1679" href="Parse.html#1697" class="Postulate">p</a> <a id="1681" class="Keyword">where</a> <a id="1687" class="Keyword">postulate</a> <a id="1697" href="Parse.html#1697" class="Postulate">p</a> <a id="1699" class="Symbol">:</a> <a id="1701" class="Symbol">_</a>

<a id="Token"></a><a id="1704" href="Parse.html#1704" class="Function">Token</a> <a id="1710" class="Symbol">:</a> <a id="1712" class="PrimitiveType">Set</a>
<a id="1716" href="Parse.html#1704" class="Function">Token</a> <a id="1722" class="Symbol">=</a> <a id="1724" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="1733" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="1735" href="Parse.html#1223" class="Datatype">Tok</a>

<a id="tokenize"></a><a id="1740" href="Parse.html#1740" class="Function">tokenize</a> <a id="1749" class="Symbol">:</a> <a id="1751" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1756" href="Agda.Builtin.Char.html#132" class="Postulate">Char</a> <a id="1761" class="Symbol">→</a> <a id="1763" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1768" href="Parse.html#1704" class="Function">Token</a>
<a id="1774" href="Parse.html#1740" class="Function">tokenize</a> <a id="1783" class="Symbol">=</a> <a id="1785" href="Parse.html#2234" class="Function">go</a> <a id="1788" class="Symbol">(</a><a id="1789" href="Text.Parser.Position.html#409" class="Function">start</a> <a id="1795" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1797" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="1799" class="Symbol">)</a> <a id="1801" href="Text.Parser.Position.html#409" class="Function">start</a> <a id="1807" class="Keyword">where</a>

  <a id="1816" class="Keyword">mutual</a>

    <a id="1828" href="Parse.html#1828" class="Function">pushID</a> <a id="1835" class="Symbol">:</a> <a id="1837" class="Symbol">(</a><a id="1838" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="1847" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="1849" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1854" href="Agda.Builtin.Char.html#132" class="Postulate">Char</a><a id="1858" class="Symbol">)</a> <a id="1860" class="Symbol">→</a> <a id="1862" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1867" href="Parse.html#1704" class="Function">Token</a> <a id="1873" class="Symbol">→</a> <a id="1875" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="1880" href="Parse.html#1704" class="Function">Token</a>
    <a id="1890" href="Parse.html#1828" class="Function">pushID</a> <a id="1897" class="Symbol">(</a><a id="1898" href="Parse.html#1898" class="Bound">p</a> <a id="1900" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="1902" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="1904" class="Symbol">)</a>  <a id="1907" href="Parse.html#1907" class="Bound">xs</a> <a id="1910" class="Symbol">=</a> <a id="1912" href="Parse.html#1907" class="Bound">xs</a>
    <a id="1919" href="Parse.html#1828" class="CatchallClause Function">pushID</a><a id="1925" class="CatchallClause"> </a><a id="1926" href="Parse.html#1926" class="CatchallClause Bound">acc</a><a id="1929" class="CatchallClause">       </a><a id="1936" href="Parse.html#1936" class="CatchallClause Bound">xs</a> <a id="1939" class="Symbol">=</a> <a id="1941" href="Data.Product.html#2474" class="Function">map₂</a> <a id="1946" class="Symbol">(</a><a id="1947" href="Parse.html#1241" class="InductiveConstructor">ID</a> <a id="1950" href="Function.html#994" class="Function Operator">∘′</a> <a id="1953" href="Data.String.Base.html#960" class="Function">fromList</a> <a id="1962" href="Function.html#994" class="Function Operator">∘′</a> <a id="1965" href="Data.List.Base.html#9615" class="Function">List.reverse</a><a id="1977" class="Symbol">)</a> <a id="1979" href="Parse.html#1926" class="Bound">acc</a> <a id="1983" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="1985" href="Parse.html#1936" class="Bound">xs</a>

    <a id="1993" href="Parse.html#1993" class="Function">breakOn</a> <a id="2001" class="Symbol">:</a> <a id="2003" class="Symbol">(</a><a id="2004" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="2013" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="2015" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2020" href="Agda.Builtin.Char.html#132" class="Postulate">Char</a><a id="2024" class="Symbol">)</a> <a id="2026" class="Symbol">→</a>
              <a id="2042" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="2048" href="Parse.html#1704" class="Function">Token</a> <a id="2054" class="Symbol">→</a> <a id="2056" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="2063" class="Symbol">→</a>
              <a id="2079" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="2088" class="Symbol">→</a> <a id="2090" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2095" href="Agda.Builtin.Char.html#132" class="Postulate">Char</a> <a id="2100" class="Symbol">→</a> <a id="2102" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2107" href="Parse.html#1704" class="Function">Token</a>
    <a id="2117" href="Parse.html#1993" class="Function">breakOn</a> <a id="2125" href="Parse.html#2125" class="Bound">acc</a> <a id="2129" href="Parse.html#2129" class="Bound">mtok</a> <a id="2134" href="Parse.html#2134" class="Bound">str</a> <a id="2138" href="Parse.html#2138" class="Bound">p</a> <a id="2140" href="Parse.html#2140" class="Bound">xs</a> <a id="2143" class="Symbol">=</a> <a id="2145" href="Parse.html#1828" class="Function">pushID</a> <a id="2152" href="Parse.html#2125" class="Bound">acc</a> <a id="2156" class="Symbol">(</a><a id="2157" href="Data.Maybe.Base.html#1618" class="Function">maybe′</a> <a id="2164" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">_∷_</a> <a id="2168" href="Function.html#1104" class="Function">id</a> <a id="2171" href="Parse.html#2129" class="Bound">mtok</a> <a id="2176" href="Function.html#1927" class="Function Operator">$</a> <a id="2178" href="Parse.html#2234" class="Function">go</a> <a id="2181" class="Symbol">(</a><a id="2182" href="Parse.html#2210" class="Function">p&#39;</a> <a id="2185" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2187" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="2189" class="Symbol">)</a> <a id="2191" href="Parse.html#2210" class="Function">p&#39;</a> <a id="2194" href="Parse.html#2140" class="Bound">xs</a><a id="2196" class="Symbol">)</a>
      <a id="2204" class="Keyword">where</a> <a id="2210" href="Parse.html#2210" class="Function">p&#39;</a> <a id="2213" class="Symbol">=</a> <a id="2215" href="Text.Parser.Position.html#619" class="Function">updates</a> <a id="2223" href="Parse.html#2134" class="Bound">str</a> <a id="2227" href="Parse.html#2138" class="Bound">p</a>

    <a id="2234" href="Parse.html#2234" class="Function">go</a> <a id="2237" class="Symbol">:</a> <a id="2239" class="Symbol">(</a><a id="2240" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="2249" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="2251" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2256" href="Agda.Builtin.Char.html#132" class="Postulate">Char</a><a id="2260" class="Symbol">)</a> <a id="2262" class="Symbol">→</a> <a id="2264" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="2273" class="Symbol">→</a> <a id="2275" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2280" href="Agda.Builtin.Char.html#132" class="Postulate">Char</a> <a id="2285" class="Symbol">→</a> <a id="2287" href="Agda.Builtin.List.html#80" class="Datatype">List</a> <a id="2292" href="Parse.html#1704" class="Function">Token</a>
    <a id="2302" href="Parse.html#2234" class="Function">go</a> <a id="2305" href="Parse.html#2305" class="Bound">acc</a> <a id="2309" href="Parse.html#2309" class="Bound">p</a> <a id="2311" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>                     <a id="2334" class="Symbol">=</a> <a id="2336" href="Parse.html#1828" class="Function">pushID</a> <a id="2343" href="Parse.html#2305" class="Bound">acc</a> <a id="2347" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a>
    <a id="2354" href="Parse.html#2234" class="Function">go</a> <a id="2357" href="Parse.html#2357" class="Bound">acc</a> <a id="2361" href="Parse.html#2361" class="Bound">p</a> <a id="2363" class="Symbol">(</a><a id="2364" class="String">&#39;→&#39;</a> <a id="2368" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2370" href="Parse.html#2370" class="Bound">xs</a><a id="2372" class="Symbol">)</a>             <a id="2386" class="Symbol">=</a> <a id="2388" href="Parse.html#1993" class="Function">breakOn</a> <a id="2396" href="Parse.html#2357" class="Bound">acc</a> <a id="2400" class="Symbol">(</a><a id="2401" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="2406" class="Symbol">(</a><a id="2407" href="Parse.html#2361" class="Bound">p</a> <a id="2409" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2411" href="Parse.html#1272" class="InductiveConstructor">ARR</a><a id="2414" class="Symbol">))</a> <a id="2417" class="String">&quot;→&quot;</a> <a id="2421" href="Parse.html#2361" class="Bound">p</a> <a id="2423" href="Parse.html#2370" class="Bound">xs</a>
    <a id="2430" href="Parse.html#2234" class="Function">go</a> <a id="2433" href="Parse.html#2433" class="Bound">acc</a> <a id="2437" href="Parse.html#2437" class="Bound">p</a> <a id="2439" class="Symbol">(</a><a id="2440" class="String">&#39;(&#39;</a> <a id="2444" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2446" href="Parse.html#2446" class="Bound">xs</a><a id="2448" class="Symbol">)</a>             <a id="2462" class="Symbol">=</a> <a id="2464" href="Parse.html#1993" class="Function">breakOn</a> <a id="2472" href="Parse.html#2433" class="Bound">acc</a> <a id="2476" class="Symbol">(</a><a id="2477" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="2482" class="Symbol">(</a><a id="2483" href="Parse.html#2437" class="Bound">p</a> <a id="2485" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2487" href="Parse.html#1338" class="InductiveConstructor">LPAR</a><a id="2491" class="Symbol">))</a> <a id="2494" class="String">&quot;(&quot;</a> <a id="2498" href="Parse.html#2437" class="Bound">p</a> <a id="2500" href="Parse.html#2446" class="Bound">xs</a>
    <a id="2507" href="Parse.html#2234" class="Function">go</a> <a id="2510" href="Parse.html#2510" class="Bound">acc</a> <a id="2514" href="Parse.html#2514" class="Bound">p</a> <a id="2516" class="Symbol">(</a><a id="2517" class="String">&#39;)&#39;</a> <a id="2521" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2523" href="Parse.html#2523" class="Bound">xs</a><a id="2525" class="Symbol">)</a>             <a id="2539" class="Symbol">=</a> <a id="2541" href="Parse.html#1993" class="Function">breakOn</a> <a id="2549" href="Parse.html#2510" class="Bound">acc</a> <a id="2553" class="Symbol">(</a><a id="2554" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="2559" class="Symbol">(</a><a id="2560" href="Parse.html#2514" class="Bound">p</a> <a id="2562" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2564" href="Parse.html#1347" class="InductiveConstructor">RPAR</a><a id="2568" class="Symbol">))</a> <a id="2571" class="String">&quot;)&quot;</a> <a id="2575" href="Parse.html#2514" class="Bound">p</a> <a id="2577" href="Parse.html#2523" class="Bound">xs</a>
    <a id="2584" href="Parse.html#2234" class="Function">go</a> <a id="2587" href="Parse.html#2587" class="Bound">acc</a> <a id="2591" href="Parse.html#2591" class="Bound">p</a> <a id="2593" class="Symbol">(</a><a id="2594" class="String">&#39;=&#39;</a> <a id="2598" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2600" href="Parse.html#2600" class="Bound">xs</a><a id="2602" class="Symbol">)</a>             <a id="2616" class="Symbol">=</a> <a id="2618" href="Parse.html#1993" class="Function">breakOn</a> <a id="2626" href="Parse.html#2587" class="Bound">acc</a> <a id="2630" class="Symbol">(</a><a id="2631" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="2636" class="Symbol">(</a><a id="2637" href="Parse.html#2591" class="Bound">p</a> <a id="2639" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2641" href="Parse.html#1298" class="InductiveConstructor">EQ</a><a id="2643" class="Symbol">))</a> <a id="2646" class="String">&quot;=&quot;</a> <a id="2650" href="Parse.html#2591" class="Bound">p</a> <a id="2652" href="Parse.html#2600" class="Bound">xs</a>
    <a id="2659" href="Parse.html#2234" class="Function">go</a> <a id="2662" href="Parse.html#2662" class="Bound">acc</a> <a id="2666" href="Parse.html#2666" class="Bound">p</a> <a id="2668" class="Symbol">(</a><a id="2669" class="String">&#39;λ&#39;</a> <a id="2673" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2675" href="Parse.html#2675" class="Bound">xs</a><a id="2677" class="Symbol">)</a>             <a id="2691" class="Symbol">=</a> <a id="2693" href="Parse.html#1993" class="Function">breakOn</a> <a id="2701" href="Parse.html#2662" class="Bound">acc</a> <a id="2705" class="Symbol">(</a><a id="2706" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="2711" class="Symbol">(</a><a id="2712" href="Parse.html#2666" class="Bound">p</a> <a id="2714" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2716" href="Parse.html#1316" class="InductiveConstructor">LAM</a><a id="2719" class="Symbol">))</a> <a id="2722" class="String">&quot;λ&quot;</a> <a id="2726" href="Parse.html#2666" class="Bound">p</a> <a id="2728" href="Parse.html#2675" class="Bound">xs</a>
    <a id="2735" href="Parse.html#2234" class="Function">go</a> <a id="2738" href="Parse.html#2738" class="Bound">acc</a> <a id="2742" href="Parse.html#2742" class="Bound">p</a> <a id="2744" class="Symbol">(</a><a id="2745" class="String">&#39;.&#39;</a> <a id="2749" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2751" href="Parse.html#2751" class="Bound">xs</a><a id="2753" class="Symbol">)</a>             <a id="2767" class="Symbol">=</a> <a id="2769" href="Parse.html#1993" class="Function">breakOn</a> <a id="2777" href="Parse.html#2738" class="Bound">acc</a> <a id="2781" class="Symbol">(</a><a id="2782" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="2787" class="Symbol">(</a><a id="2788" href="Parse.html#2742" class="Bound">p</a> <a id="2790" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2792" href="Parse.html#1320" class="InductiveConstructor">DOT</a><a id="2795" class="Symbol">))</a> <a id="2798" class="String">&quot;.&quot;</a> <a id="2802" href="Parse.html#2742" class="Bound">p</a> <a id="2804" href="Parse.html#2751" class="Bound">xs</a>
    <a id="2811" href="Parse.html#2234" class="Function">go</a> <a id="2814" href="Parse.html#2814" class="Bound">acc</a> <a id="2818" href="Parse.html#2818" class="Bound">p</a> <a id="2820" class="Symbol">(</a><a id="2821" class="String">&#39;:&#39;</a> <a id="2825" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2827" href="Parse.html#2827" class="Bound">xs</a><a id="2829" class="Symbol">)</a>             <a id="2843" class="Symbol">=</a> <a id="2845" href="Parse.html#1993" class="Function">breakOn</a> <a id="2853" href="Parse.html#2814" class="Bound">acc</a> <a id="2857" class="Symbol">(</a><a id="2858" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="2863" class="Symbol">(</a><a id="2864" href="Parse.html#2818" class="Bound">p</a> <a id="2866" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2868" href="Parse.html#1343" class="InductiveConstructor">COL</a><a id="2871" class="Symbol">))</a> <a id="2874" class="String">&quot;:&quot;</a> <a id="2878" href="Parse.html#2818" class="Bound">p</a> <a id="2880" href="Parse.html#2827" class="Bound">xs</a>
    <a id="2887" href="Parse.html#2234" class="Function">go</a> <a id="2890" href="Parse.html#2890" class="Bound">acc</a> <a id="2894" href="Parse.html#2894" class="Bound">p</a> <a id="2896" class="Symbol">(</a><a id="2897" class="String">&#39;l&#39;</a> <a id="2901" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2903" class="String">&#39;e&#39;</a> <a id="2907" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2909" class="String">&#39;t&#39;</a> <a id="2913" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2915" href="Parse.html#2915" class="Bound">xs</a><a id="2917" class="Symbol">)</a> <a id="2919" class="Symbol">=</a> <a id="2921" href="Parse.html#1993" class="Function">breakOn</a> <a id="2929" href="Parse.html#2890" class="Bound">acc</a> <a id="2933" class="Symbol">(</a><a id="2934" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="2939" class="Symbol">(</a><a id="2940" href="Parse.html#2894" class="Bound">p</a> <a id="2942" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2944" href="Parse.html#1294" class="InductiveConstructor">LET</a><a id="2947" class="Symbol">))</a> <a id="2950" class="String">&quot;let&quot;</a> <a id="2956" href="Parse.html#2894" class="Bound">p</a> <a id="2958" href="Parse.html#2915" class="Bound">xs</a>
    <a id="2965" href="Parse.html#2234" class="Function">go</a> <a id="2968" href="Parse.html#2968" class="Bound">acc</a> <a id="2972" href="Parse.html#2972" class="Bound">p</a> <a id="2974" class="Symbol">(</a><a id="2975" class="String">&#39;i&#39;</a> <a id="2979" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2981" class="String">&#39;n&#39;</a> <a id="2985" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="2987" href="Parse.html#2987" class="Bound">xs</a><a id="2989" class="Symbol">)</a>       <a id="2997" class="Symbol">=</a> <a id="2999" href="Parse.html#1993" class="Function">breakOn</a> <a id="3007" href="Parse.html#2968" class="Bound">acc</a> <a id="3011" class="Symbol">(</a><a id="3012" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="3017" class="Symbol">(</a><a id="3018" href="Parse.html#2972" class="Bound">p</a> <a id="3020" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3022" href="Parse.html#1301" class="InductiveConstructor">IN</a><a id="3024" class="Symbol">))</a> <a id="3027" class="String">&quot;in&quot;</a> <a id="3032" href="Parse.html#2972" class="Bound">p</a> <a id="3034" href="Parse.html#2987" class="Bound">xs</a>
    <a id="3041" href="Parse.html#2234" class="CatchallClause Function">go</a><a id="3043" class="CatchallClause"> </a><a id="3044" href="Parse.html#3044" class="CatchallClause Bound">acc</a><a id="3047" class="CatchallClause"> </a><a id="3048" href="Parse.html#3048" class="CatchallClause Bound">p</a><a id="3049" class="CatchallClause"> </a><a id="3050" class="CatchallClause Symbol">(</a><a id="3051" href="Parse.html#3051" class="CatchallClause Bound">c</a><a id="3052" class="CatchallClause"> </a><a id="3053" href="Agda.Builtin.List.html#132" class="CatchallClause InductiveConstructor Operator">∷</a><a id="3054" class="CatchallClause"> </a><a id="3055" href="Parse.html#3055" class="CatchallClause Bound">xs</a><a id="3057" class="CatchallClause Symbol">)</a>   <a id="3061" class="Symbol">=</a> <a id="3063" href="Data.Bool.Base.html#835" class="Function Operator">if</a> <a id="3066" href="Data.Char.Base.html#918" class="Function">isSpace</a> <a id="3074" href="Parse.html#3051" class="Bound">c</a>
      <a id="3082" href="Data.Bool.Base.html#835" class="Function Operator">then</a> <a id="3087" href="Parse.html#1993" class="Function">breakOn</a> <a id="3095" href="Parse.html#3044" class="Bound">acc</a> <a id="3099" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a> <a id="3107" class="Symbol">(</a><a id="3108" href="Data.String.Base.html#960" class="Function">String.fromList</a> <a id="3124" class="Symbol">(</a><a id="3125" href="Parse.html#3051" class="Bound">c</a> <a id="3127" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="3129" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="3131" class="Symbol">))</a> <a id="3134" href="Parse.html#3048" class="Bound">p</a> <a id="3136" href="Parse.html#3055" class="Bound">xs</a>
      <a id="3145" href="Data.Bool.Base.html#835" class="Function Operator">else</a> <a id="3150" href="Parse.html#2234" class="Function">go</a> <a id="3153" class="Symbol">(</a><a id="3154" href="Data.Product.html#2474" class="Function">map₂</a> <a id="3159" class="Symbol">(</a><a id="3160" href="Parse.html#3051" class="Bound">c</a> <a id="3162" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷_</a><a id="3164" class="Symbol">)</a> <a id="3166" href="Parse.html#3044" class="Bound">acc</a><a id="3169" class="Symbol">)</a> <a id="3171" class="Symbol">(</a><a id="3172" href="Text.Parser.Position.html#461" class="Function">update</a> <a id="3179" href="Parse.html#3051" class="Bound">c</a> <a id="3181" href="Parse.html#3048" class="Bound">p</a><a id="3182" class="Symbol">)</a> <a id="3184" href="Parse.html#3055" class="Bound">xs</a>

<a id="3188" class="Keyword">instance</a>
  <a id="3199" href="Parse.html#3199" class="Function">_</a> <a id="3201" class="Symbol">=</a> <a id="3203" href="Text.Parser.Monad.html#2031" class="Function">ParserM.monadZero</a>
  <a id="3223" href="Parse.html#3223" class="Function">_</a> <a id="3225" class="Symbol">=</a> <a id="3227" href="Text.Parser.Monad.html#2168" class="Function">ParserM.monadPlus</a>
  <a id="3247" href="Parse.html#3247" class="Function">_</a> <a id="3249" class="Symbol">=</a> <a id="3251" href="Text.Parser.Monad.html#1947" class="Function">ParserM.monad</a>

<a id="P"></a><a id="3266" href="Parse.html#3266" class="Function">P</a> <a id="3268" class="Symbol">=</a> <a id="3270" href="Text.Parser.Monad.html#3228" class="Function">ParserM.param</a> <a id="3284" href="Parse.html#1704" class="Function">Token</a> <a id="3290" class="Symbol">(</a><a id="3291" href="Data.Vec.html#773" class="Datatype">Vec</a> <a id="3295" href="Parse.html#1704" class="Function">Token</a><a id="3300" class="Symbol">)</a> <a id="3302" class="Symbol">λ</a> <a id="3304" class="Keyword">where</a> <a id="3310" class="Symbol">(</a><a id="3311" href="Parse.html#3311" class="Bound">p</a> <a id="3313" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3315" class="Symbol">_)</a> <a id="3318" class="Symbol">_</a> <a id="3320" class="Symbol">→</a> <a id="3322" href="Text.Parser.Monad.html#733" class="InductiveConstructor">Value</a> <a id="3328" class="Symbol">(_</a> <a id="3331" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3333" href="Parse.html#3311" class="Bound">p</a> <a id="3335" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3337" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="3339" class="Symbol">)</a>

<a id="theTok"></a><a id="3342" href="Parse.html#3342" class="Function">theTok</a> <a id="3349" class="Symbol">:</a> <a id="3351" href="Parse.html#1223" class="Datatype">Tok</a> <a id="3355" class="Symbol">→</a> <a id="3357" href="Relation.Unary.html#3195" class="Function">∀[</a> <a id="3360" href="Text.Parser.Types.html#1195" class="Record">Parser</a> <a id="3367" href="Parse.html#3266" class="Function">P</a> <a id="3369" href="Parse.html#1704" class="Function">Token</a> <a id="3375" href="Relation.Unary.html#3195" class="Function">]</a>
<a id="3377" href="Parse.html#3342" class="Function">theTok</a> <a id="3384" href="Parse.html#3384" class="Bound">t</a> <a id="3386" class="Symbol">=</a> <a id="3388" href="Text.Parser.Combinators.html#1597" class="Function">maybeTok</a> <a id="3397" href="Function.html#1927" class="Function Operator">$</a> <a id="3399" class="Symbol">λ</a> <a id="3401" class="Keyword">where</a>
  <a id="3409" href="Parse.html#3409" class="Bound">tok</a><a id="3412" class="Symbol">@(</a><a id="3414" href="Parse.html#3414" class="Bound">p</a> <a id="3416" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3418" href="Parse.html#3418" class="Bound">t&#39;</a><a id="3420" class="Symbol">)</a> <a id="3422" class="Symbol">→</a> <a id="3424" href="Function.html#3533" class="Function Operator">case</a> <a id="3429" href="Parse.html#3384" class="Bound">t</a> <a id="3431" href="Parse.html#1359" class="Function Operator">≟</a> <a id="3433" href="Parse.html#3418" class="Bound">t&#39;</a> <a id="3436" href="Function.html#3533" class="Function Operator">of</a> <a id="3439" class="Symbol">λ</a> <a id="3441" class="Keyword">where</a>
    <a id="3451" class="Symbol">(</a><a id="3452" href="Relation.Nullary.html#606" class="InductiveConstructor">yes</a> <a id="3456" href="Parse.html#3456" class="Bound">eq</a><a id="3458" class="Symbol">)</a> <a id="3460" class="Symbol">→</a> <a id="3462" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="3467" href="Parse.html#3409" class="Bound">tok</a>
    <a id="3475" class="Symbol">(</a><a id="3476" href="Relation.Nullary.html#633" class="InductiveConstructor">no</a> <a id="3479" href="Parse.html#3479" class="Bound">¬eq</a><a id="3482" class="Symbol">)</a> <a id="3484" class="Symbol">→</a> <a id="3486" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a>

<a id="name"></a><a id="3495" href="Parse.html#3495" class="Function">name</a> <a id="3500" class="Symbol">:</a> <a id="3502" href="Relation.Unary.html#3195" class="Function">∀[</a> <a id="3505" href="Text.Parser.Types.html#1195" class="Record">Parser</a> <a id="3512" href="Parse.html#3266" class="Function">P</a> <a id="3514" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="3521" href="Relation.Unary.html#3195" class="Function">]</a>
<a id="3523" href="Parse.html#3495" class="Function">name</a> <a id="3528" class="Symbol">=</a> <a id="3530" href="Text.Parser.Combinators.html#1597" class="Function">maybeTok</a> <a id="3539" class="Symbol">λ</a> <a id="3541" class="Keyword">where</a> <a id="3547" class="Symbol">(</a><a id="3548" href="Parse.html#3548" class="Bound">p</a> <a id="3550" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3552" href="Parse.html#1241" class="InductiveConstructor">ID</a> <a id="3555" href="Parse.html#3555" class="Bound">str</a><a id="3558" class="Symbol">)</a> <a id="3560" class="Symbol">→</a> <a id="3562" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="3567" href="Parse.html#3555" class="Bound">str</a><a id="3570" class="Symbol">;</a> <a id="3572" class="CatchallClause Symbol">_</a> <a id="3574" class="Symbol">→</a> <a id="3576" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a>

<a id="parens"></a><a id="3585" href="Parse.html#3585" class="Function">parens</a> <a id="3592" class="Symbol">:</a> <a id="3594" class="Symbol">∀</a> <a id="3596" class="Symbol">{</a><a id="3597" href="Parse.html#3597" class="Bound">A</a><a id="3598" class="Symbol">}</a> <a id="3600" class="Symbol">→</a> <a id="3602" href="Relation.Unary.html#3195" class="Function">∀[</a> <a id="3605" href="Induction.Nat.Strong.html#197" class="Record Operator">□</a> <a id="3607" href="Text.Parser.Types.html#1195" class="Record">Parser</a> <a id="3614" href="Parse.html#3266" class="Function">P</a> <a id="3616" href="Parse.html#3597" class="Bound">A</a> <a id="3618" href="Relation.Unary.html#4143" class="Function Operator">⟶</a> <a id="3620" href="Text.Parser.Types.html#1195" class="Record">Parser</a> <a id="3627" href="Parse.html#3266" class="Function">P</a> <a id="3629" href="Parse.html#3597" class="Bound">A</a> <a id="3631" href="Relation.Unary.html#3195" class="Function">]</a>
<a id="3633" href="Parse.html#3585" class="Function">parens</a> <a id="3640" href="Parse.html#3640" class="Bound">□p</a> <a id="3643" class="Symbol">=</a> <a id="3645" href="Parse.html#3342" class="Function">theTok</a> <a id="3652" href="Parse.html#1338" class="InductiveConstructor">LPAR</a> <a id="3657" href="Text.Parser.Combinators.html#3349" class="Function Operator">&amp;&gt;</a> <a id="3660" href="Parse.html#3640" class="Bound">□p</a> <a id="3663" href="Text.Parser.Combinators.html#3264" class="Function Operator">&lt;&amp;</a> <a id="3666" href="Text.Parser.Combinators.html#1904" class="Function">box</a> <a id="3670" class="Symbol">(</a><a id="3671" href="Parse.html#3342" class="Function">theTok</a> <a id="3678" href="Parse.html#1347" class="InductiveConstructor">RPAR</a><a id="3682" class="Symbol">)</a>

<a id="type"></a><a id="3685" href="Parse.html#3685" class="Function">type</a> <a id="3690" class="Symbol">:</a> <a id="3692" href="Relation.Unary.html#3195" class="Function">∀[</a> <a id="3695" href="Text.Parser.Types.html#1195" class="Record">Parser</a> <a id="3702" href="Parse.html#3266" class="Function">P</a> <a id="3704" class="Symbol">(</a><a id="3705" href="Language.html#672" class="Datatype">Type</a> <a id="3710" href="Agda.Builtin.String.html#165" class="Postulate">String</a><a id="3716" class="Symbol">)</a> <a id="3718" href="Relation.Unary.html#3195" class="Function">]</a>
<a id="3720" href="Parse.html#3685" class="Function">type</a> <a id="3725" class="Symbol">=</a> <a id="3727" href="Induction.Nat.Strong.html#1160" class="Function">fix</a> <a id="3731" class="Symbol">_</a> <a id="3733" href="Function.html#1927" class="Function Operator">$</a> <a id="3735" class="Symbol">λ</a> <a id="3737" href="Parse.html#3737" class="Bound">rec</a> <a id="3741" class="Symbol">→</a>
  <a id="3745" class="Keyword">let</a> <a id="3749" href="Parse.html#3749" class="Bound">varlike</a> <a id="3757" href="Parse.html#3757" class="Bound">str</a> <a id="3761" class="Symbol">=</a> <a id="3763" href="Function.html#3533" class="Function Operator">case</a> <a id="3768" href="Data.String.Base.html#905" class="Function">String.toList</a> <a id="3782" href="Parse.html#3757" class="Bound">str</a> <a id="3786" href="Function.html#3533" class="Function Operator">of</a> <a id="3789" class="Symbol">λ</a> <a id="3791" class="Keyword">where</a>
        <a id="3805" class="Symbol">(</a><a id="3806" class="String">&#39;`&#39;</a> <a id="3810" href="Agda.Builtin.List.html#132" class="InductiveConstructor Operator">∷</a> <a id="3812" href="Parse.html#3812" class="Bound">nm</a><a id="3814" class="Symbol">)</a> <a id="3816" class="Symbol">→</a> <a id="3818" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="3823" class="Symbol">(</a><a id="3824" href="Data.String.Base.html#960" class="Function">String.fromList</a> <a id="3840" href="Parse.html#3812" class="Bound">nm</a><a id="3842" class="Symbol">)</a>
        <a id="3852" class="CatchallClause Symbol">_</a> <a id="3854" class="Symbol">→</a> <a id="3856" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a>
  <a id="3866" class="Keyword">in</a> <a id="3869" href="Text.Parser.Combinators.html#6944" class="Function">chainr1</a> <a id="3877" class="Symbol">(</a><a id="3878" href="Language.html#701" class="InductiveConstructor">α</a> <a id="3880" href="Text.Parser.Combinators.html#2211" class="Function Operator">&lt;$&gt;</a> <a id="3884" href="Text.Parser.Combinators.html#1308" class="Function">guardM</a> <a id="3891" href="Parse.html#3749" class="Bound">varlike</a> <a id="3899" href="Parse.html#3495" class="Function">name</a> <a id="3904" href="Text.Parser.Combinators.html#2038" class="Function Operator">&lt;|&gt;</a> <a id="3908" href="Parse.html#3585" class="Function">parens</a> <a id="3915" href="Parse.html#3737" class="Bound">rec</a><a id="3918" class="Symbol">)</a>
             <a id="3933" class="Symbol">(</a><a id="3934" href="Text.Parser.Combinators.html#1904" class="Function">box</a> <a id="3938" class="Symbol">(</a><a id="3939" href="Language.html#720" class="InductiveConstructor Operator">_⇒_</a> <a id="3943" href="Text.Parser.Combinators.html#2339" class="Function Operator">&lt;$</a> <a id="3946" href="Parse.html#3342" class="Function">theTok</a> <a id="3953" href="Parse.html#1272" class="InductiveConstructor">ARR</a><a id="3956" class="Symbol">))</a>

<a id="3960" class="Keyword">record</a> <a id="Bidirectional"></a><a id="3967" href="Parse.html#3967" class="Record">Bidirectional</a> <a id="3981" href="Parse.html#3981" class="Bound">n</a> <a id="3983" class="Symbol">:</a> <a id="3985" class="PrimitiveType">Set</a> <a id="3989" class="Keyword">where</a>
  <a id="3997" class="Keyword">field</a> <a id="Bidirectional.infer"></a><a id="4003" href="Parse.html#4003" class="Field">infer</a> <a id="4009" class="Symbol">:</a> <a id="4011" href="Text.Parser.Types.html#1195" class="Record">Parser</a> <a id="4018" href="Parse.html#3266" class="Function">P</a> <a id="4020" class="Symbol">(</a><a id="4021" href="Language.html#2443" class="Function">Parsed</a> <a id="4028" href="Language.html#775" class="InductiveConstructor">Infer</a><a id="4033" class="Symbol">)</a> <a id="4035" href="Parse.html#3981" class="Bound">n</a>
        <a id="Bidirectional.check"></a><a id="4045" href="Parse.html#4045" class="Field">check</a> <a id="4051" class="Symbol">:</a> <a id="4053" href="Text.Parser.Types.html#1195" class="Record">Parser</a> <a id="4060" href="Parse.html#3266" class="Function">P</a> <a id="4062" class="Symbol">(</a><a id="4063" href="Language.html#2443" class="Function">Parsed</a> <a id="4070" href="Language.html#781" class="InductiveConstructor">Check</a><a id="4075" class="Symbol">)</a> <a id="4077" href="Parse.html#3981" class="Bound">n</a>
<a id="4079" class="Keyword">open</a> <a id="4084" href="Parse.html#3967" class="Module">Bidirectional</a>

<a id="bidirectional"></a><a id="4099" href="Parse.html#4099" class="Function">bidirectional</a> <a id="4113" class="Symbol">:</a> <a id="4115" href="Relation.Unary.html#3195" class="Function">∀[</a> <a id="4118" href="Parse.html#3967" class="Record">Bidirectional</a> <a id="4132" href="Relation.Unary.html#3195" class="Function">]</a>
<a id="4134" href="Parse.html#4099" class="Function">bidirectional</a> <a id="4148" class="Symbol">=</a> <a id="4150" href="Induction.Nat.Strong.html#1160" class="Function">fix</a> <a id="4154" href="Parse.html#3967" class="Record">Bidirectional</a> <a id="4168" href="Function.html#1927" class="Function Operator">$</a> <a id="4170" class="Symbol">λ</a> <a id="4172" href="Parse.html#4172" class="Bound">rec</a> <a id="4176" class="Symbol">→</a>
  <a id="4180" class="Keyword">let</a> <a id="4184" href="Parse.html#4184" class="Bound">□check</a> <a id="4191" class="Symbol">=</a> <a id="4193" href="Induction.Nat.Strong.html#341" class="Function">INS.map</a> <a id="4201" href="Parse.html#4045" class="Field">check</a> <a id="4207" href="Parse.html#4172" class="Bound">rec</a>
      <a id="4217" href="Parse.html#4217" class="Bound">□infer</a> <a id="4224" class="Symbol">=</a> <a id="4226" href="Induction.Nat.Strong.html#341" class="Function">INS.map</a> <a id="4234" href="Parse.html#4003" class="Field">infer</a> <a id="4240" href="Parse.html#4172" class="Bound">rec</a>
      <a id="4250" href="Parse.html#4250" class="Bound">var</a>    <a id="4257" class="Symbol">=</a> <a id="4259" href="Generic.AltSyntax.html#1748" class="InductiveConstructor">`var</a> <a id="4264" href="Text.Parser.Combinators.html#2211" class="Function Operator">&lt;$&gt;</a> <a id="4268" href="Text.Parser.Combinators.html#1485" class="Function">guard</a> <a id="4274" class="Symbol">(</a><a id="4275" href="Data.List.Base.html#4312" class="Function">List.all</a> <a id="4284" href="Data.Char.Base.html#873" class="Function">isAlpha</a> <a id="4292" href="Function.html#994" class="Function Operator">∘′</a> <a id="4295" href="Data.String.Base.html#905" class="Function">toList</a><a id="4301" class="Symbol">)</a> <a id="4303" href="Parse.html#3495" class="Function">name</a>
      <a id="4314" href="Parse.html#4314" class="Bound">cut</a>    <a id="4321" class="Symbol">=</a> <a id="4323" class="Symbol">(λ</a> <a id="4326" class="Keyword">where</a> <a id="4332" class="Symbol">((</a><a id="4334" href="Parse.html#4334" class="Bound">t</a> <a id="4336" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="4338" class="Symbol">(</a><a id="4339" href="Parse.html#4339" class="Bound">p</a> <a id="4341" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="4343" class="Symbol">_))</a> <a id="4347" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="4349" href="Parse.html#4349" class="Bound">σ</a><a id="4350" class="Symbol">)</a> <a id="4352" class="Symbol">→</a> <a id="4354" href="Parse.html#4339" class="Bound">p</a> <a id="4356" href="Language.html#4878" class="InductiveConstructor Operator">&gt;</a> <a id="4358" href="Parse.html#4334" class="Bound">t</a> <a id="4360" href="Language.html#4878" class="InductiveConstructor Operator">`∶</a> <a id="4363" href="Parse.html#4349" class="Bound">σ</a><a id="4364" class="Symbol">)</a>
               <a id="4381" href="Text.Parser.Combinators.html#2211" class="Function Operator">&lt;$&gt;</a> <a id="4385" class="Symbol">(</a><a id="4386" href="Parse.html#3342" class="Function">theTok</a> <a id="4393" href="Parse.html#1338" class="InductiveConstructor">LPAR</a>
                <a id="4414" href="Text.Parser.Combinators.html#3349" class="Function Operator">&amp;&gt;</a> <a id="4417" href="Parse.html#4184" class="Bound">□check</a> <a id="4424" href="Text.Parser.Combinators.html#3176" class="Function Operator">&lt;&amp;&gt;</a> <a id="4428" href="Text.Parser.Combinators.html#1904" class="Function">box</a> <a id="4432" class="Symbol">(</a><a id="4433" href="Parse.html#3342" class="Function">theTok</a> <a id="4440" href="Parse.html#1343" class="InductiveConstructor">COL</a><a id="4443" class="Symbol">)</a> <a id="4445" href="Text.Parser.Combinators.html#3176" class="Function Operator">&lt;&amp;&gt;</a> <a id="4449" href="Text.Parser.Combinators.html#1904" class="Function">box</a> <a id="4453" class="Symbol">(</a><a id="4454" href="Text.Parser.Monad.html#3730" class="Function">commit</a> <a id="4461" href="Parse.html#3685" class="Function">type</a><a id="4465" class="Symbol">)</a>
               <a id="4482" href="Text.Parser.Combinators.html#3264" class="Function Operator">&lt;&amp;</a> <a id="4485" href="Text.Parser.Combinators.html#1904" class="Function">box</a> <a id="4489" class="Symbol">(</a><a id="4490" href="Parse.html#3342" class="Function">theTok</a> <a id="4497" href="Parse.html#1347" class="InductiveConstructor">RPAR</a><a id="4501" class="Symbol">))</a>
      <a id="4510" href="Parse.html#4510" class="Bound">app</a>    <a id="4517" class="Symbol">=</a> <a id="4519" class="Symbol">(λ</a> <a id="4522" class="Keyword">where</a> <a id="4528" class="Symbol">(</a><a id="4529" href="Parse.html#4529" class="Bound">p</a> <a id="4531" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="4533" href="Parse.html#4533" class="Bound">c</a><a id="4534" class="Symbol">)</a> <a id="4536" href="Parse.html#4536" class="Bound">e</a> <a id="4538" class="Symbol">→</a> <a id="4540" href="Parse.html#4529" class="Bound">p</a> <a id="4542" href="Language.html#4984" class="InductiveConstructor Operator">&gt;</a> <a id="4544" href="Parse.html#4536" class="Bound">e</a> <a id="4546" href="Language.html#4984" class="InductiveConstructor Operator">`$</a> <a id="4549" href="Parse.html#4533" class="Bound">c</a><a id="4550" class="Symbol">)</a> <a id="4552" href="Text.Parser.Combinators.html#2211" class="Function Operator">&lt;$&gt;</a>
                <a id="4572" class="Symbol">(</a><a id="4573" href="Text.Parser.Monad.html#2552" class="Function">getPosition</a> <a id="4585" href="Text.Parser.Combinators.html#5042" class="Function Operator">&lt;M&amp;&gt;</a> <a id="4590" class="Symbol">((</a><a id="4592" href="Data.Product.html#3500" class="Function">uncurry</a> <a id="4600" href="Language.html#5296" class="InductiveConstructor Operator">_&gt;`-_</a> <a id="4606" href="Text.Parser.Combinators.html#2211" class="Function Operator">&lt;$&gt;</a> <a id="4610" class="Symbol">(</a><a id="4611" href="Text.Parser.Monad.html#2552" class="Function">getPosition</a> <a id="4623" href="Text.Parser.Combinators.html#5042" class="Function Operator">&lt;M&amp;&gt;</a> <a id="4628" href="Parse.html#4250" class="Bound">var</a><a id="4631" class="Symbol">))</a>
                              <a id="4664" href="Text.Parser.Combinators.html#2038" class="Function Operator">&lt;|&gt;</a> <a id="4668" href="Parse.html#3585" class="Function">parens</a> <a id="4675" href="Parse.html#4184" class="Bound">□check</a><a id="4681" class="Symbol">))</a>
      <a id="4690" href="Parse.html#4690" class="Bound">infer</a>  <a id="4697" class="Symbol">=</a> <a id="4699" href="Text.Parser.Combinators.html#6437" class="Function">iterate</a> <a id="4707" class="Symbol">(</a><a id="4708" href="Parse.html#4250" class="Bound">var</a> <a id="4712" href="Text.Parser.Combinators.html#2038" class="Function Operator">&lt;|&gt;</a> <a id="4716" href="Parse.html#4314" class="Bound">cut</a> <a id="4720" href="Text.Parser.Combinators.html#2038" class="Function Operator">&lt;|&gt;</a> <a id="4724" href="Parse.html#3585" class="Function">parens</a> <a id="4731" class="Symbol">(</a><a id="4732" href="Induction.Nat.Strong.html#341" class="Function">INS.map</a> <a id="4740" href="Text.Parser.Monad.html#3730" class="Function">commit</a> <a id="4747" href="Parse.html#4217" class="Bound">□infer</a><a id="4753" class="Symbol">))</a>
                       <a id="4779" class="Symbol">(</a><a id="4780" href="Text.Parser.Combinators.html#1904" class="Function">box</a> <a id="4784" href="Parse.html#4510" class="Bound">app</a><a id="4787" class="Symbol">)</a>
      <a id="4795" href="Parse.html#4795" class="Bound">lam</a>    <a id="4802" class="Symbol">=</a> <a id="4804" class="Symbol">(λ</a> <a id="4807" class="Keyword">where</a> <a id="4813" class="Symbol">((</a><a id="4815" href="Parse.html#4815" class="Bound">p</a> <a id="4817" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="4819" href="Parse.html#4819" class="Bound">x</a><a id="4820" class="Symbol">)</a> <a id="4822" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="4824" href="Parse.html#4824" class="Bound">c</a><a id="4825" class="Symbol">)</a> <a id="4827" class="Symbol">→</a> <a id="4829" href="Parse.html#4815" class="Bound">p</a> <a id="4831" href="Language.html#5411" class="InductiveConstructor Operator">&gt;`λ</a> <a id="4835" href="Parse.html#4819" class="Bound">x</a> <a id="4837" href="Language.html#5411" class="InductiveConstructor Operator">↦</a> <a id="4839" href="Parse.html#4824" class="Bound">c</a><a id="4840" class="Symbol">)</a>
               <a id="4857" href="Text.Parser.Combinators.html#2211" class="Function Operator">&lt;$&gt;</a> <a id="4861" class="Symbol">(</a><a id="4862" href="Parse.html#3342" class="Function">theTok</a> <a id="4869" href="Parse.html#1316" class="InductiveConstructor">LAM</a> <a id="4873" href="Text.Parser.Combinators.html#3349" class="Function Operator">&amp;&gt;</a> <a id="4876" href="Text.Parser.Combinators.html#1904" class="Function">box</a> <a id="4880" class="Symbol">(</a><a id="4881" href="Text.Parser.Monad.html#2552" class="Function">getPosition</a> <a id="4893" href="Text.Parser.Combinators.html#5042" class="Function Operator">&lt;M&amp;&gt;</a> <a id="4898" href="Parse.html#3495" class="Function">name</a><a id="4902" class="Symbol">)</a>
               <a id="4919" href="Text.Parser.Combinators.html#3176" class="Function Operator">&lt;&amp;&gt;</a> <a id="4923" href="Text.Parser.Combinators.html#1904" class="Function">box</a> <a id="4927" class="Symbol">(</a><a id="4928" href="Parse.html#3342" class="Function">theTok</a> <a id="4935" href="Parse.html#1320" class="InductiveConstructor">DOT</a> <a id="4939" href="Text.Parser.Combinators.html#3349" class="Function Operator">&amp;&gt;</a> <a id="4942" href="Induction.Nat.Strong.html#341" class="Function">INS.map</a> <a id="4950" href="Text.Parser.Monad.html#3730" class="Function">commit</a> <a id="4957" href="Parse.html#4184" class="Bound">□check</a><a id="4963" class="Symbol">))</a>
      <a id="4972" href="Parse.html#4972" class="Bound">letin</a>  <a id="4979" class="Symbol">=</a> <a id="4981" class="Symbol">(λ</a> <a id="4984" class="Keyword">where</a> <a id="4990" class="Symbol">(((</a><a id="4993" href="Parse.html#4993" class="Bound">p</a> <a id="4995" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="4997" href="Parse.html#4997" class="Bound">x</a><a id="4998" class="Symbol">)</a> <a id="5000" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="5002" href="Parse.html#5002" class="Bound">e</a><a id="5003" class="Symbol">)</a> <a id="5005" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="5007" href="Parse.html#5007" class="Bound">c</a><a id="5008" class="Symbol">)</a> <a id="5010" class="Symbol">→</a> <a id="5012" href="Parse.html#4993" class="Bound">p</a> <a id="5014" href="Language.html#5537" class="InductiveConstructor Operator">&gt;`let</a> <a id="5020" href="Parse.html#4997" class="Bound">x</a> <a id="5022" href="Language.html#5537" class="InductiveConstructor Operator">↦</a> <a id="5024" href="Parse.html#5002" class="Bound">e</a> <a id="5026" href="Language.html#5537" class="InductiveConstructor Operator">`in</a> <a id="5030" href="Parse.html#5007" class="Bound">c</a><a id="5031" class="Symbol">)</a>
               <a id="5048" href="Text.Parser.Combinators.html#2211" class="Function Operator">&lt;$&gt;</a> <a id="5052" class="Symbol">(</a><a id="5053" href="Parse.html#3342" class="Function">theTok</a> <a id="5060" href="Parse.html#1294" class="InductiveConstructor">LET</a> <a id="5064" href="Text.Parser.Combinators.html#3349" class="Function Operator">&amp;&gt;</a> <a id="5067" href="Text.Parser.Combinators.html#1904" class="Function">box</a> <a id="5071" class="Symbol">(</a><a id="5072" href="Text.Parser.Monad.html#2552" class="Function">getPosition</a> <a id="5084" href="Text.Parser.Combinators.html#5042" class="Function Operator">&lt;M&amp;&gt;</a> <a id="5089" href="Parse.html#3495" class="Function">name</a><a id="5093" class="Symbol">)</a>
               <a id="5110" href="Text.Parser.Combinators.html#3176" class="Function Operator">&lt;&amp;&gt;</a> <a id="5114" href="Text.Parser.Combinators.html#1904" class="Function">box</a> <a id="5118" class="Symbol">(</a><a id="5119" href="Parse.html#3342" class="Function">theTok</a> <a id="5126" href="Parse.html#1298" class="InductiveConstructor">EQ</a> <a id="5129" href="Text.Parser.Combinators.html#3349" class="Function Operator">&amp;&gt;</a> <a id="5132" href="Induction.Nat.Strong.html#341" class="Function">INS.map</a> <a id="5140" href="Text.Parser.Monad.html#3730" class="Function">commit</a> <a id="5147" href="Parse.html#4217" class="Bound">□infer</a><a id="5153" class="Symbol">)</a>
               <a id="5170" href="Text.Parser.Combinators.html#3176" class="Function Operator">&lt;&amp;&gt;</a> <a id="5174" href="Text.Parser.Combinators.html#1904" class="Function">box</a> <a id="5178" class="Symbol">(</a><a id="5179" href="Parse.html#3342" class="Function">theTok</a> <a id="5186" href="Parse.html#1301" class="InductiveConstructor">IN</a> <a id="5189" href="Text.Parser.Combinators.html#3349" class="Function Operator">&amp;&gt;</a> <a id="5192" href="Induction.Nat.Strong.html#341" class="Function">INS.map</a> <a id="5200" href="Text.Parser.Monad.html#3730" class="Function">commit</a> <a id="5207" href="Parse.html#4184" class="Bound">□check</a><a id="5213" class="Symbol">)</a>
               <a id="5230" class="Symbol">)</a>
      <a id="5238" href="Parse.html#5238" class="Bound">emb</a>    <a id="5245" class="Symbol">=</a> <a id="5247" href="Data.Product.html#3500" class="Function">uncurry</a> <a id="5255" href="Language.html#5296" class="InductiveConstructor Operator">_&gt;`-_</a> <a id="5261" href="Text.Parser.Combinators.html#2211" class="Function Operator">&lt;$&gt;</a> <a id="5265" class="Symbol">(</a><a id="5266" href="Text.Parser.Monad.html#2552" class="Function">getPosition</a> <a id="5278" href="Text.Parser.Combinators.html#5042" class="Function Operator">&lt;M&amp;&gt;</a> <a id="5283" href="Parse.html#4690" class="Bound">infer</a><a id="5288" class="Symbol">)</a>
      <a id="5296" href="Parse.html#5296" class="Bound">check</a>  <a id="5303" class="Symbol">=</a> <a id="5305" href="Parse.html#4795" class="Bound">lam</a> <a id="5309" href="Text.Parser.Combinators.html#2038" class="Function Operator">&lt;|&gt;</a> <a id="5313" href="Parse.html#4972" class="Bound">letin</a> <a id="5319" href="Text.Parser.Combinators.html#2038" class="Function Operator">&lt;|&gt;</a> <a id="5323" href="Parse.html#5238" class="Bound">emb</a>
  <a id="5329" class="Keyword">in</a> <a id="5332" class="Keyword">record</a> <a id="5339" class="Symbol">{</a> <a id="5341" class="Field">infer</a> <a id="5347" class="Symbol">=</a> <a id="5349" href="Parse.html#4690" class="Bound">infer</a> <a id="5355" href="Text.Parser.Combinators.html#2038" class="Function Operator">&lt;|&gt;</a> <a id="5359" href="Parse.html#3585" class="Function">parens</a> <a id="5366" class="Symbol">(</a><a id="5367" href="Induction.Nat.Strong.html#341" class="Function">INS.map</a> <a id="5375" href="Text.Parser.Monad.html#3730" class="Function">commit</a> <a id="5382" href="Parse.html#4217" class="Bound">□infer</a><a id="5388" class="Symbol">)</a>
            <a id="5402" class="Symbol">;</a> <a id="5404" class="Field">check</a> <a id="5410" class="Symbol">=</a> <a id="5412" href="Parse.html#5296" class="Bound">check</a> <a id="5418" href="Text.Parser.Combinators.html#2038" class="Function Operator">&lt;|&gt;</a> <a id="5422" href="Parse.html#3585" class="Function">parens</a> <a id="5429" class="Symbol">(</a><a id="5430" href="Induction.Nat.Strong.html#341" class="Function">INS.map</a> <a id="5438" href="Text.Parser.Monad.html#3730" class="Function">commit</a> <a id="5445" href="Parse.html#4184" class="Bound">□check</a><a id="5451" class="Symbol">)</a>
            <a id="5465" class="Symbol">}</a>

<a id="parse"></a><a id="5468" href="Parse.html#5468" class="Function">parse</a> <a id="5474" class="Symbol">:</a> <a id="5476" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="5483" class="Symbol">→</a> <a id="5485" href="Types.html#574" class="Function">Types.Result</a> <a id="5498" class="Symbol">(</a><a id="5499" href="Language.html#2443" class="Function">Parsed</a> <a id="5506" href="Language.html#775" class="InductiveConstructor">Infer</a><a id="5511" class="Symbol">)</a>
<a id="5513" href="Parse.html#5468" class="Function">parse</a> <a id="5519" href="Parse.html#5519" class="Bound">str</a> <a id="5523" class="Symbol">=</a> <a id="5525" href="Text.Parser.Monad.html#760" class="Function">result</a> <a id="5532" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a> <a id="5537" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a> <a id="5542" class="Symbol">(</a><a id="5543" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a> <a id="5548" href="Function.html#994" class="Function Operator">∘′</a> <a id="5551" href="Text.Parser.Types.html#925" class="Field">Success.value</a> <a id="5565" href="Function.html#994" class="Function Operator">∘′</a> <a id="5568" href="Agda.Builtin.Sigma.html#155" class="Field">proj₁</a><a id="5573" class="Symbol">)</a>
   <a id="5578" href="Function.html#2024" class="Function Operator">$′</a> <a id="5581" href="Text.Parser.Types.html#1300" class="Field">runParser</a> <a id="5591" class="Symbol">(</a><a id="5592" href="Parse.html#4003" class="Field">infer</a> <a id="5598" href="Parse.html#4099" class="Function">bidirectional</a><a id="5611" class="Symbol">)</a> <a id="5613" href="Data.Nat.Properties.html#2969" class="Function">≤-refl</a> <a id="5620" href="Parse.html#5653" class="Function">input</a> <a id="5626" class="Symbol">(</a><a id="5627" href="Text.Parser.Position.html#409" class="Function">start</a> <a id="5633" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="5635" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a><a id="5637" class="Symbol">)</a>
   <a id="5642" class="Keyword">where</a>
     <a id="5653" href="Parse.html#5653" class="Function">input</a> <a id="5659" class="Symbol">=</a> <a id="5661" href="Data.Vec.html#7639" class="Function">Vec.fromList</a> <a id="5674" href="Function.html#1927" class="Function Operator">$</a> <a id="5676" href="Parse.html#1740" class="Function">tokenize</a> <a id="5685" href="Function.html#2024" class="Function Operator">$′</a> <a id="5688" href="Data.String.Base.html#905" class="Function">String.toList</a> <a id="5702" href="Parse.html#5519" class="Bound">str</a>
     <a id="5711" class="Keyword">module</a> <a id="M"></a><a id="5718" href="Parse.html#5718" class="Module">M</a> <a id="5720" class="Symbol">=</a> <a id="5722" href="Category.Monad.html#810" class="Module">RawMonad</a> <a id="5731" href="Text.Parser.Monad.html#1947" class="Function">ParserM.monad</a>

<a id="5746" class="Keyword">open</a> <a id="5751" class="Keyword">import</a> <a id="5758" href="Agda.Builtin.Equality.html" class="Module">Agda.Builtin.Equality</a>

<a id="5781" class="Comment">{-
_ : tokenize (String.toList &quot;(λ x . 1 : `a → `a)&quot;)
    ≡ (0 ∶ 0  , LPAR)
    ∷ (0 ∶ 1  , LAM)
    ∷ (0 ∶ 3  , ID &quot;x&quot;)
    ∷ (0 ∶ 5  , DOT)
    ∷ (0 ∶ 7  , ID &quot;1&quot;)
    ∷ (0 ∶ 9  , COL)
    ∷ (0 ∶ 11 , ID &quot;`a&quot;)
    ∷ (0 ∶ 14 , ARR)
    ∷ (0 ∶ 16 , ID &quot;`a&quot;)
    ∷ (0 ∶ 18 , RPAR)
    ∷ []
_ = refl

_ : parse &quot;(λ x . 1 : `a → `a)&quot; ≡ inj₁ At 0 ∶ 7 ParseError
_ = refl

_ : tokenize (String.toList &quot;(λ x . x : `a → `a)&quot;)
    ≡ (start , LPAR)
    ∷ (0 ∶ 1 , LAM)
    ∷ (0 ∶ 3 , ID &quot;x&quot;)
    ∷ (0 ∶ 5 , DOT)
    ∷ (0 ∶ 7 , ID &quot;x&quot;)
    ∷ (0 ∶ 9 , COL)
    ∷ (0 ∶ 11 , ID &quot;`a&quot;)
    ∷ (0 ∶ 14 , ARR)
    ∷ (0 ∶ 16 , ID &quot;`a&quot;)
    ∷ (0 ∶ 18 , RPAR)
    ∷ []
_ = refl

_ : parse &quot;(λ x . x : `a → `a)&quot;
    ≡ inj₂ (_ &gt; _ &gt;`λ &quot;x&quot; ↦ (_ &gt;`- `var &quot;x&quot;) `∶ (α &quot;a&quot; ⇒ α &quot;a&quot;))
_ = refl

_ : parse &quot;(let x = (λf.f : `a → `a) in x : `a → `a)&quot;
    ≡ inj₂ (_ &gt;
      _ &gt;`let &quot;x&quot; ↦ _ &gt; _ &gt;`λ &quot;f&quot; ↦ (_ &gt;`- (`var &quot;f&quot;))
                     `∶ (α &quot;a&quot; ⇒ α &quot;a&quot;)
         `in (_ &gt;`- `var &quot;x&quot;) `∶ ?)
_ = refl
-}</a>
</pre></body></html>