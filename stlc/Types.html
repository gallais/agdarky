<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Types</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="Types.html" class="Module">Types</a> <a id="14" class="Keyword">where</a>

<a id="21" class="Keyword">import</a> <a id="28" href="Level.html" class="Module">Level</a> <a id="34" class="Symbol">as</a> <a id="37" class="Module">L</a>
<a id="39" class="Keyword">open</a> <a id="44" class="Keyword">import</a> <a id="51" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="66" class="Keyword">open</a> <a id="71" class="Keyword">import</a> <a id="78" href="Category.Monad.State.html" class="Module">Category.Monad.State</a>
<a id="99" class="Keyword">open</a> <a id="104" class="Keyword">import</a> <a id="111" href="Data.String.html" class="Module">Data.String</a> <a id="123" class="Symbol">as</a> <a id="126" class="Module">String</a> <a id="133" class="Keyword">using</a> <a id="139" class="Symbol">(</a><a id="140" href="Agda.Builtin.String.html#165" class="Postulate">String</a><a id="146" class="Symbol">;</a> <a id="148" href="Data.String.Base.html#1125" class="Function Operator">_++_</a><a id="152" class="Symbol">)</a>
<a id="154" class="Keyword">import</a> <a id="161" href="Data.String.Unsafe.html" class="Module">Data.String.Unsafe</a> <a id="180" class="Symbol">as</a> <a id="183" class="Module">String</a>
<a id="190" class="Keyword">open</a> <a id="195" class="Keyword">import</a> <a id="202" href="Data.Product.html" class="Module">Data.Product</a> <a id="215" class="Symbol">as</a> <a id="218" class="Module">Prod</a> <a id="223" class="Keyword">using</a> <a id="229" class="Symbol">(</a><a id="230" href="Data.Product.html#1389" class="Function Operator">_×_</a><a id="233" class="Symbol">;</a> <a id="235" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">_,_</a><a id="238" class="Symbol">;</a> <a id="240" href="Agda.Builtin.Sigma.html#155" class="Field">proj₁</a><a id="245" class="Symbol">)</a>
<a id="247" class="Keyword">open</a> <a id="252" class="Keyword">import</a> <a id="259" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="274" class="Keyword">using</a> <a id="280" class="Symbol">(</a><a id="281" href="Data.List.Base.html#9863" class="InductiveConstructor">[]</a><a id="283" class="Symbol">)</a>
<a id="285" class="Keyword">open</a> <a id="290" class="Keyword">import</a> <a id="297" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="306" class="Symbol">as</a> <a id="309" class="Module">ℕ</a> <a id="311" class="Keyword">using</a> <a id="317" class="Symbol">(</a><a id="318" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="319" class="Symbol">)</a>
<a id="321" class="Keyword">open</a> <a id="326" class="Keyword">import</a> <a id="333" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="349" class="Keyword">using</a> <a id="355" class="Symbol">(</a><a id="356" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a><a id="361" class="Symbol">;</a> <a id="363" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a><a id="367" class="Symbol">;</a> <a id="369" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a><a id="376" class="Symbol">;</a> <a id="378" href="Data.Maybe.Base.html#1618" class="Function">maybe′</a><a id="384" class="Symbol">)</a>
<a id="386" class="Keyword">import</a> <a id="393" href="Data.Maybe.Categorical.html" class="Module">Data.Maybe.Categorical</a> <a id="416" class="Symbol">as</a> <a id="419" class="Module">MC</a>
<a id="422" class="Keyword">open</a> <a id="427" class="Keyword">import</a> <a id="434" href="Data.Sum.Base.html" class="Module">Data.Sum.Base</a> <a id="448" class="Symbol">as</a> <a id="451" class="Module">Sum</a>
<a id="455" class="Keyword">import</a> <a id="462" href="Data.Sum.Categorical.Left.html" class="Module">Data.Sum.Categorical.Left</a> <a id="488" class="Symbol">as</a> <a id="491" class="Module">Sumₗ</a>
<a id="496" class="Keyword">open</a> <a id="501" class="Keyword">import</a> <a id="508" href="Function.html" class="Module">Function</a>

<a id="518" class="Keyword">open</a> <a id="523" class="Keyword">import</a> <a id="530" href="Text.Parser.Position.html" class="Module">Text.Parser.Position</a> <a id="551" class="Symbol">as</a> <a id="554" class="Module">Position</a> <a id="563" class="Keyword">using</a> <a id="569" class="Symbol">(</a><a id="570" href="Text.Parser.Position.html#310" class="Record">Position</a><a id="578" class="Symbol">)</a>

<a id="581" class="Keyword">open</a> <a id="586" class="Keyword">import</a> <a id="593" href="Language.html" class="Module">Language</a> <a id="602" class="Keyword">hiding</a> <a id="609" class="Symbol">(</a><a id="610" href="Language.html#875" class="Function">show</a><a id="614" class="Symbol">)</a>

<a id="617" class="Comment">--------------------------------------------------------------------------------</a>
<a id="698" class="Comment">-- Error type</a>

<a id="713" class="Keyword">data</a> <a id="Error"></a><a id="718" href="Types.html#718" class="Datatype">Error</a> <a id="724" class="Symbol">(</a><a id="725" href="Types.html#725" class="Bound">A</a> <a id="727" class="Symbol">:</a> <a id="729" class="PrimitiveType">Set</a><a id="732" class="Symbol">)</a> <a id="734" class="Symbol">:</a> <a id="736" class="PrimitiveType">Set</a> <a id="740" class="Keyword">where</a>
  <a id="Error.At_ParseError"></a><a id="748" href="Types.html#748" class="InductiveConstructor Operator">At_ParseError</a>             <a id="774" class="Symbol">:</a> <a id="776" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="785" class="Symbol">→</a> <a id="787" href="Types.html#718" class="Datatype">Error</a> <a id="793" href="Types.html#725" class="Bound">A</a>
  <a id="Error.At_OutOfScope_"></a><a id="797" href="Types.html#797" class="InductiveConstructor Operator">At_OutOfScope_</a>            <a id="823" class="Symbol">:</a> <a id="825" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="834" class="Symbol">→</a> <a id="836" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="843" class="Symbol">→</a> <a id="845" href="Types.html#718" class="Datatype">Error</a> <a id="851" href="Types.html#725" class="Bound">A</a>
  <a id="Error.At_Expected_Got_"></a><a id="855" href="Types.html#855" class="InductiveConstructor Operator">At_Expected_Got_</a>          <a id="881" class="Symbol">:</a> <a id="883" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="892" class="Symbol">→</a> <a id="894" href="Language.html#764" class="Datatype">Type</a> <a id="899" href="Types.html#725" class="Bound">A</a> <a id="901" class="Symbol">→</a> <a id="903" href="Language.html#764" class="Datatype">Type</a> <a id="908" href="Types.html#725" class="Bound">A</a> <a id="910" class="Symbol">→</a> <a id="912" href="Types.html#718" class="Datatype">Error</a> <a id="918" href="Types.html#725" class="Bound">A</a>
  <a id="Error.At_NotAnArrow_"></a><a id="922" href="Types.html#922" class="InductiveConstructor Operator">At_NotAnArrow_</a>            <a id="948" class="Symbol">:</a> <a id="950" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="959" class="Symbol">→</a> <a id="961" href="Language.html#764" class="Datatype">Type</a> <a id="966" href="Types.html#725" class="Bound">A</a> <a id="968" class="Symbol">→</a> <a id="970" href="Types.html#718" class="Datatype">Error</a> <a id="976" href="Types.html#725" class="Bound">A</a>
  <a id="Error.At_NotAProduct_"></a><a id="980" href="Types.html#980" class="InductiveConstructor Operator">At_NotAProduct_</a>           <a id="1006" class="Symbol">:</a> <a id="1008" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="1017" class="Symbol">→</a> <a id="1019" href="Language.html#764" class="Datatype">Type</a> <a id="1024" href="Types.html#725" class="Bound">A</a> <a id="1026" class="Symbol">→</a> <a id="1028" href="Types.html#718" class="Datatype">Error</a> <a id="1034" href="Types.html#725" class="Bound">A</a>
  <a id="Error.At_ErrorWhenPrintingError"></a><a id="1038" href="Types.html#1038" class="InductiveConstructor Operator">At_ErrorWhenPrintingError</a> <a id="1064" class="Symbol">:</a> <a id="1066" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="1075" class="Symbol">→</a> <a id="1077" href="Types.html#718" class="Datatype">Error</a> <a id="1083" href="Types.html#725" class="Bound">A</a>

<a id="show"></a><a id="1086" href="Types.html#1086" class="Function">show</a> <a id="1091" class="Symbol">:</a> <a id="1093" href="Types.html#718" class="Datatype">Error</a> <a id="1099" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1106" class="Symbol">→</a> <a id="1108" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
<a id="1115" href="Types.html#1086" class="Function">show</a> <a id="1120" href="Types.html#1120" class="Bound">err</a> <a id="1124" class="Symbol">=</a> <a id="1126" href="Function.html#3533" class="Function Operator">case</a> <a id="1131" href="Types.html#1120" class="Bound">err</a> <a id="1135" href="Function.html#3533" class="Function Operator">of</a> <a id="1138" class="Symbol">λ</a> <a id="1140" class="Keyword">where</a>
  <a id="1148" class="Symbol">(</a><a id="1149" href="Types.html#748" class="InductiveConstructor Operator">At</a> <a id="1152" href="Types.html#1152" class="Bound">p</a> <a id="1154" href="Types.html#748" class="InductiveConstructor Operator">ParseError</a><a id="1164" class="Symbol">)</a>             <a id="1178" class="Symbol">→</a> <a id="1180" href="Types.html#1717" class="Function">at</a> <a id="1183" href="Types.html#1152" class="Bound">p</a> <a id="1185" class="String">&quot;parse error.&quot;</a>
  <a id="1202" class="Symbol">(</a><a id="1203" href="Types.html#797" class="InductiveConstructor Operator">At</a> <a id="1206" href="Types.html#1206" class="Bound">p</a> <a id="1208" href="Types.html#797" class="InductiveConstructor Operator">OutOfScope</a> <a id="1219" href="Types.html#1219" class="Bound">x</a><a id="1220" class="Symbol">)</a>           <a id="1232" class="Symbol">→</a> <a id="1234" href="Types.html#1717" class="Function">at</a> <a id="1237" href="Types.html#1206" class="Bound">p</a> <a id="1239" href="Function.html#1927" class="Function Operator">$</a> <a id="1241" href="Types.html#1219" class="Bound">x</a> <a id="1243" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1246" class="String">&quot; is out of scope.&quot;</a>
  <a id="1268" class="Symbol">(</a><a id="1269" href="Types.html#855" class="InductiveConstructor Operator">At</a> <a id="1272" href="Types.html#1272" class="Bound">p</a> <a id="1274" href="Types.html#855" class="InductiveConstructor Operator">Expected</a> <a id="1283" href="Types.html#1283" class="Bound">σ</a> <a id="1285" href="Types.html#855" class="InductiveConstructor Operator">Got</a> <a id="1289" href="Types.html#1289" class="Bound">τ</a><a id="1290" class="Symbol">)</a>       <a id="1298" class="Symbol">→</a> <a id="1300" href="Types.html#1717" class="Function">at</a> <a id="1303" href="Types.html#1272" class="Bound">p</a> <a id="1305" href="Function.html#1927" class="Function Operator">$</a> <a id="1307" class="String">&quot;expected type &quot;</a> <a id="1324" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1327" href="Language.html#875" class="Function">Language.show</a> <a id="1341" href="Types.html#1283" class="Bound">σ</a>
                                      <a id="1381" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1384" class="String">&quot; but got type &quot;</a> <a id="1401" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1404" href="Language.html#875" class="Function">Language.show</a> <a id="1418" href="Types.html#1289" class="Bound">τ</a> <a id="1420" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1423" class="String">&quot; instead.&quot;</a>
  <a id="1437" class="Symbol">(</a><a id="1438" href="Types.html#922" class="InductiveConstructor Operator">At</a> <a id="1441" href="Types.html#1441" class="Bound">p</a> <a id="1443" href="Types.html#922" class="InductiveConstructor Operator">NotAnArrow</a> <a id="1454" href="Types.html#1454" class="Bound">σ</a><a id="1455" class="Symbol">)</a>           <a id="1467" class="Symbol">→</a> <a id="1469" href="Types.html#1717" class="Function">at</a> <a id="1472" href="Types.html#1441" class="Bound">p</a> <a id="1474" href="Function.html#1927" class="Function Operator">$</a> <a id="1476" class="String">&quot;the type &quot;</a> <a id="1488" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1491" href="Language.html#875" class="Function">Language.show</a> <a id="1505" href="Types.html#1454" class="Bound">σ</a> <a id="1507" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1510" class="String">&quot; is not an arrow type.&quot;</a>
  <a id="1537" class="Symbol">(</a><a id="1538" href="Types.html#980" class="InductiveConstructor Operator">At</a> <a id="1541" href="Types.html#1541" class="Bound">p</a> <a id="1543" href="Types.html#980" class="InductiveConstructor Operator">NotAProduct</a> <a id="1555" href="Types.html#1555" class="Bound">σ</a><a id="1556" class="Symbol">)</a>          <a id="1567" class="Symbol">→</a> <a id="1569" href="Types.html#1717" class="Function">at</a> <a id="1572" href="Types.html#1541" class="Bound">p</a> <a id="1574" href="Function.html#1927" class="Function Operator">$</a> <a id="1576" class="String">&quot;the type &quot;</a> <a id="1588" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1591" href="Language.html#875" class="Function">Language.show</a> <a id="1605" href="Types.html#1555" class="Bound">σ</a> <a id="1607" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1610" class="String">&quot; is not a product type.&quot;</a>
  <a id="1638" class="Symbol">(</a><a id="1639" href="Types.html#1038" class="InductiveConstructor Operator">At</a> <a id="1642" href="Types.html#1642" class="Bound">p</a> <a id="1644" href="Types.html#1038" class="InductiveConstructor Operator">ErrorWhenPrintingError</a><a id="1666" class="Symbol">)</a> <a id="1668" class="Symbol">→</a> <a id="1670" href="Types.html#1717" class="Function">at</a> <a id="1673" href="Types.html#1642" class="Bound">p</a> <a id="1675" href="Function.html#1927" class="Function Operator">$</a> <a id="1677" class="String">&quot;error when printing error.&quot;</a>

    <a id="1711" class="Keyword">where</a> <a id="1717" href="Types.html#1717" class="Function">at</a> <a id="1720" class="Symbol">:</a> <a id="1722" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="1731" class="Symbol">→</a> <a id="1733" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1740" class="Symbol">→</a> <a id="1742" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
          <a id="1759" href="Types.html#1717" class="Function">at</a> <a id="1762" href="Types.html#1762" class="Bound">p</a> <a id="1764" href="Types.html#1764" class="Bound">str</a> <a id="1768" class="Symbol">=</a> <a id="1770" class="String">&quot;At &quot;</a> <a id="1776" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1779" href="Text.Parser.Position.html#710" class="Function">Position.show</a> <a id="1793" href="Types.html#1762" class="Bound">p</a> <a id="1795" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1798" class="String">&quot;: &quot;</a> <a id="1803" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1806" href="Types.html#1764" class="Bound">str</a>

<a id="Result"></a><a id="1811" href="Types.html#1811" class="Function">Result</a> <a id="1818" class="Symbol">:</a> <a id="1820" class="PrimitiveType">Set</a> <a id="1824" class="Symbol">→</a> <a id="1826" class="PrimitiveType">Set</a> <a id="1830" class="Symbol">→</a> <a id="1832" class="PrimitiveType">Set</a>
<a id="1836" href="Types.html#1811" class="Function">Result</a> <a id="1843" href="Types.html#1843" class="Bound">E</a> <a id="1845" class="Symbol">=</a> <a id="1847" href="Data.Sum.Categorical.Left.html#835" class="Function">Sumₗ.Sumₗ</a> <a id="1857" class="Symbol">(</a><a id="1858" href="Types.html#718" class="Datatype">Error</a> <a id="1864" href="Types.html#1843" class="Bound">E</a><a id="1865" class="Symbol">)</a> <a id="1867" href="Agda.Primitive.html#611" class="Primitive">L.zero</a>

<a id="1875" class="Keyword">module</a> <a id="Result"></a><a id="1882" href="Types.html#1882" class="Module">Result</a> <a id="1889" class="Keyword">where</a>

  <a id="Result.monad"></a><a id="1898" href="Types.html#1898" class="Function">monad</a> <a id="1904" class="Symbol">:</a> <a id="1906" class="Symbol">∀</a> <a id="1908" href="Types.html#1908" class="Bound">E</a> <a id="1910" class="Symbol">→</a> <a id="1912" href="Category.Monad.html#396" class="Function">RawMonad</a> <a id="1921" class="Symbol">(</a><a id="1922" href="Types.html#1811" class="Function">Result</a> <a id="1929" href="Types.html#1908" class="Bound">E</a><a id="1930" class="Symbol">)</a>
  <a id="1934" href="Types.html#1898" class="Function">monad</a> <a id="1940" href="Types.html#1940" class="Bound">E</a> <a id="1942" class="Symbol">=</a> <a id="1944" href="Data.Sum.Categorical.Left.html#1296" class="Function">Sumₗ.monad</a> <a id="1955" class="Symbol">(</a><a id="1956" href="Types.html#718" class="Datatype">Error</a> <a id="1962" href="Types.html#1940" class="Bound">E</a><a id="1963" class="Symbol">)</a> <a id="1965" href="Agda.Primitive.html#611" class="Primitive">L.zero</a>

  <a id="Result.fail"></a><a id="1975" href="Types.html#1975" class="Function">fail</a> <a id="1980" class="Symbol">:</a> <a id="1982" class="Symbol">∀</a> <a id="1984" class="Symbol">{</a><a id="1985" href="Types.html#1985" class="Bound">E</a> <a id="1987" href="Types.html#1987" class="Bound">A</a><a id="1988" class="Symbol">}</a> <a id="1990" class="Symbol">→</a> <a id="1992" href="Types.html#718" class="Datatype">Error</a> <a id="1998" href="Types.html#1985" class="Bound">E</a> <a id="2000" class="Symbol">→</a> <a id="2002" href="Types.html#1811" class="Function">Result</a> <a id="2009" href="Types.html#1985" class="Bound">E</a> <a id="2011" href="Types.html#1987" class="Bound">A</a>
  <a id="2015" href="Types.html#1975" class="Function">fail</a> <a id="2020" class="Symbol">=</a> <a id="2022" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a>

  <a id="Result.fromMaybe"></a><a id="2030" href="Types.html#2030" class="Function">fromMaybe</a> <a id="2040" class="Symbol">:</a> <a id="2042" class="Symbol">∀</a> <a id="2044" class="Symbol">{</a><a id="2045" href="Types.html#2045" class="Bound">E</a> <a id="2047" href="Types.html#2047" class="Bound">A</a><a id="2048" class="Symbol">}</a> <a id="2050" class="Symbol">→</a> <a id="2052" href="Types.html#718" class="Datatype">Error</a> <a id="2058" href="Types.html#2045" class="Bound">E</a> <a id="2060" class="Symbol">→</a> <a id="2062" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="2068" href="Types.html#2047" class="Bound">A</a> <a id="2070" class="Symbol">→</a> <a id="2072" href="Types.html#1811" class="Function">Result</a> <a id="2079" href="Types.html#2045" class="Bound">E</a> <a id="2081" href="Types.html#2047" class="Bound">A</a>
  <a id="2085" href="Types.html#2030" class="Function">fromMaybe</a> <a id="2095" class="Symbol">=</a> <a id="2097" href="Data.Maybe.Base.html#1618" class="Function">maybe′</a> <a id="2104" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a> <a id="2109" href="Function.html#994" class="Function Operator">∘′</a> <a id="2112" href="Types.html#1975" class="Function">fail</a>

<a id="2118" class="Comment">-- Data.AVL is not quite usable with String at the moment IIRC</a>
<a id="2181" class="Comment">-- So instead I&#39;m using a quick and dirty representation</a>
<a id="2238" class="Keyword">import</a> <a id="2245" href="Data.Map.html" class="Module">Data.Map</a> <a id="2254" class="Symbol">as</a> <a id="2257" class="Module">M</a>

<a id="2260" class="Keyword">module</a> <a id="RMap"></a><a id="2267" href="Types.html#2267" class="Module">RMap</a> <a id="2272" class="Symbol">=</a> <a id="2274" href="Data.Map.html#300" class="Module">M.Map</a> <a id="2280" href="Data.Nat.Properties.html#2153" class="Function Operator">ℕ._≟_</a> <a id="2286" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
<a id="2293" class="Keyword">module</a> <a id="Map"></a><a id="2300" href="Types.html#2300" class="Module">Map</a>  <a id="2305" class="Symbol">=</a> <a id="2307" href="Data.Map.html#300" class="Module">M.Map</a> <a id="2313" href="Data.String.Unsafe.html#775" class="Function Operator">String._≟_</a> <a id="2324" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a>
<a id="2326" class="Keyword">open</a> <a id="2331" href="Types.html#2300" class="Module">Map</a> <a id="2335" class="Keyword">using</a> <a id="2341" class="Symbol">(</a><a id="2342" href="Data.Map.html#364" class="Function">Map</a><a id="2345" class="Symbol">;</a> <a id="2347" href="Data.Map.html#398" class="Function">RMap</a><a id="2351" class="Symbol">)</a> <a id="2353" class="Keyword">public</a>

<a id="Compiler"></a><a id="2361" href="Types.html#2361" class="Function">Compiler</a> <a id="2370" class="Symbol">:</a> <a id="2372" class="PrimitiveType">Set</a> <a id="2376" class="Symbol">→</a> <a id="2378" class="PrimitiveType">Set</a> <a id="2382" class="Symbol">→</a> <a id="2384" class="PrimitiveType">Set</a>
<a id="2388" href="Types.html#2361" class="Function">Compiler</a> <a id="2397" href="Types.html#2397" class="Bound">E</a> <a id="2399" class="Symbol">=</a> <a id="2401" href="Category.Monad.State.html#4416" class="Function">State</a> <a id="2407" class="Symbol">(</a><a id="2408" href="Data.Map.html#364" class="Function">Map</a> <a id="2412" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="2414" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="2415" class="Symbol">)</a> <a id="2417" href="Function.html#994" class="Function Operator">∘′</a> <a id="2420" class="Symbol">(</a><a id="2421" href="Types.html#718" class="Datatype">Error</a> <a id="2427" href="Types.html#2397" class="Bound">E</a> <a id="2429" href="Data.Sum.Base.html#509" class="Datatype Operator">⊎_</a><a id="2431" class="Symbol">)</a>

<a id="2434" class="Keyword">module</a> <a id="Compiler"></a><a id="2441" href="Types.html#2441" class="Module">Compiler</a> <a id="2450" class="Keyword">where</a>

  <a id="Compiler.monad"></a><a id="2459" href="Types.html#2459" class="Function">monad</a> <a id="2465" class="Symbol">:</a> <a id="2467" class="Symbol">∀</a> <a id="2469" href="Types.html#2469" class="Bound">E</a> <a id="2471" class="Symbol">→</a> <a id="2473" href="Category.Monad.html#396" class="Function">RawMonad</a> <a id="2482" class="Symbol">(</a><a id="2483" href="Types.html#2361" class="Function">Compiler</a> <a id="2492" href="Types.html#2469" class="Bound">E</a><a id="2493" class="Symbol">)</a>
  <a id="2497" href="Types.html#2459" class="Function">monad</a> <a id="2503" href="Types.html#2503" class="Bound">E</a> <a id="2505" class="Symbol">=</a> <a id="2507" href="Data.Sum.Categorical.Left.html#1133" class="Function">Sumₗ.monadT</a> <a id="2519" class="Symbol">(</a><a id="2520" href="Types.html#718" class="Datatype">Error</a> <a id="2526" href="Types.html#2503" class="Bound">E</a><a id="2527" class="Symbol">)</a> <a id="2529" href="Agda.Primitive.html#611" class="Primitive">L.zero</a> <a id="2536" class="Symbol">(</a><a id="2537" href="Category.Monad.State.html#4483" class="Function">StateMonad</a> <a id="2548" class="Symbol">_)</a>

  <a id="Compiler.liftResult"></a><a id="2554" href="Types.html#2554" class="Function">liftResult</a> <a id="2565" class="Symbol">:</a> <a id="2567" class="Symbol">∀</a> <a id="2569" class="Symbol">{</a><a id="2570" href="Types.html#2570" class="Bound">E</a> <a id="2572" href="Types.html#2572" class="Bound">A</a><a id="2573" class="Symbol">}</a> <a id="2575" class="Symbol">→</a> <a id="2577" href="Types.html#718" class="Datatype">Error</a> <a id="2583" href="Types.html#2570" class="Bound">E</a> <a id="2585" href="Data.Sum.Base.html#509" class="Datatype Operator">⊎</a> <a id="2587" href="Types.html#2572" class="Bound">A</a> <a id="2589" class="Symbol">→</a> <a id="2591" href="Types.html#2361" class="Function">Compiler</a> <a id="2600" href="Types.html#2570" class="Bound">E</a> <a id="2602" href="Types.html#2572" class="Bound">A</a>
  <a id="2606" href="Types.html#2554" class="Function">liftResult</a> <a id="2617" class="Symbol">=</a> <a id="2619" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">_,_</a>

  <a id="Compiler.liftState"></a><a id="2626" href="Types.html#2626" class="Function">liftState</a> <a id="2636" class="Symbol">:</a> <a id="2638" class="Symbol">∀</a> <a id="2640" class="Symbol">{</a><a id="2641" href="Types.html#2641" class="Bound">E</a> <a id="2643" href="Types.html#2643" class="Bound">A</a><a id="2644" class="Symbol">}</a> <a id="2646" class="Symbol">→</a> <a id="2648" href="Category.Monad.State.html#4416" class="Function">State</a> <a id="2654" class="Symbol">(</a><a id="2655" href="Data.Map.html#364" class="Function">Map</a> <a id="2659" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="2661" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="2662" class="Symbol">)</a> <a id="2664" href="Types.html#2643" class="Bound">A</a> <a id="2666" class="Symbol">→</a> <a id="2668" href="Types.html#2361" class="Function">Compiler</a> <a id="2677" href="Types.html#2641" class="Bound">E</a> <a id="2679" href="Types.html#2643" class="Bound">A</a>
  <a id="2683" href="Types.html#2626" class="Function">liftState</a> <a id="2693" class="Symbol">=</a> <a id="2695" class="Keyword">let</a> <a id="2699" class="Keyword">open</a> <a id="2704" href="Category.Monad.html#810" class="Module">RawMonad</a> <a id="2713" class="Symbol">(</a><a id="2714" href="Category.Monad.State.html#4483" class="Function">StateMonad</a> <a id="2725" class="Symbol">_)</a> <a id="2728" class="Keyword">in</a> <a id="2731" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a> <a id="2736" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;_</a>

  <a id="Compiler.fail"></a><a id="2744" href="Types.html#2744" class="Function">fail</a> <a id="2749" class="Symbol">:</a> <a id="2751" class="Symbol">∀</a> <a id="2753" class="Symbol">{</a><a id="2754" href="Types.html#2754" class="Bound">E</a> <a id="2756" href="Types.html#2756" class="Bound">A</a><a id="2757" class="Symbol">}</a> <a id="2759" class="Symbol">→</a> <a id="2761" href="Types.html#718" class="Datatype">Error</a> <a id="2767" href="Types.html#2754" class="Bound">E</a> <a id="2769" class="Symbol">→</a> <a id="2771" href="Types.html#2361" class="Function">Compiler</a> <a id="2780" href="Types.html#2754" class="Bound">E</a> <a id="2782" href="Types.html#2756" class="Bound">A</a>
  <a id="2786" href="Types.html#2744" class="Function">fail</a> <a id="2791" class="Symbol">=</a> <a id="2793" href="Types.html#2554" class="Function">liftResult</a> <a id="2804" href="Function.html#994" class="Function Operator">∘′</a> <a id="2807" href="Types.html#1975" class="Function">Result.fail</a>

  <a id="Compiler.fromMaybe"></a><a id="2822" href="Types.html#2822" class="Function">fromMaybe</a> <a id="2832" class="Symbol">:</a> <a id="2834" class="Symbol">∀</a> <a id="2836" class="Symbol">{</a><a id="2837" href="Types.html#2837" class="Bound">E</a> <a id="2839" href="Types.html#2839" class="Bound">A</a><a id="2840" class="Symbol">}</a> <a id="2842" class="Symbol">→</a> <a id="2844" href="Types.html#718" class="Datatype">Error</a> <a id="2850" href="Types.html#2837" class="Bound">E</a> <a id="2852" class="Symbol">→</a> <a id="2854" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="2860" href="Types.html#2839" class="Bound">A</a> <a id="2862" class="Symbol">→</a> <a id="2864" href="Types.html#2361" class="Function">Compiler</a> <a id="2873" href="Types.html#2837" class="Bound">E</a> <a id="2875" href="Types.html#2839" class="Bound">A</a>
  <a id="2879" href="Types.html#2822" class="Function">fromMaybe</a> <a id="2889" href="Types.html#2889" class="Bound">e</a> <a id="2891" href="Types.html#2891" class="Bound">ma</a> <a id="2894" class="Symbol">=</a> <a id="2896" href="Types.html#2554" class="Function">liftResult</a> <a id="2907" href="Function.html#1927" class="Function Operator">$</a> <a id="2909" href="Types.html#2030" class="Function">Result.fromMaybe</a> <a id="2926" href="Types.html#2889" class="Bound">e</a> <a id="2928" href="Types.html#2891" class="Bound">ma</a>

  <a id="Compiler.run"></a><a id="2934" href="Types.html#2934" class="Function">run</a> <a id="2938" class="Symbol">:</a> <a id="2940" class="Symbol">∀</a> <a id="2942" class="Symbol">{</a><a id="2943" href="Types.html#2943" class="Bound">E</a> <a id="2945" href="Types.html#2945" class="Bound">A</a><a id="2946" class="Symbol">}</a> <a id="2948" class="Symbol">→</a> <a id="2950" href="Types.html#2361" class="Function">Compiler</a> <a id="2959" href="Types.html#2943" class="Bound">E</a> <a id="2961" href="Types.html#2945" class="Bound">A</a> <a id="2963" class="Symbol">→</a> <a id="2965" href="Types.html#1811" class="Function">Result</a> <a id="2972" href="Types.html#2943" class="Bound">E</a> <a id="2974" href="Types.html#2945" class="Bound">A</a>
  <a id="2978" href="Types.html#2934" class="Function">run</a> <a id="2982" href="Types.html#2982" class="Bound">m</a> <a id="2984" class="Symbol">=</a> <a id="2986" href="Agda.Builtin.Sigma.html#155" class="Field">proj₁</a> <a id="2992" class="Symbol">(</a><a id="2993" href="Types.html#2982" class="Bound">m</a> <a id="2995" class="Symbol">(</a><a id="2996" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="2999" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="3001" class="Number">0</a><a id="3002" class="Symbol">))</a>


<a id="3007" class="Keyword">module</a> <a id="PrettyPrint"></a><a id="3014" href="Types.html#3014" class="Module">PrettyPrint</a> <a id="3026" class="Keyword">where</a>

  <a id="3035" class="Keyword">open</a> <a id="3040" href="Category.Monad.html#810" class="Module">RawMonad</a> <a id="3049" class="Symbol">(</a><a id="3050" href="Data.Maybe.Categorical.html#1423" class="Function">MC.monad</a> <a id="3059" class="Symbol">{</a><a id="3060" href="Agda.Primitive.html#611" class="Primitive">L.zero</a><a id="3066" class="Symbol">})</a> <a id="3069" class="Keyword">using</a> <a id="3075" class="Symbol">(</a>_&lt;$&gt;_<a id="3081" class="Symbol">;</a> _⊛_<a id="3086" class="Symbol">)</a>

  <a id="PrettyPrint.ppType"></a><a id="3091" href="Types.html#3091" class="Function">ppType</a> <a id="3098" class="Symbol">:</a> <a id="3100" href="Data.Map.html#398" class="Function">RMap</a> <a id="3105" class="Symbol">→</a> <a id="3107" href="Language.html#764" class="Datatype">Type</a> <a id="3112" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="3114" class="Symbol">→</a> <a id="3116" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="3122" class="Symbol">(</a><a id="3123" href="Language.html#764" class="Datatype">Type</a> <a id="3128" href="Agda.Builtin.String.html#165" class="Postulate">String</a><a id="3134" class="Symbol">)</a>
  <a id="3138" href="Types.html#3091" class="Function">ppType</a> <a id="3145" href="Types.html#3145" class="Bound">rm</a> <a id="3148" class="Symbol">(</a><a id="3149" href="Language.html#793" class="InductiveConstructor">α</a> <a id="3151" href="Types.html#3151" class="Bound">k</a><a id="3152" class="Symbol">)</a>   <a id="3156" class="Symbol">=</a> <a id="3158" href="Language.html#793" class="InductiveConstructor">α</a> <a id="3160" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="3164" href="Data.Map.html#517" class="Function">RMap.assoc</a> <a id="3175" href="Types.html#3151" class="Bound">k</a> <a id="3177" href="Types.html#3145" class="Bound">rm</a>
  <a id="3182" href="Types.html#3091" class="Function">ppType</a> <a id="3189" href="Types.html#3189" class="Bound">rm</a> <a id="3192" class="Symbol">(</a><a id="3193" href="Types.html#3193" class="Bound">σ</a> <a id="3195" href="Language.html#812" class="InductiveConstructor Operator">⊗</a> <a id="3197" href="Types.html#3197" class="Bound">τ</a><a id="3198" class="Symbol">)</a> <a id="3200" class="Symbol">=</a> <a id="3202" href="Language.html#812" class="InductiveConstructor Operator">_⊗_</a> <a id="3206" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="3210" href="Types.html#3091" class="Function">ppType</a> <a id="3217" href="Types.html#3189" class="Bound">rm</a> <a id="3220" href="Types.html#3193" class="Bound">σ</a> <a id="3222" href="Category.Applicative.Indexed.html#938" class="Function Operator">⊛</a> <a id="3224" href="Types.html#3091" class="Function">ppType</a> <a id="3231" href="Types.html#3189" class="Bound">rm</a> <a id="3234" href="Types.html#3197" class="Bound">τ</a>
  <a id="3238" href="Types.html#3091" class="Function">ppType</a> <a id="3245" href="Types.html#3245" class="Bound">rm</a> <a id="3248" class="Symbol">(</a><a id="3249" href="Types.html#3249" class="Bound">σ</a> <a id="3251" href="Language.html#844" class="InductiveConstructor Operator">⇒</a> <a id="3253" href="Types.html#3253" class="Bound">τ</a><a id="3254" class="Symbol">)</a> <a id="3256" class="Symbol">=</a> <a id="3258" href="Language.html#844" class="InductiveConstructor Operator">_⇒_</a> <a id="3262" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="3266" href="Types.html#3091" class="Function">ppType</a> <a id="3273" href="Types.html#3245" class="Bound">rm</a> <a id="3276" href="Types.html#3249" class="Bound">σ</a> <a id="3278" href="Category.Applicative.Indexed.html#938" class="Function Operator">⊛</a> <a id="3280" href="Types.html#3091" class="Function">ppType</a> <a id="3287" href="Types.html#3245" class="Bound">rm</a> <a id="3290" href="Types.html#3253" class="Bound">τ</a>

  <a id="PrettyPrint.ppError"></a><a id="3295" href="Types.html#3295" class="Function">ppError</a> <a id="3303" class="Symbol">:</a> <a id="3305" href="Data.Map.html#398" class="Function">RMap</a> <a id="3310" class="Symbol">→</a> <a id="3312" href="Types.html#718" class="Datatype">Error</a> <a id="3318" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="3320" class="Symbol">→</a> <a id="3322" href="Types.html#718" class="Datatype">Error</a> <a id="3328" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
  <a id="3337" href="Types.html#3295" class="Function">ppError</a> <a id="3345" href="Types.html#3345" class="Bound">rm</a> <a id="3348" href="Types.html#3348" class="Bound">err</a> <a id="3352" class="Symbol">=</a> <a id="3354" href="Function.html#3533" class="Function Operator">case</a> <a id="3359" href="Types.html#3348" class="Bound">err</a> <a id="3363" href="Function.html#3533" class="Function Operator">of</a> <a id="3366" class="Symbol">λ</a> <a id="3368" class="Keyword">where</a>
    <a id="3378" class="Symbol">(</a><a id="3379" href="Types.html#748" class="InductiveConstructor Operator">At</a> <a id="3382" href="Types.html#3382" class="Bound">p</a> <a id="3384" href="Types.html#748" class="InductiveConstructor Operator">ParseError</a><a id="3394" class="Symbol">)</a>             <a id="3408" class="Symbol">→</a> <a id="3410" href="Types.html#748" class="InductiveConstructor Operator">At</a> <a id="3413" href="Types.html#3382" class="Bound">p</a> <a id="3415" href="Types.html#748" class="InductiveConstructor Operator">ParseError</a>
    <a id="3430" class="Symbol">(</a><a id="3431" href="Types.html#797" class="InductiveConstructor Operator">At</a> <a id="3434" href="Types.html#3434" class="Bound">p</a> <a id="3436" href="Types.html#797" class="InductiveConstructor Operator">OutOfScope</a> <a id="3447" href="Types.html#3447" class="Bound">x</a><a id="3448" class="Symbol">)</a>           <a id="3460" class="Symbol">→</a> <a id="3462" href="Types.html#797" class="InductiveConstructor Operator">At</a> <a id="3465" href="Types.html#3434" class="Bound">p</a> <a id="3467" href="Types.html#797" class="InductiveConstructor Operator">OutOfScope</a> <a id="3478" href="Types.html#3447" class="Bound">x</a>
    <a id="3484" class="Symbol">(</a><a id="3485" href="Types.html#855" class="InductiveConstructor Operator">At</a> <a id="3488" href="Types.html#3488" class="Bound">p</a> <a id="3490" href="Types.html#855" class="InductiveConstructor Operator">Expected</a> <a id="3499" href="Types.html#3499" class="Bound">σ</a> <a id="3501" href="Types.html#855" class="InductiveConstructor Operator">Got</a> <a id="3505" href="Types.html#3505" class="Bound">τ</a><a id="3506" class="Symbol">)</a>       <a id="3514" class="Symbol">→</a>
      <a id="3522" href="Function.html#3533" class="Function Operator">case</a> <a id="3527" href="Types.html#855" class="InductiveConstructor Operator">At</a> <a id="3530" href="Types.html#3488" class="Bound">p</a> <a id="3532" href="Types.html#855" class="InductiveConstructor Operator">Expected_Got_</a> <a id="3546" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="3550" href="Types.html#3091" class="Function">ppType</a> <a id="3557" href="Types.html#3345" class="Bound">rm</a> <a id="3560" href="Types.html#3499" class="Bound">σ</a> <a id="3562" href="Category.Applicative.Indexed.html#938" class="Function Operator">⊛</a> <a id="3564" href="Types.html#3091" class="Function">ppType</a> <a id="3571" href="Types.html#3345" class="Bound">rm</a> <a id="3574" href="Types.html#3505" class="Bound">τ</a> <a id="3576" href="Function.html#3533" class="Function Operator">of</a> <a id="3579" class="Symbol">λ</a> <a id="3581" class="Keyword">where</a>
        <a id="3595" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a>    <a id="3606" class="Symbol">→</a> <a id="3608" href="Types.html#1038" class="InductiveConstructor Operator">At</a> <a id="3611" href="Types.html#3488" class="Bound">p</a> <a id="3613" href="Types.html#1038" class="InductiveConstructor Operator">ErrorWhenPrintingError</a>
        <a id="3644" class="Symbol">(</a><a id="3645" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="3650" href="Types.html#3650" class="Bound">err</a><a id="3653" class="Symbol">)</a> <a id="3655" class="Symbol">→</a> <a id="3657" href="Types.html#3650" class="Bound">err</a>
    <a id="3665" class="Symbol">(</a><a id="3666" href="Types.html#922" class="InductiveConstructor Operator">At</a> <a id="3669" href="Types.html#3669" class="Bound">p</a> <a id="3671" href="Types.html#922" class="InductiveConstructor Operator">NotAnArrow</a> <a id="3682" href="Types.html#3682" class="Bound">σ</a><a id="3683" class="Symbol">)</a>           <a id="3695" class="Symbol">→</a>
      <a id="3703" href="Function.html#3533" class="Function Operator">case</a> <a id="3708" href="Types.html#922" class="InductiveConstructor Operator">At</a> <a id="3711" href="Types.html#3669" class="Bound">p</a> <a id="3713" href="Types.html#922" class="InductiveConstructor Operator">NotAnArrow_</a> <a id="3725" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="3729" href="Types.html#3091" class="Function">ppType</a> <a id="3736" href="Types.html#3345" class="Bound">rm</a> <a id="3739" href="Types.html#3682" class="Bound">σ</a> <a id="3741" href="Function.html#3533" class="Function Operator">of</a> <a id="3744" class="Symbol">λ</a> <a id="3746" class="Keyword">where</a>
        <a id="3760" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a>    <a id="3771" class="Symbol">→</a> <a id="3773" href="Types.html#1038" class="InductiveConstructor Operator">At</a> <a id="3776" href="Types.html#3669" class="Bound">p</a> <a id="3778" href="Types.html#1038" class="InductiveConstructor Operator">ErrorWhenPrintingError</a>
        <a id="3809" class="Symbol">(</a><a id="3810" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="3815" href="Types.html#3815" class="Bound">err</a><a id="3818" class="Symbol">)</a> <a id="3820" class="Symbol">→</a> <a id="3822" href="Types.html#3815" class="Bound">err</a>
    <a id="3830" class="Symbol">(</a><a id="3831" href="Types.html#980" class="InductiveConstructor Operator">At</a> <a id="3834" href="Types.html#3834" class="Bound">p</a> <a id="3836" href="Types.html#980" class="InductiveConstructor Operator">NotAProduct</a> <a id="3848" href="Types.html#3848" class="Bound">σ</a><a id="3849" class="Symbol">)</a>           <a id="3861" class="Symbol">→</a>
      <a id="3869" href="Function.html#3533" class="Function Operator">case</a> <a id="3874" href="Types.html#980" class="InductiveConstructor Operator">At</a> <a id="3877" href="Types.html#3834" class="Bound">p</a> <a id="3879" href="Types.html#980" class="InductiveConstructor Operator">NotAProduct_</a> <a id="3892" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="3896" href="Types.html#3091" class="Function">ppType</a> <a id="3903" href="Types.html#3345" class="Bound">rm</a> <a id="3906" href="Types.html#3848" class="Bound">σ</a> <a id="3908" href="Function.html#3533" class="Function Operator">of</a> <a id="3911" class="Symbol">λ</a> <a id="3913" class="Keyword">where</a>
        <a id="3927" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a>    <a id="3938" class="Symbol">→</a> <a id="3940" href="Types.html#1038" class="InductiveConstructor Operator">At</a> <a id="3943" href="Types.html#3834" class="Bound">p</a> <a id="3945" href="Types.html#1038" class="InductiveConstructor Operator">ErrorWhenPrintingError</a>
        <a id="3976" class="Symbol">(</a><a id="3977" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="3982" href="Types.html#3982" class="Bound">err</a><a id="3985" class="Symbol">)</a> <a id="3987" class="Symbol">→</a> <a id="3989" href="Types.html#3982" class="Bound">err</a>
    <a id="3997" class="Symbol">(</a><a id="3998" href="Types.html#1038" class="InductiveConstructor Operator">At</a> <a id="4001" href="Types.html#4001" class="Bound">p</a> <a id="4003" href="Types.html#1038" class="InductiveConstructor Operator">ErrorWhenPrintingError</a><a id="4025" class="Symbol">)</a> <a id="4027" class="Symbol">→</a> <a id="4029" href="Types.html#1038" class="InductiveConstructor Operator">At</a> <a id="4032" href="Types.html#4001" class="Bound">p</a> <a id="4034" href="Types.html#1038" class="InductiveConstructor Operator">ErrorWhenPrintingError</a>


<a id="ppCompiler"></a><a id="4059" href="Types.html#4059" class="Function">ppCompiler</a> <a id="4070" class="Symbol">:</a> <a id="4072" class="Symbol">∀</a> <a id="4074" class="Symbol">{</a><a id="4075" href="Types.html#4075" class="Bound">A</a><a id="4076" class="Symbol">}</a> <a id="4078" class="Symbol">→</a> <a id="4080" href="Types.html#2361" class="Function">Compiler</a> <a id="4089" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="4091" href="Types.html#4075" class="Bound">A</a> <a id="4093" class="Symbol">→</a> <a id="4095" href="Types.html#2361" class="Function">Compiler</a> <a id="4104" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="4111" href="Types.html#4075" class="Bound">A</a>
<a id="4113" href="Types.html#4059" class="Function">ppCompiler</a> <a id="4124" href="Types.html#4124" class="Bound">m</a> <a id="4126" class="Symbol">=</a> <a id="4128" class="Keyword">let</a> <a id="4132" class="Keyword">open</a> <a id="4137" href="Category.Monad.State.html#3607" class="Module">RawMonadState</a> <a id="4151" class="Symbol">(</a><a id="4152" href="Category.Monad.State.html#4574" class="Function">StateMonadState</a> <a id="4168" class="Symbol">_)</a> <a id="4171" class="Keyword">in</a> <a id="4174" class="Keyword">do</a>
  <a id="4179" href="Types.html#4179" class="Bound">v</a>  <a id="4182" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="4184" href="Types.html#4124" class="Bound">m</a>
  <a id="4188" href="Types.html#4188" class="Bound">mp</a> <a id="4191" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="4193" href="Agda.Builtin.Sigma.html#155" class="Field">proj₁</a> <a id="4199" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="4203" href="Category.Monad.State.html#2900" class="Function">get</a>
  <a id="4209" href="Category.Applicative.Indexed.html#905" class="Function">pure</a> <a id="4214" href="Function.html#1927" class="Function Operator">$</a> <a id="4216" href="Data.Sum.Base.html#1378" class="Function">Sum.map₁</a> <a id="4225" class="Symbol">(</a><a id="4226" href="Types.html#3295" class="Function">PrettyPrint.ppError</a> <a id="4246" class="Symbol">(</a><a id="4247" href="Data.Map.html#641" class="Function">Map.invert</a> <a id="4258" href="Types.html#4188" class="Bound">mp</a><a id="4260" class="Symbol">))</a> <a id="4263" href="Types.html#4179" class="Bound">v</a>
</pre></body></html>