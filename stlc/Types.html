<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Types</title><link rel="stylesheet" href="Agda.css"></head><body><pre><a id="1" class="Keyword">module</a> <a id="8" href="Types.html" class="Module">Types</a> <a id="14" class="Keyword">where</a>

<a id="21" class="Keyword">import</a> <a id="28" href="Level.html" class="Module">Level</a> <a id="34" class="Symbol">as</a> <a id="37" class="Module">L</a>
<a id="39" class="Keyword">open</a> <a id="44" class="Keyword">import</a> <a id="51" href="Category.Monad.html" class="Module">Category.Monad</a>
<a id="66" class="Keyword">open</a> <a id="71" class="Keyword">import</a> <a id="78" href="Category.Monad.State.html" class="Module">Category.Monad.State</a>
<a id="99" class="Keyword">open</a> <a id="104" class="Keyword">import</a> <a id="111" href="Data.String.html" class="Module">Data.String</a> <a id="123" class="Symbol">as</a> <a id="126" class="Module">String</a> <a id="133" class="Keyword">using</a> <a id="139" class="Symbol">(</a><a id="140" href="Agda.Builtin.String.html#165" class="Postulate">String</a><a id="146" class="Symbol">;</a> <a id="148" href="Data.String.Base.html#1125" class="Function Operator">_++_</a><a id="152" class="Symbol">)</a>
<a id="154" class="Keyword">import</a> <a id="161" href="Data.String.Unsafe.html" class="Module">Data.String.Unsafe</a> <a id="180" class="Symbol">as</a> <a id="183" class="Module">String</a>
<a id="190" class="Keyword">open</a> <a id="195" class="Keyword">import</a> <a id="202" href="Data.Product.html" class="Module">Data.Product</a> <a id="215" class="Symbol">as</a> <a id="218" class="Module">Prod</a> <a id="223" class="Keyword">using</a> <a id="229" class="Symbol">(</a><a id="230" href="Data.Product.html#1389" class="Function Operator">_×_</a><a id="233" class="Symbol">;</a> <a id="235" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">_,_</a><a id="238" class="Symbol">;</a> <a id="240" href="Agda.Builtin.Sigma.html#155" class="Field">proj₁</a><a id="245" class="Symbol">)</a>
<a id="247" class="Keyword">open</a> <a id="252" class="Keyword">import</a> <a id="259" href="Data.List.Base.html" class="Module">Data.List.Base</a> <a id="274" class="Keyword">using</a> <a id="280" class="Symbol">(</a><a id="281" href="Data.List.Base.html#9863" class="InductiveConstructor">[]</a><a id="283" class="Symbol">)</a>
<a id="285" class="Keyword">open</a> <a id="290" class="Keyword">import</a> <a id="297" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="306" class="Symbol">as</a> <a id="309" class="Module">ℕ</a> <a id="311" class="Keyword">using</a> <a id="317" class="Symbol">(</a><a id="318" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="319" class="Symbol">)</a>
<a id="321" class="Keyword">open</a> <a id="326" class="Keyword">import</a> <a id="333" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="349" class="Keyword">using</a> <a id="355" class="Symbol">(</a><a id="356" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a><a id="361" class="Symbol">;</a> <a id="363" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a><a id="367" class="Symbol">;</a> <a id="369" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a><a id="376" class="Symbol">;</a> <a id="378" href="Data.Maybe.Base.html#1618" class="Function">maybe′</a><a id="384" class="Symbol">)</a>
<a id="386" class="Keyword">import</a> <a id="393" href="Data.Maybe.Categorical.html" class="Module">Data.Maybe.Categorical</a> <a id="416" class="Symbol">as</a> <a id="419" class="Module">MC</a>
<a id="422" class="Keyword">open</a> <a id="427" class="Keyword">import</a> <a id="434" href="Data.Sum.Base.html" class="Module">Data.Sum.Base</a> <a id="448" class="Symbol">as</a> <a id="451" class="Module">Sum</a>
<a id="455" class="Keyword">import</a> <a id="462" href="Data.Sum.Categorical.Left.html" class="Module">Data.Sum.Categorical.Left</a> <a id="488" class="Symbol">as</a> <a id="491" class="Module">Sumₗ</a>
<a id="496" class="Keyword">open</a> <a id="501" class="Keyword">import</a> <a id="508" href="Function.html" class="Module">Function</a>

<a id="518" class="Keyword">open</a> <a id="523" class="Keyword">import</a> <a id="530" href="Text.Parser.Position.html" class="Module">Text.Parser.Position</a> <a id="551" class="Symbol">as</a> <a id="554" class="Module">Position</a> <a id="563" class="Keyword">using</a> <a id="569" class="Symbol">(</a><a id="570" href="Text.Parser.Position.html#310" class="Record">Position</a><a id="578" class="Symbol">)</a>

<a id="581" class="Keyword">open</a> <a id="586" class="Keyword">import</a> <a id="593" href="Language.html" class="Module">Language</a> <a id="602" class="Keyword">hiding</a> <a id="609" class="Symbol">(</a><a id="610" href="Language.html#843" class="Function">show</a><a id="614" class="Symbol">)</a>

<a id="617" class="Comment">--------------------------------------------------------------------------------</a>
<a id="698" class="Comment">-- Error type</a>

<a id="713" class="Keyword">data</a> <a id="Error"></a><a id="718" href="Types.html#718" class="Datatype">Error</a> <a id="724" class="Symbol">(</a><a id="725" href="Types.html#725" class="Bound">A</a> <a id="727" class="Symbol">:</a> <a id="729" class="PrimitiveType">Set</a><a id="732" class="Symbol">)</a> <a id="734" class="Symbol">:</a> <a id="736" class="PrimitiveType">Set</a> <a id="740" class="Keyword">where</a>
  <a id="Error.At_ParseError"></a><a id="748" href="Types.html#748" class="InductiveConstructor Operator">At_ParseError</a>             <a id="774" class="Symbol">:</a> <a id="776" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="785" class="Symbol">→</a> <a id="787" href="Types.html#718" class="Datatype">Error</a> <a id="793" href="Types.html#725" class="Bound">A</a>
  <a id="Error.At_OutOfScope_"></a><a id="797" href="Types.html#797" class="InductiveConstructor Operator">At_OutOfScope_</a>            <a id="823" class="Symbol">:</a> <a id="825" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="834" class="Symbol">→</a> <a id="836" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="843" class="Symbol">→</a> <a id="845" href="Types.html#718" class="Datatype">Error</a> <a id="851" href="Types.html#725" class="Bound">A</a>
  <a id="Error.At_Expected_Got_"></a><a id="855" href="Types.html#855" class="InductiveConstructor Operator">At_Expected_Got_</a>          <a id="881" class="Symbol">:</a> <a id="883" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="892" class="Symbol">→</a> <a id="894" href="Language.html#764" class="Datatype">Type</a> <a id="899" href="Types.html#725" class="Bound">A</a> <a id="901" class="Symbol">→</a> <a id="903" href="Language.html#764" class="Datatype">Type</a> <a id="908" href="Types.html#725" class="Bound">A</a> <a id="910" class="Symbol">→</a> <a id="912" href="Types.html#718" class="Datatype">Error</a> <a id="918" href="Types.html#725" class="Bound">A</a>
  <a id="Error.At_NotAnArrow_"></a><a id="922" href="Types.html#922" class="InductiveConstructor Operator">At_NotAnArrow_</a>            <a id="948" class="Symbol">:</a> <a id="950" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="959" class="Symbol">→</a> <a id="961" href="Language.html#764" class="Datatype">Type</a> <a id="966" href="Types.html#725" class="Bound">A</a> <a id="968" class="Symbol">→</a> <a id="970" href="Types.html#718" class="Datatype">Error</a> <a id="976" href="Types.html#725" class="Bound">A</a>
  <a id="Error.At_ErrorWhenPrintingError"></a><a id="980" href="Types.html#980" class="InductiveConstructor Operator">At_ErrorWhenPrintingError</a> <a id="1006" class="Symbol">:</a> <a id="1008" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="1017" class="Symbol">→</a> <a id="1019" href="Types.html#718" class="Datatype">Error</a> <a id="1025" href="Types.html#725" class="Bound">A</a>

<a id="show"></a><a id="1028" href="Types.html#1028" class="Function">show</a> <a id="1033" class="Symbol">:</a> <a id="1035" href="Types.html#718" class="Datatype">Error</a> <a id="1041" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1048" class="Symbol">→</a> <a id="1050" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
<a id="1057" href="Types.html#1028" class="Function">show</a> <a id="1062" href="Types.html#1062" class="Bound">err</a> <a id="1066" class="Symbol">=</a> <a id="1068" href="Function.html#3533" class="Function Operator">case</a> <a id="1073" href="Types.html#1062" class="Bound">err</a> <a id="1077" href="Function.html#3533" class="Function Operator">of</a> <a id="1080" class="Symbol">λ</a> <a id="1082" class="Keyword">where</a>
  <a id="1090" class="Symbol">(</a><a id="1091" href="Types.html#748" class="InductiveConstructor Operator">At</a> <a id="1094" href="Types.html#1094" class="Bound">p</a> <a id="1096" href="Types.html#748" class="InductiveConstructor Operator">ParseError</a><a id="1106" class="Symbol">)</a>             <a id="1120" class="Symbol">→</a> <a id="1122" href="Types.html#1558" class="Function">at</a> <a id="1125" href="Types.html#1094" class="Bound">p</a> <a id="1127" class="String">&quot;parse error.&quot;</a>
  <a id="1144" class="Symbol">(</a><a id="1145" href="Types.html#797" class="InductiveConstructor Operator">At</a> <a id="1148" href="Types.html#1148" class="Bound">p</a> <a id="1150" href="Types.html#797" class="InductiveConstructor Operator">OutOfScope</a> <a id="1161" href="Types.html#1161" class="Bound">x</a><a id="1162" class="Symbol">)</a>           <a id="1174" class="Symbol">→</a> <a id="1176" href="Types.html#1558" class="Function">at</a> <a id="1179" href="Types.html#1148" class="Bound">p</a> <a id="1181" href="Function.html#1927" class="Function Operator">$</a> <a id="1183" href="Types.html#1161" class="Bound">x</a> <a id="1185" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1188" class="String">&quot; is out of scope.&quot;</a>
  <a id="1210" class="Symbol">(</a><a id="1211" href="Types.html#855" class="InductiveConstructor Operator">At</a> <a id="1214" href="Types.html#1214" class="Bound">p</a> <a id="1216" href="Types.html#855" class="InductiveConstructor Operator">Expected</a> <a id="1225" href="Types.html#1225" class="Bound">σ</a> <a id="1227" href="Types.html#855" class="InductiveConstructor Operator">Got</a> <a id="1231" href="Types.html#1231" class="Bound">τ</a><a id="1232" class="Symbol">)</a>       <a id="1240" class="Symbol">→</a> <a id="1242" href="Types.html#1558" class="Function">at</a> <a id="1245" href="Types.html#1214" class="Bound">p</a> <a id="1247" href="Function.html#1927" class="Function Operator">$</a> <a id="1249" class="String">&quot;expected type &quot;</a> <a id="1266" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1269" href="Language.html#843" class="Function">Language.show</a> <a id="1283" href="Types.html#1225" class="Bound">σ</a>
                                      <a id="1323" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1326" class="String">&quot; but got type &quot;</a> <a id="1343" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1346" href="Language.html#843" class="Function">Language.show</a> <a id="1360" href="Types.html#1231" class="Bound">τ</a> <a id="1362" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1365" class="String">&quot; instead.&quot;</a>
  <a id="1379" class="Symbol">(</a><a id="1380" href="Types.html#922" class="InductiveConstructor Operator">At</a> <a id="1383" href="Types.html#1383" class="Bound">p</a> <a id="1385" href="Types.html#922" class="InductiveConstructor Operator">NotAnArrow</a> <a id="1396" href="Types.html#1396" class="Bound">σ</a><a id="1397" class="Symbol">)</a>           <a id="1409" class="Symbol">→</a> <a id="1411" href="Types.html#1558" class="Function">at</a> <a id="1414" href="Types.html#1383" class="Bound">p</a> <a id="1416" href="Function.html#1927" class="Function Operator">$</a> <a id="1418" class="String">&quot;the type &quot;</a> <a id="1430" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1433" href="Language.html#843" class="Function">Language.show</a> <a id="1447" href="Types.html#1396" class="Bound">σ</a> <a id="1449" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1452" class="String">&quot; is not an arrow type.&quot;</a>
  <a id="1479" class="Symbol">(</a><a id="1480" href="Types.html#980" class="InductiveConstructor Operator">At</a> <a id="1483" href="Types.html#1483" class="Bound">p</a> <a id="1485" href="Types.html#980" class="InductiveConstructor Operator">ErrorWhenPrintingError</a><a id="1507" class="Symbol">)</a> <a id="1509" class="Symbol">→</a> <a id="1511" href="Types.html#1558" class="Function">at</a> <a id="1514" href="Types.html#1483" class="Bound">p</a> <a id="1516" href="Function.html#1927" class="Function Operator">$</a> <a id="1518" class="String">&quot;error when printing error.&quot;</a>

    <a id="1552" class="Keyword">where</a> <a id="1558" href="Types.html#1558" class="Function">at</a> <a id="1561" class="Symbol">:</a> <a id="1563" href="Text.Parser.Position.html#310" class="Record">Position</a> <a id="1572" class="Symbol">→</a> <a id="1574" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="1581" class="Symbol">→</a> <a id="1583" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
          <a id="1600" href="Types.html#1558" class="Function">at</a> <a id="1603" href="Types.html#1603" class="Bound">p</a> <a id="1605" href="Types.html#1605" class="Bound">str</a> <a id="1609" class="Symbol">=</a> <a id="1611" class="String">&quot;At &quot;</a> <a id="1617" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1620" href="Text.Parser.Position.html#710" class="Function">Position.show</a> <a id="1634" href="Types.html#1603" class="Bound">p</a> <a id="1636" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1639" class="String">&quot;: &quot;</a> <a id="1644" href="Data.String.Base.html#1125" class="Function Operator">++</a> <a id="1647" href="Types.html#1605" class="Bound">str</a>

<a id="Result"></a><a id="1652" href="Types.html#1652" class="Function">Result</a> <a id="1659" class="Symbol">:</a> <a id="1661" class="PrimitiveType">Set</a> <a id="1665" class="Symbol">→</a> <a id="1667" class="PrimitiveType">Set</a> <a id="1671" class="Symbol">→</a> <a id="1673" class="PrimitiveType">Set</a>
<a id="1677" href="Types.html#1652" class="Function">Result</a> <a id="1684" href="Types.html#1684" class="Bound">E</a> <a id="1686" class="Symbol">=</a> <a id="1688" href="Data.Sum.Categorical.Left.html#835" class="Function">Sumₗ.Sumₗ</a> <a id="1698" class="Symbol">(</a><a id="1699" href="Types.html#718" class="Datatype">Error</a> <a id="1705" href="Types.html#1684" class="Bound">E</a><a id="1706" class="Symbol">)</a> <a id="1708" href="Agda.Primitive.html#611" class="Primitive">L.zero</a>

<a id="1716" class="Keyword">module</a> <a id="Result"></a><a id="1723" href="Types.html#1723" class="Module">Result</a> <a id="1730" class="Keyword">where</a>

  <a id="Result.monad"></a><a id="1739" href="Types.html#1739" class="Function">monad</a> <a id="1745" class="Symbol">:</a> <a id="1747" class="Symbol">∀</a> <a id="1749" href="Types.html#1749" class="Bound">E</a> <a id="1751" class="Symbol">→</a> <a id="1753" href="Category.Monad.html#396" class="Function">RawMonad</a> <a id="1762" class="Symbol">(</a><a id="1763" href="Types.html#1652" class="Function">Result</a> <a id="1770" href="Types.html#1749" class="Bound">E</a><a id="1771" class="Symbol">)</a>
  <a id="1775" href="Types.html#1739" class="Function">monad</a> <a id="1781" href="Types.html#1781" class="Bound">E</a> <a id="1783" class="Symbol">=</a> <a id="1785" href="Data.Sum.Categorical.Left.html#1296" class="Function">Sumₗ.monad</a> <a id="1796" class="Symbol">(</a><a id="1797" href="Types.html#718" class="Datatype">Error</a> <a id="1803" href="Types.html#1781" class="Bound">E</a><a id="1804" class="Symbol">)</a> <a id="1806" href="Agda.Primitive.html#611" class="Primitive">L.zero</a>

  <a id="Result.fail"></a><a id="1816" href="Types.html#1816" class="Function">fail</a> <a id="1821" class="Symbol">:</a> <a id="1823" class="Symbol">∀</a> <a id="1825" class="Symbol">{</a><a id="1826" href="Types.html#1826" class="Bound">E</a> <a id="1828" href="Types.html#1828" class="Bound">A</a><a id="1829" class="Symbol">}</a> <a id="1831" class="Symbol">→</a> <a id="1833" href="Types.html#718" class="Datatype">Error</a> <a id="1839" href="Types.html#1826" class="Bound">E</a> <a id="1841" class="Symbol">→</a> <a id="1843" href="Types.html#1652" class="Function">Result</a> <a id="1850" href="Types.html#1826" class="Bound">E</a> <a id="1852" href="Types.html#1828" class="Bound">A</a>
  <a id="1856" href="Types.html#1816" class="Function">fail</a> <a id="1861" class="Symbol">=</a> <a id="1863" href="Data.Sum.Base.html#565" class="InductiveConstructor">inj₁</a>

  <a id="Result.fromMaybe"></a><a id="1871" href="Types.html#1871" class="Function">fromMaybe</a> <a id="1881" class="Symbol">:</a> <a id="1883" class="Symbol">∀</a> <a id="1885" class="Symbol">{</a><a id="1886" href="Types.html#1886" class="Bound">E</a> <a id="1888" href="Types.html#1888" class="Bound">A</a><a id="1889" class="Symbol">}</a> <a id="1891" class="Symbol">→</a> <a id="1893" href="Types.html#718" class="Datatype">Error</a> <a id="1899" href="Types.html#1886" class="Bound">E</a> <a id="1901" class="Symbol">→</a> <a id="1903" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="1909" href="Types.html#1888" class="Bound">A</a> <a id="1911" class="Symbol">→</a> <a id="1913" href="Types.html#1652" class="Function">Result</a> <a id="1920" href="Types.html#1886" class="Bound">E</a> <a id="1922" href="Types.html#1888" class="Bound">A</a>
  <a id="1926" href="Types.html#1871" class="Function">fromMaybe</a> <a id="1936" class="Symbol">=</a> <a id="1938" href="Data.Maybe.Base.html#1618" class="Function">maybe′</a> <a id="1945" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a> <a id="1950" href="Function.html#994" class="Function Operator">∘′</a> <a id="1953" href="Types.html#1816" class="Function">fail</a>

<a id="1959" class="Comment">-- Data.AVL is not quite usable with String at the moment IIRC</a>
<a id="2022" class="Comment">-- So instead I&#39;m using a quick and dirty representation</a>
<a id="2079" class="Keyword">import</a> <a id="2086" href="Data.Map.html" class="Module">Data.Map</a> <a id="2095" class="Symbol">as</a> <a id="2098" class="Module">M</a>

<a id="2101" class="Keyword">module</a> <a id="RMap"></a><a id="2108" href="Types.html#2108" class="Module">RMap</a> <a id="2113" class="Symbol">=</a> <a id="2115" href="Data.Map.html#300" class="Module">M.Map</a> <a id="2121" href="Data.Nat.Properties.html#2153" class="Function Operator">ℕ._≟_</a> <a id="2127" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
<a id="2134" class="Keyword">module</a> <a id="Map"></a><a id="2141" href="Types.html#2141" class="Module">Map</a>  <a id="2146" class="Symbol">=</a> <a id="2148" href="Data.Map.html#300" class="Module">M.Map</a> <a id="2154" href="Data.String.Unsafe.html#775" class="Function Operator">String._≟_</a> <a id="2165" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a>
<a id="2167" class="Keyword">open</a> <a id="2172" href="Types.html#2141" class="Module">Map</a> <a id="2176" class="Keyword">using</a> <a id="2182" class="Symbol">(</a><a id="2183" href="Data.Map.html#364" class="Function">Map</a><a id="2186" class="Symbol">;</a> <a id="2188" href="Data.Map.html#398" class="Function">RMap</a><a id="2192" class="Symbol">)</a> <a id="2194" class="Keyword">public</a>

<a id="Compiler"></a><a id="2202" href="Types.html#2202" class="Function">Compiler</a> <a id="2211" class="Symbol">:</a> <a id="2213" class="PrimitiveType">Set</a> <a id="2217" class="Symbol">→</a> <a id="2219" class="PrimitiveType">Set</a> <a id="2223" class="Symbol">→</a> <a id="2225" class="PrimitiveType">Set</a>
<a id="2229" href="Types.html#2202" class="Function">Compiler</a> <a id="2238" href="Types.html#2238" class="Bound">E</a> <a id="2240" class="Symbol">=</a> <a id="2242" href="Category.Monad.State.html#4416" class="Function">State</a> <a id="2248" class="Symbol">(</a><a id="2249" href="Data.Map.html#364" class="Function">Map</a> <a id="2253" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="2255" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="2256" class="Symbol">)</a> <a id="2258" href="Function.html#994" class="Function Operator">∘′</a> <a id="2261" class="Symbol">(</a><a id="2262" href="Types.html#718" class="Datatype">Error</a> <a id="2268" href="Types.html#2238" class="Bound">E</a> <a id="2270" href="Data.Sum.Base.html#509" class="Datatype Operator">⊎_</a><a id="2272" class="Symbol">)</a>

<a id="2275" class="Keyword">module</a> <a id="Compiler"></a><a id="2282" href="Types.html#2282" class="Module">Compiler</a> <a id="2291" class="Keyword">where</a>

  <a id="Compiler.monad"></a><a id="2300" href="Types.html#2300" class="Function">monad</a> <a id="2306" class="Symbol">:</a> <a id="2308" class="Symbol">∀</a> <a id="2310" href="Types.html#2310" class="Bound">E</a> <a id="2312" class="Symbol">→</a> <a id="2314" href="Category.Monad.html#396" class="Function">RawMonad</a> <a id="2323" class="Symbol">(</a><a id="2324" href="Types.html#2202" class="Function">Compiler</a> <a id="2333" href="Types.html#2310" class="Bound">E</a><a id="2334" class="Symbol">)</a>
  <a id="2338" href="Types.html#2300" class="Function">monad</a> <a id="2344" href="Types.html#2344" class="Bound">E</a> <a id="2346" class="Symbol">=</a> <a id="2348" href="Data.Sum.Categorical.Left.html#1133" class="Function">Sumₗ.monadT</a> <a id="2360" class="Symbol">(</a><a id="2361" href="Types.html#718" class="Datatype">Error</a> <a id="2367" href="Types.html#2344" class="Bound">E</a><a id="2368" class="Symbol">)</a> <a id="2370" href="Agda.Primitive.html#611" class="Primitive">L.zero</a> <a id="2377" class="Symbol">(</a><a id="2378" href="Category.Monad.State.html#4483" class="Function">StateMonad</a> <a id="2389" class="Symbol">_)</a>

  <a id="Compiler.liftResult"></a><a id="2395" href="Types.html#2395" class="Function">liftResult</a> <a id="2406" class="Symbol">:</a> <a id="2408" class="Symbol">∀</a> <a id="2410" class="Symbol">{</a><a id="2411" href="Types.html#2411" class="Bound">E</a> <a id="2413" href="Types.html#2413" class="Bound">A</a><a id="2414" class="Symbol">}</a> <a id="2416" class="Symbol">→</a> <a id="2418" href="Types.html#718" class="Datatype">Error</a> <a id="2424" href="Types.html#2411" class="Bound">E</a> <a id="2426" href="Data.Sum.Base.html#509" class="Datatype Operator">⊎</a> <a id="2428" href="Types.html#2413" class="Bound">A</a> <a id="2430" class="Symbol">→</a> <a id="2432" href="Types.html#2202" class="Function">Compiler</a> <a id="2441" href="Types.html#2411" class="Bound">E</a> <a id="2443" href="Types.html#2413" class="Bound">A</a>
  <a id="2447" href="Types.html#2395" class="Function">liftResult</a> <a id="2458" class="Symbol">=</a> <a id="2460" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">_,_</a>

  <a id="Compiler.liftState"></a><a id="2467" href="Types.html#2467" class="Function">liftState</a> <a id="2477" class="Symbol">:</a> <a id="2479" class="Symbol">∀</a> <a id="2481" class="Symbol">{</a><a id="2482" href="Types.html#2482" class="Bound">E</a> <a id="2484" href="Types.html#2484" class="Bound">A</a><a id="2485" class="Symbol">}</a> <a id="2487" class="Symbol">→</a> <a id="2489" href="Category.Monad.State.html#4416" class="Function">State</a> <a id="2495" class="Symbol">(</a><a id="2496" href="Data.Map.html#364" class="Function">Map</a> <a id="2500" href="Data.Product.html#1389" class="Function Operator">×</a> <a id="2502" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a><a id="2503" class="Symbol">)</a> <a id="2505" href="Types.html#2484" class="Bound">A</a> <a id="2507" class="Symbol">→</a> <a id="2509" href="Types.html#2202" class="Function">Compiler</a> <a id="2518" href="Types.html#2482" class="Bound">E</a> <a id="2520" href="Types.html#2484" class="Bound">A</a>
  <a id="2524" href="Types.html#2467" class="Function">liftState</a> <a id="2534" class="Symbol">=</a> <a id="2536" class="Keyword">let</a> <a id="2540" class="Keyword">open</a> <a id="2545" href="Category.Monad.html#810" class="Module">RawMonad</a> <a id="2554" class="Symbol">(</a><a id="2555" href="Category.Monad.State.html#4483" class="Function">StateMonad</a> <a id="2566" class="Symbol">_)</a> <a id="2569" class="Keyword">in</a> <a id="2572" href="Data.Sum.Base.html#590" class="InductiveConstructor">inj₂</a> <a id="2577" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;_</a>

  <a id="Compiler.fail"></a><a id="2585" href="Types.html#2585" class="Function">fail</a> <a id="2590" class="Symbol">:</a> <a id="2592" class="Symbol">∀</a> <a id="2594" class="Symbol">{</a><a id="2595" href="Types.html#2595" class="Bound">E</a> <a id="2597" href="Types.html#2597" class="Bound">A</a><a id="2598" class="Symbol">}</a> <a id="2600" class="Symbol">→</a> <a id="2602" href="Types.html#718" class="Datatype">Error</a> <a id="2608" href="Types.html#2595" class="Bound">E</a> <a id="2610" class="Symbol">→</a> <a id="2612" href="Types.html#2202" class="Function">Compiler</a> <a id="2621" href="Types.html#2595" class="Bound">E</a> <a id="2623" href="Types.html#2597" class="Bound">A</a>
  <a id="2627" href="Types.html#2585" class="Function">fail</a> <a id="2632" class="Symbol">=</a> <a id="2634" href="Types.html#2395" class="Function">liftResult</a> <a id="2645" href="Function.html#994" class="Function Operator">∘′</a> <a id="2648" href="Types.html#1816" class="Function">Result.fail</a>

  <a id="Compiler.fromMaybe"></a><a id="2663" href="Types.html#2663" class="Function">fromMaybe</a> <a id="2673" class="Symbol">:</a> <a id="2675" class="Symbol">∀</a> <a id="2677" class="Symbol">{</a><a id="2678" href="Types.html#2678" class="Bound">E</a> <a id="2680" href="Types.html#2680" class="Bound">A</a><a id="2681" class="Symbol">}</a> <a id="2683" class="Symbol">→</a> <a id="2685" href="Types.html#718" class="Datatype">Error</a> <a id="2691" href="Types.html#2678" class="Bound">E</a> <a id="2693" class="Symbol">→</a> <a id="2695" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="2701" href="Types.html#2680" class="Bound">A</a> <a id="2703" class="Symbol">→</a> <a id="2705" href="Types.html#2202" class="Function">Compiler</a> <a id="2714" href="Types.html#2678" class="Bound">E</a> <a id="2716" href="Types.html#2680" class="Bound">A</a>
  <a id="2720" href="Types.html#2663" class="Function">fromMaybe</a> <a id="2730" href="Types.html#2730" class="Bound">e</a> <a id="2732" href="Types.html#2732" class="Bound">ma</a> <a id="2735" class="Symbol">=</a> <a id="2737" href="Types.html#2395" class="Function">liftResult</a> <a id="2748" href="Function.html#1927" class="Function Operator">$</a> <a id="2750" href="Types.html#1871" class="Function">Result.fromMaybe</a> <a id="2767" href="Types.html#2730" class="Bound">e</a> <a id="2769" href="Types.html#2732" class="Bound">ma</a>

  <a id="Compiler.run"></a><a id="2775" href="Types.html#2775" class="Function">run</a> <a id="2779" class="Symbol">:</a> <a id="2781" class="Symbol">∀</a> <a id="2783" class="Symbol">{</a><a id="2784" href="Types.html#2784" class="Bound">E</a> <a id="2786" href="Types.html#2786" class="Bound">A</a><a id="2787" class="Symbol">}</a> <a id="2789" class="Symbol">→</a> <a id="2791" href="Types.html#2202" class="Function">Compiler</a> <a id="2800" href="Types.html#2784" class="Bound">E</a> <a id="2802" href="Types.html#2786" class="Bound">A</a> <a id="2804" class="Symbol">→</a> <a id="2806" href="Types.html#1652" class="Function">Result</a> <a id="2813" href="Types.html#2784" class="Bound">E</a> <a id="2815" href="Types.html#2786" class="Bound">A</a>
  <a id="2819" href="Types.html#2775" class="Function">run</a> <a id="2823" href="Types.html#2823" class="Bound">m</a> <a id="2825" class="Symbol">=</a> <a id="2827" href="Agda.Builtin.Sigma.html#155" class="Field">proj₁</a> <a id="2833" class="Symbol">(</a><a id="2834" href="Types.html#2823" class="Bound">m</a> <a id="2836" class="Symbol">(</a><a id="2837" href="Agda.Builtin.List.html#117" class="InductiveConstructor">[]</a> <a id="2840" href="Agda.Builtin.Sigma.html#139" class="InductiveConstructor Operator">,</a> <a id="2842" class="Number">0</a><a id="2843" class="Symbol">))</a>


<a id="2848" class="Keyword">module</a> <a id="PrettyPrint"></a><a id="2855" href="Types.html#2855" class="Module">PrettyPrint</a> <a id="2867" class="Keyword">where</a>

  <a id="2876" class="Keyword">open</a> <a id="2881" href="Category.Monad.html#810" class="Module">RawMonad</a> <a id="2890" class="Symbol">(</a><a id="2891" href="Data.Maybe.Categorical.html#1423" class="Function">MC.monad</a> <a id="2900" class="Symbol">{</a><a id="2901" href="Agda.Primitive.html#611" class="Primitive">L.zero</a><a id="2907" class="Symbol">})</a>

  <a id="PrettyPrint.ppType"></a><a id="2913" href="Types.html#2913" class="Function">ppType</a> <a id="2920" class="Symbol">:</a> <a id="2922" href="Data.Map.html#398" class="Function">RMap</a> <a id="2927" class="Symbol">→</a> <a id="2929" href="Language.html#764" class="Datatype">Type</a> <a id="2934" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="2936" class="Symbol">→</a> <a id="2938" href="Data.Maybe.Base.html#710" class="Datatype">Maybe</a> <a id="2944" class="Symbol">(</a><a id="2945" href="Language.html#764" class="Datatype">Type</a> <a id="2950" href="Agda.Builtin.String.html#165" class="Postulate">String</a><a id="2956" class="Symbol">)</a>
  <a id="2960" href="Types.html#2913" class="Function">ppType</a> <a id="2967" href="Types.html#2967" class="Bound">rm</a> <a id="2970" class="Symbol">(</a><a id="2971" href="Language.html#793" class="InductiveConstructor">α</a> <a id="2973" href="Types.html#2973" class="Bound">k</a><a id="2974" class="Symbol">)</a>   <a id="2978" class="Symbol">=</a> <a id="2980" href="Language.html#793" class="InductiveConstructor">α</a> <a id="2982" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="2986" href="Data.Map.html#517" class="Function">RMap.assoc</a> <a id="2997" href="Types.html#2973" class="Bound">k</a> <a id="2999" href="Types.html#2967" class="Bound">rm</a>
  <a id="3004" href="Types.html#2913" class="Function">ppType</a> <a id="3011" href="Types.html#3011" class="Bound">rm</a> <a id="3014" class="Symbol">(</a><a id="3015" href="Types.html#3015" class="Bound">σ</a> <a id="3017" href="Language.html#812" class="InductiveConstructor Operator">⇒</a> <a id="3019" href="Types.html#3019" class="Bound">τ</a><a id="3020" class="Symbol">)</a> <a id="3022" class="Symbol">=</a> <a id="3024" href="Language.html#812" class="InductiveConstructor Operator">_⇒_</a> <a id="3028" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="3032" href="Types.html#2913" class="Function">ppType</a> <a id="3039" href="Types.html#3011" class="Bound">rm</a> <a id="3042" href="Types.html#3015" class="Bound">σ</a> <a id="3044" href="Category.Applicative.Indexed.html#938" class="Function Operator">⊛</a> <a id="3046" href="Types.html#2913" class="Function">ppType</a> <a id="3053" href="Types.html#3011" class="Bound">rm</a> <a id="3056" href="Types.html#3019" class="Bound">τ</a>

  <a id="PrettyPrint.ppError"></a><a id="3061" href="Types.html#3061" class="Function">ppError</a> <a id="3069" class="Symbol">:</a> <a id="3071" href="Data.Map.html#398" class="Function">RMap</a> <a id="3076" class="Symbol">→</a> <a id="3078" href="Types.html#718" class="Datatype">Error</a> <a id="3084" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="3086" class="Symbol">→</a> <a id="3088" href="Types.html#718" class="Datatype">Error</a> <a id="3094" href="Agda.Builtin.String.html#165" class="Postulate">String</a>
  <a id="3103" href="Types.html#3061" class="Function">ppError</a> <a id="3111" href="Types.html#3111" class="Bound">rm</a> <a id="3114" href="Types.html#3114" class="Bound">err</a> <a id="3118" class="Symbol">=</a> <a id="3120" href="Function.html#3533" class="Function Operator">case</a> <a id="3125" href="Types.html#3114" class="Bound">err</a> <a id="3129" href="Function.html#3533" class="Function Operator">of</a> <a id="3132" class="Symbol">λ</a> <a id="3134" class="Keyword">where</a>
    <a id="3144" class="Symbol">(</a><a id="3145" href="Types.html#748" class="InductiveConstructor Operator">At</a> <a id="3148" href="Types.html#3148" class="Bound">p</a> <a id="3150" href="Types.html#748" class="InductiveConstructor Operator">ParseError</a><a id="3160" class="Symbol">)</a>             <a id="3174" class="Symbol">→</a> <a id="3176" href="Types.html#748" class="InductiveConstructor Operator">At</a> <a id="3179" href="Types.html#3148" class="Bound">p</a> <a id="3181" href="Types.html#748" class="InductiveConstructor Operator">ParseError</a>
    <a id="3196" class="Symbol">(</a><a id="3197" href="Types.html#797" class="InductiveConstructor Operator">At</a> <a id="3200" href="Types.html#3200" class="Bound">p</a> <a id="3202" href="Types.html#797" class="InductiveConstructor Operator">OutOfScope</a> <a id="3213" href="Types.html#3213" class="Bound">x</a><a id="3214" class="Symbol">)</a>           <a id="3226" class="Symbol">→</a> <a id="3228" href="Types.html#797" class="InductiveConstructor Operator">At</a> <a id="3231" href="Types.html#3200" class="Bound">p</a> <a id="3233" href="Types.html#797" class="InductiveConstructor Operator">OutOfScope</a> <a id="3244" href="Types.html#3213" class="Bound">x</a>
    <a id="3250" class="Symbol">(</a><a id="3251" href="Types.html#855" class="InductiveConstructor Operator">At</a> <a id="3254" href="Types.html#3254" class="Bound">p</a> <a id="3256" href="Types.html#855" class="InductiveConstructor Operator">Expected</a> <a id="3265" href="Types.html#3265" class="Bound">σ</a> <a id="3267" href="Types.html#855" class="InductiveConstructor Operator">Got</a> <a id="3271" href="Types.html#3271" class="Bound">τ</a><a id="3272" class="Symbol">)</a>       <a id="3280" class="Symbol">→</a>
      <a id="3288" href="Function.html#3533" class="Function Operator">case</a> <a id="3293" href="Types.html#855" class="InductiveConstructor Operator">At</a> <a id="3296" href="Types.html#3254" class="Bound">p</a> <a id="3298" href="Types.html#855" class="InductiveConstructor Operator">Expected_Got_</a> <a id="3312" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="3316" href="Types.html#2913" class="Function">ppType</a> <a id="3323" href="Types.html#3111" class="Bound">rm</a> <a id="3326" href="Types.html#3265" class="Bound">σ</a> <a id="3328" href="Category.Applicative.Indexed.html#938" class="Function Operator">⊛</a> <a id="3330" href="Types.html#2913" class="Function">ppType</a> <a id="3337" href="Types.html#3111" class="Bound">rm</a> <a id="3340" href="Types.html#3271" class="Bound">τ</a> <a id="3342" href="Function.html#3533" class="Function Operator">of</a> <a id="3345" class="Symbol">λ</a> <a id="3347" class="Keyword">where</a>
        <a id="3361" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a>    <a id="3372" class="Symbol">→</a> <a id="3374" href="Types.html#980" class="InductiveConstructor Operator">At</a> <a id="3377" href="Types.html#3254" class="Bound">p</a> <a id="3379" href="Types.html#980" class="InductiveConstructor Operator">ErrorWhenPrintingError</a>
        <a id="3410" class="Symbol">(</a><a id="3411" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="3416" href="Types.html#3416" class="Bound">err</a><a id="3419" class="Symbol">)</a> <a id="3421" class="Symbol">→</a> <a id="3423" href="Types.html#3416" class="Bound">err</a>
    <a id="3431" class="Symbol">(</a><a id="3432" href="Types.html#922" class="InductiveConstructor Operator">At</a> <a id="3435" href="Types.html#3435" class="Bound">p</a> <a id="3437" href="Types.html#922" class="InductiveConstructor Operator">NotAnArrow</a> <a id="3448" href="Types.html#3448" class="Bound">σ</a><a id="3449" class="Symbol">)</a>           <a id="3461" class="Symbol">→</a>
      <a id="3469" href="Function.html#3533" class="Function Operator">case</a> <a id="3474" href="Types.html#922" class="InductiveConstructor Operator">At</a> <a id="3477" href="Types.html#3435" class="Bound">p</a> <a id="3479" href="Types.html#922" class="InductiveConstructor Operator">NotAnArrow_</a> <a id="3491" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="3495" href="Types.html#2913" class="Function">ppType</a> <a id="3502" href="Types.html#3111" class="Bound">rm</a> <a id="3505" href="Types.html#3448" class="Bound">σ</a> <a id="3507" href="Function.html#3533" class="Function Operator">of</a> <a id="3510" class="Symbol">λ</a> <a id="3512" class="Keyword">where</a>
        <a id="3526" href="Data.Maybe.Base.html#778" class="InductiveConstructor">nothing</a>    <a id="3537" class="Symbol">→</a> <a id="3539" href="Types.html#980" class="InductiveConstructor Operator">At</a> <a id="3542" href="Types.html#3435" class="Bound">p</a> <a id="3544" href="Types.html#980" class="InductiveConstructor Operator">ErrorWhenPrintingError</a>
        <a id="3575" class="Symbol">(</a><a id="3576" href="Data.Maybe.Base.html#748" class="InductiveConstructor">just</a> <a id="3581" href="Types.html#3581" class="Bound">err</a><a id="3584" class="Symbol">)</a> <a id="3586" class="Symbol">→</a> <a id="3588" href="Types.html#3581" class="Bound">err</a>
    <a id="3596" class="Symbol">(</a><a id="3597" href="Types.html#980" class="InductiveConstructor Operator">At</a> <a id="3600" href="Types.html#3600" class="Bound">p</a> <a id="3602" href="Types.html#980" class="InductiveConstructor Operator">ErrorWhenPrintingError</a><a id="3624" class="Symbol">)</a> <a id="3626" class="Symbol">→</a> <a id="3628" href="Types.html#980" class="InductiveConstructor Operator">At</a> <a id="3631" href="Types.html#3600" class="Bound">p</a> <a id="3633" href="Types.html#980" class="InductiveConstructor Operator">ErrorWhenPrintingError</a>


<a id="ppCompiler"></a><a id="3658" href="Types.html#3658" class="Function">ppCompiler</a> <a id="3669" class="Symbol">:</a> <a id="3671" class="Symbol">∀</a> <a id="3673" class="Symbol">{</a><a id="3674" href="Types.html#3674" class="Bound">A</a><a id="3675" class="Symbol">}</a> <a id="3677" class="Symbol">→</a> <a id="3679" href="Types.html#2202" class="Function">Compiler</a> <a id="3688" href="Agda.Builtin.Nat.html#97" class="Datatype">ℕ</a> <a id="3690" href="Types.html#3674" class="Bound">A</a> <a id="3692" class="Symbol">→</a> <a id="3694" href="Types.html#2202" class="Function">Compiler</a> <a id="3703" href="Agda.Builtin.String.html#165" class="Postulate">String</a> <a id="3710" href="Types.html#3674" class="Bound">A</a>
<a id="3712" href="Types.html#3658" class="Function">ppCompiler</a> <a id="3723" href="Types.html#3723" class="Bound">m</a> <a id="3725" class="Symbol">=</a> <a id="3727" class="Keyword">let</a> <a id="3731" class="Keyword">open</a> <a id="3736" href="Category.Monad.State.html#3607" class="Module">RawMonadState</a> <a id="3750" class="Symbol">(</a><a id="3751" href="Category.Monad.State.html#4574" class="Function">StateMonadState</a> <a id="3767" class="Symbol">_)</a> <a id="3770" class="Keyword">in</a> <a id="3773" class="Keyword">do</a>
  <a id="3778" href="Types.html#3778" class="Bound">v</a>  <a id="3781" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="3783" href="Types.html#3723" class="Bound">m</a>
  <a id="3787" href="Types.html#3787" class="Bound">mp</a> <a id="3790" href="Category.Monad.Indexed.html#604" class="Function Operator">←</a> <a id="3792" href="Agda.Builtin.Sigma.html#155" class="Field">proj₁</a> <a id="3798" href="Category.Functor.html#528" class="Function Operator">&lt;$&gt;</a> <a id="3802" href="Category.Monad.State.html#2900" class="Function">get</a>
  <a id="3808" href="Category.Applicative.Indexed.html#905" class="Function">pure</a> <a id="3813" href="Function.html#1927" class="Function Operator">$</a> <a id="3815" href="Data.Sum.Base.html#1378" class="Function">Sum.map₁</a> <a id="3824" class="Symbol">(</a><a id="3825" href="Types.html#3061" class="Function">PrettyPrint.ppError</a> <a id="3845" class="Symbol">(</a><a id="3846" href="Data.Map.html#641" class="Function">Map.invert</a> <a id="3857" href="Types.html#3787" class="Bound">mp</a><a id="3859" class="Symbol">))</a> <a id="3862" href="Types.html#3778" class="Bound">v</a>
</pre></body></html>